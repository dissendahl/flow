{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 167, "num_steps_trained": 0, "num_steps_sampled": 1002, "sample_time_ms": 375.55, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 268.545, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 1002, "episodes_total": 0, "training_iteration": 1, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_10-15-19", "timestamp": 1580289319, "time_this_iter_s": 164.2490258216858, "time_total_s": 164.2490258216858, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 164.2490258216858, "timesteps_since_restore": 1002, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.387124463519314, "ram_util_percent": 59.607296137339056}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -1344.562679092517, "episode_reward_mean": -1092.181285834912, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -149.39585323250168, "center1": -149.39585323250168, "center2": -149.39585323250168, "center3": -149.39585323250168, "center4": -149.39585323250168, "center5": -149.39585323250168, "center6": -149.39585323250168, "center7": -149.39585323250168, "center8": -149.39585323250168}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -121.35347620387911, "center1": -121.35347620387911, "center2": -121.35347620387911, "center3": -121.35347620387911, "center4": -121.35347620387911, "center5": -121.35347620387911, "center6": -121.35347620387911, "center7": -121.35347620387911, "center8": -121.35347620387911}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 315.7908646028433, "mean_processing_ms": 6.748002322752085, "mean_inference_ms": 7.013570016889429}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 334, "num_steps_trained": 420000, "num_steps_sampled": 2004, "sample_time_ms": 377.416, "replay_time_ms": 3599.147, "grad_time_ms": 3777.389, "update_time_ms": 46.41, "opt_peak_throughput": 1323.666, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -0.7222601771354675, "max_q": -0.27512842416763306, "min_q": -2.025928258895874}, "center1": {"mean_q": -0.6786893010139465, "max_q": 0.05259058251976967, "min_q": -1.7176294326782227}, "center2": {"mean_q": -0.7620159983634949, "max_q": 0.042283959686756134, "min_q": -2.1375656127929688}, "center3": {"mean_q": -0.6781817674636841, "max_q": 0.12915439903736115, "min_q": -2.3111438751220703}, "center4": {"mean_q": -0.6756641864776611, "max_q": 0.14634598791599274, "min_q": -1.6822733879089355}, "center5": {"mean_q": -0.7200274467468262, "max_q": -0.01155896671116352, "min_q": -1.9481396675109863}, "center6": {"mean_q": -0.6750612854957581, "max_q": 0.012219127267599106, "min_q": -1.6300694942474365}, "center7": {"mean_q": -0.7624059319496155, "max_q": 0.18251103162765503, "min_q": -1.8146307468414307}, "center8": {"mean_q": -0.8042296767234802, "max_q": -0.05575157329440117, "min_q": -2.566272258758545}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 2004, "episodes_total": 6, "training_iteration": 2, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_10-26-59", "timestamp": 1580290019, "time_this_iter_s": 700.4693760871887, "time_total_s": 864.7184019088745, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 864.7184019088745, "timesteps_since_restore": 2004, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 31.72457027300303, "ram_util_percent": 66.71769464105155}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2706.273512780466, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -300.6970569756075, "center1": -300.6970569756075, "center2": -300.6970569756075, "center3": -300.6970569756075, "center4": -300.6970569756075, "center5": -300.6970569756075, "center6": -300.6970569756075, "center7": -300.6970569756075, "center8": -300.6970569756075}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 314.3197462433797, "mean_processing_ms": 7.652297456924541, "mean_inference_ms": 6.553205632659689}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 501, "num_steps_trained": 1255000, "num_steps_sampled": 3006, "sample_time_ms": 571.263, "replay_time_ms": 3662.778, "grad_time_ms": 4240.235, "update_time_ms": 266.093, "opt_peak_throughput": 1179.18, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -1.7763503789901733, "max_q": -0.1134636178612709, "min_q": -3.587409257888794}, "center1": {"mean_q": -1.536970853805542, "max_q": 0.06341544538736343, "min_q": -3.996328353881836}, "center2": {"mean_q": -1.5467947721481323, "max_q": 0.12132243067026138, "min_q": -4.044198513031006}, "center3": {"mean_q": -1.3830113410949707, "max_q": 0.38402220606803894, "min_q": -3.733025074005127}, "center4": {"mean_q": -1.7772780656814575, "max_q": 0.20621035993099213, "min_q": -3.5488438606262207}, "center5": {"mean_q": -2.012439012527466, "max_q": -0.07099300622940063, "min_q": -4.583156108856201}, "center6": {"mean_q": -1.7669990062713623, "max_q": 0.2247534990310669, "min_q": -4.249243259429932}, "center7": {"mean_q": -1.3415502309799194, "max_q": 0.3528437316417694, "min_q": -4.245845794677734}, "center8": {"mean_q": -1.858163833618164, "max_q": 0.10220947116613388, "min_q": -4.066559791564941}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 3006, "episodes_total": 12, "training_iteration": 3, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_10-48-20", "timestamp": 1580291300, "time_this_iter_s": 1281.107575893402, "time_total_s": 2145.8259778022766, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2145.8259778022766, "timesteps_since_restore": 3006, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 30.387148372862654, "ram_util_percent": 71.27997793712079}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2706.273512780466, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -300.6970569756075, "center1": -300.6970569756075, "center2": -300.6970569756075, "center3": -300.6970569756075, "center4": -300.6970569756075, "center5": -300.6970569756075, "center6": -300.6970569756075, "center7": -300.6970569756075, "center8": -300.6970569756075}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 314.3197462433797, "mean_processing_ms": 7.652297456924541, "mean_inference_ms": 6.5532056326596875}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 668, "num_steps_trained": 2090000, "num_steps_sampled": 4008, "sample_time_ms": 382.491, "replay_time_ms": 3530.929, "grad_time_ms": 3755.841, "update_time_ms": 118.681, "opt_peak_throughput": 1331.26, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -1.6593824625015259, "max_q": -0.19531162083148956, "min_q": -3.9487862586975098}, "center1": {"mean_q": -1.413055419921875, "max_q": 0.05363733693957329, "min_q": -4.750735759735107}, "center2": {"mean_q": -1.671530842781067, "max_q": 0.037146952003240585, "min_q": -5.047731399536133}, "center3": {"mean_q": -1.7165870666503906, "max_q": -0.10221575945615768, "min_q": -4.802023410797119}, "center4": {"mean_q": -1.4838300943374634, "max_q": 0.07901652902364731, "min_q": -4.82744836807251}, "center5": {"mean_q": -1.772599220275879, "max_q": -0.13020427525043488, "min_q": -5.158786296844482}, "center6": {"mean_q": -1.4987634420394897, "max_q": -0.016136107966303825, "min_q": -4.578003406524658}, "center7": {"mean_q": -1.7753273248672485, "max_q": -0.029178153723478317, "min_q": -4.831509113311768}, "center8": {"mean_q": -2.3403475284576416, "max_q": -0.4569021761417389, "min_q": -5.971132278442383}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 4008, "episodes_total": 12, "training_iteration": 4, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_11-09-35", "timestamp": 1580292575, "time_this_iter_s": 1274.9805138111115, "time_total_s": 3420.806491613388, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3420.806491613388, "timesteps_since_restore": 4008, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 29.254515235457063, "ram_util_percent": 74.67207756232686}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2317.879786701238, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -257.5421985223598, "center1": -257.5421985223598, "center2": -257.5421985223598, "center3": -257.5421985223598, "center4": -257.5421985223598, "center5": -257.5421985223598, "center6": -257.5421985223598, "center7": -257.5421985223598, "center8": -257.5421985223598}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 312.56541799387116, "mean_processing_ms": 7.744021714626204, "mean_inference_ms": 6.120739202275088}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 835, "num_steps_trained": 2925000, "num_steps_sampled": 5010, "sample_time_ms": 415.534, "replay_time_ms": 3340.623, "grad_time_ms": 3607.29, "update_time_ms": 310.194, "opt_peak_throughput": 1386.082, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -1.9841396808624268, "max_q": -0.3429450988769531, "min_q": -4.957571983337402}, "center1": {"mean_q": -1.9528484344482422, "max_q": -0.09644010663032532, "min_q": -6.165825843811035}, "center2": {"mean_q": -1.9130035638809204, "max_q": -0.06373868137598038, "min_q": -5.871918201446533}, "center3": {"mean_q": -1.8360886573791504, "max_q": -0.12275542318820953, "min_q": -5.7915873527526855}, "center4": {"mean_q": -1.5373027324676514, "max_q": 0.12560591101646423, "min_q": -4.92341423034668}, "center5": {"mean_q": -1.7027257680892944, "max_q": 0.03962777554988861, "min_q": -5.104483604431152}, "center6": {"mean_q": -1.943405032157898, "max_q": -0.2652572691440582, "min_q": -5.569808006286621}, "center7": {"mean_q": -2.022540807723999, "max_q": -0.1302187144756317, "min_q": -5.64365816116333}, "center8": {"mean_q": -2.3765344619750977, "max_q": -0.46548041701316833, "min_q": -6.476228713989258}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 5010, "episodes_total": 18, "training_iteration": 5, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_11-32-03", "timestamp": 1580293923, "time_this_iter_s": 1348.1315531730652, "time_total_s": 4768.938044786453, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4768.938044786453, "timesteps_since_restore": 5010, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 30.472263157894737, "ram_util_percent": 80.79115789473683}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2007.6035257037165, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -223.06705841152413, "center1": -223.06705841152413, "center2": -223.06705841152413, "center3": -223.06705841152413, "center4": -223.06705841152413, "center5": -223.06705841152413, "center6": -223.06705841152413, "center7": -223.06705841152413, "center8": -223.06705841152413}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 311.4316994627284, "mean_processing_ms": 7.950436644586287, "mean_inference_ms": 5.844783188226799}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1002, "num_steps_trained": 3760000, "num_steps_sampled": 6012, "sample_time_ms": 510.631, "replay_time_ms": 3197.629, "grad_time_ms": 3491.248, "update_time_ms": 307.938, "opt_peak_throughput": 1432.153, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -1.8977261781692505, "max_q": -0.1567714363336563, "min_q": -5.375471115112305}, "center1": {"mean_q": -2.0862135887145996, "max_q": -0.06488305330276489, "min_q": -6.987133026123047}, "center2": {"mean_q": -1.8271539211273193, "max_q": -0.01519537903368473, "min_q": -6.301612377166748}, "center3": {"mean_q": -1.9722986221313477, "max_q": -0.15367171168327332, "min_q": -6.723145961761475}, "center4": {"mean_q": -1.9047974348068237, "max_q": -0.12097150832414627, "min_q": -5.822831153869629}, "center5": {"mean_q": -1.777095913887024, "max_q": -0.09621194750070572, "min_q": -5.654979705810547}, "center6": {"mean_q": -2.0859954357147217, "max_q": -0.24524745345115662, "min_q": -6.351500511169434}, "center7": {"mean_q": -2.237928867340088, "max_q": -0.14500902593135834, "min_q": -6.328671932220459}, "center8": {"mean_q": -2.3666093349456787, "max_q": -0.524203896522522, "min_q": -6.4517364501953125}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 6012, "episodes_total": 24, "training_iteration": 6, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_11-53-42", "timestamp": 1580295222, "time_this_iter_s": 1298.6176822185516, "time_total_s": 6067.555727005005, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6067.555727005005, "timesteps_since_restore": 6012, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 28.21012520413718, "ram_util_percent": 81.94850299401197}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2007.6035257037165, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -223.06705841152413, "center1": -223.06705841152413, "center2": -223.06705841152413, "center3": -223.06705841152413, "center4": -223.06705841152413, "center5": -223.06705841152413, "center6": -223.06705841152413, "center7": -223.06705841152413, "center8": -223.06705841152413}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 311.4316994627284, "mean_processing_ms": 7.950436644586287, "mean_inference_ms": 5.844783188226799}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1169, "num_steps_trained": 4595000, "num_steps_sampled": 7014, "sample_time_ms": 429.802, "replay_time_ms": 3299.346, "grad_time_ms": 3391.796, "update_time_ms": 61.287, "opt_peak_throughput": 1474.145, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -2.4457082748413086, "max_q": -0.4734381437301636, "min_q": -6.9430975914001465}, "center1": {"mean_q": -1.9221175909042358, "max_q": -0.06282356381416321, "min_q": -7.214603900909424}, "center2": {"mean_q": -2.2721822261810303, "max_q": -0.2184721678495407, "min_q": -7.842978477478027}, "center3": {"mean_q": -1.7763042449951172, "max_q": -0.062044091522693634, "min_q": -6.641458034515381}, "center4": {"mean_q": -1.8963090181350708, "max_q": -0.20945607125759125, "min_q": -6.1198811531066895}, "center5": {"mean_q": -1.8859871625900269, "max_q": -0.17797638475894928, "min_q": -6.473938465118408}, "center6": {"mean_q": -2.305509328842163, "max_q": -0.33083680272102356, "min_q": -7.367789268493652}, "center7": {"mean_q": -2.2851741313934326, "max_q": -0.1476583182811737, "min_q": -6.904779434204102}, "center8": {"mean_q": -2.5459065437316895, "max_q": -0.5931591987609863, "min_q": -6.638499736785889}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 7014, "episodes_total": 24, "training_iteration": 7, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_12-15-13", "timestamp": 1580296513, "time_this_iter_s": 1290.5337190628052, "time_total_s": 7358.08944606781, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7358.08944606781, "timesteps_since_restore": 7014, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 27.299944994499448, "ram_util_percent": 58.11001100110011}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -2065.265251475013, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -229.47391683055713, "center1": -229.47391683055713, "center2": -229.47391683055713, "center3": -229.47391683055713, "center4": -229.47391683055713, "center5": -229.47391683055713, "center6": -229.47391683055713, "center7": -229.47391683055713, "center8": -229.47391683055713}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 310.1143568459735, "mean_processing_ms": 7.966871912404427, "mean_inference_ms": 5.626981642720483}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1336, "num_steps_trained": 5430000, "num_steps_sampled": 8016, "sample_time_ms": 342.869, "replay_time_ms": 3296.236, "grad_time_ms": 3489.94, "update_time_ms": 235.184, "opt_peak_throughput": 1432.689, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -2.625037431716919, "max_q": -0.2877410650253296, "min_q": -7.436836242675781}, "center1": {"mean_q": -1.91218101978302, "max_q": -0.017909612506628036, "min_q": -6.950730323791504}, "center2": {"mean_q": -2.486452341079712, "max_q": -0.09803246706724167, "min_q": -8.614158630371094}, "center3": {"mean_q": -2.1599795818328857, "max_q": -0.15412907302379608, "min_q": -7.947649955749512}, "center4": {"mean_q": -2.0131070613861084, "max_q": -0.23378044366836548, "min_q": -5.938897132873535}, "center5": {"mean_q": -2.0764663219451904, "max_q": -0.17218054831027985, "min_q": -7.053001403808594}, "center6": {"mean_q": -2.4085500240325928, "max_q": -0.232961505651474, "min_q": -8.002660751342773}, "center7": {"mean_q": -2.6788575649261475, "max_q": -0.21503476798534393, "min_q": -7.832220077514648}, "center8": {"mean_q": -2.8607566356658936, "max_q": -0.7108327150344849, "min_q": -6.959238529205322}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 8016, "episodes_total": 30, "training_iteration": 8, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_12-35-21", "timestamp": 1580297721, "time_this_iter_s": 1208.755676984787, "time_total_s": 8566.845123052597, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8566.845123052597, "timesteps_since_restore": 8016, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.76909090909091, "ram_util_percent": 56.36486803519062}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1964.633203246868, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -218.292578138541, "center1": -218.292578138541, "center2": -218.292578138541, "center3": -218.292578138541, "center4": -218.292578138541, "center5": -218.292578138541, "center6": -218.292578138541, "center7": -218.292578138541, "center8": -218.292578138541}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 308.9106298306177, "mean_processing_ms": 8.045870620358441, "mean_inference_ms": 5.4680258878163155}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1503, "num_steps_trained": 6265000, "num_steps_sampled": 9018, "sample_time_ms": 510.386, "replay_time_ms": 3260.858, "grad_time_ms": 3576.791, "update_time_ms": 44.945, "opt_peak_throughput": 1397.901, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -2.8364102840423584, "max_q": -0.24980583786964417, "min_q": -8.089488983154297}, "center1": {"mean_q": -2.0388259887695312, "max_q": -0.09154534339904785, "min_q": -7.4558186531066895}, "center2": {"mean_q": -2.749112129211426, "max_q": -0.23121558129787445, "min_q": -9.934444427490234}, "center3": {"mean_q": -2.513087511062622, "max_q": -0.25710928440093994, "min_q": -8.513387680053711}, "center4": {"mean_q": -2.184211015701294, "max_q": -0.16120052337646484, "min_q": -6.187664031982422}, "center5": {"mean_q": -2.2792110443115234, "max_q": -0.23675352334976196, "min_q": -7.695032596588135}, "center6": {"mean_q": -2.4019393920898438, "max_q": -0.168732687830925, "min_q": -8.433618545532227}, "center7": {"mean_q": -2.824429988861084, "max_q": -0.28821733593940735, "min_q": -8.806559562683105}, "center8": {"mean_q": -2.703765630722046, "max_q": -0.45000553131103516, "min_q": -6.616124153137207}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 9018, "episodes_total": 36, "training_iteration": 9, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_12-55-36", "timestamp": 1580298936, "time_this_iter_s": 1214.1215238571167, "time_total_s": 9780.966646909714, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9780.966646909714, "timesteps_since_restore": 9018, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 25.305950991831967, "ram_util_percent": 67.03938156359393}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1964.6332032468677, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -218.292578138541, "center1": -218.292578138541, "center2": -218.292578138541, "center3": -218.292578138541, "center4": -218.292578138541, "center5": -218.292578138541, "center6": -218.292578138541, "center7": -218.292578138541, "center8": -218.292578138541}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 308.91062983061767, "mean_processing_ms": 8.045870620358443, "mean_inference_ms": 5.4680258878163155}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1670, "num_steps_trained": 7100000, "num_steps_sampled": 10020, "sample_time_ms": 347.914, "replay_time_ms": 3277.831, "grad_time_ms": 3562.537, "update_time_ms": 309.421, "opt_peak_throughput": 1403.494, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -3.0511269569396973, "max_q": -0.2468726634979248, "min_q": -8.955047607421875}, "center1": {"mean_q": -2.1274640560150146, "max_q": -0.1155896782875061, "min_q": -7.798971652984619}, "center2": {"mean_q": -2.7017343044281006, "max_q": -0.10973654687404633, "min_q": -10.077506065368652}, "center3": {"mean_q": -2.578810453414917, "max_q": -0.19080926477909088, "min_q": -9.606189727783203}, "center4": {"mean_q": -2.4728753566741943, "max_q": -0.20352564752101898, "min_q": -7.209028720855713}, "center5": {"mean_q": -2.6100656986236572, "max_q": -0.3544759452342987, "min_q": -8.635018348693848}, "center6": {"mean_q": -2.3525826930999756, "max_q": -0.5078896284103394, "min_q": -7.210473537445068}, "center7": {"mean_q": -2.9752988815307617, "max_q": -0.19597876071929932, "min_q": -9.554848670959473}, "center8": {"mean_q": -3.32649302482605, "max_q": -0.8172463774681091, "min_q": -7.56904411315918}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 10020, "episodes_total": 36, "training_iteration": 10, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_13-16-20", "timestamp": 1580300180, "time_this_iter_s": 1244.3675260543823, "time_total_s": 11025.334172964096, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11025.334172964096, "timesteps_since_restore": 10020, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 24.731446540880505, "ram_util_percent": 79.61789594053744}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1862.3177048326038, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -206.924189425845, "center1": -206.924189425845, "center2": -206.924189425845, "center3": -206.924189425845, "center4": -206.924189425845, "center5": -206.924189425845, "center6": -206.924189425845, "center7": -206.924189425845, "center8": -206.924189425845}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 307.5866663259181, "mean_processing_ms": 8.064573835319349, "mean_inference_ms": 5.327475722876313}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1837, "num_steps_trained": 7935000, "num_steps_sampled": 11022, "sample_time_ms": 341.649, "replay_time_ms": 3250.33, "grad_time_ms": 3480.441, "update_time_ms": 314.429, "opt_peak_throughput": 1436.6, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -3.1736667156219482, "max_q": 1.1277716159820557, "min_q": -9.68899917602539}, "center1": {"mean_q": -2.2585818767547607, "max_q": -0.15563352406024933, "min_q": -8.237462043762207}, "center2": {"mean_q": -2.7396507263183594, "max_q": -0.41952526569366455, "min_q": -9.922959327697754}, "center3": {"mean_q": -2.835484743118286, "max_q": -0.3325662612915039, "min_q": -10.25910758972168}, "center4": {"mean_q": -2.4712867736816406, "max_q": -0.22076117992401123, "min_q": -6.953151226043701}, "center5": {"mean_q": -2.6411492824554443, "max_q": -0.370568186044693, "min_q": -9.222497940063477}, "center6": {"mean_q": -2.2154297828674316, "max_q": -0.35419535636901855, "min_q": -6.815699577331543}, "center7": {"mean_q": -3.128272771835327, "max_q": -0.2631915807723999, "min_q": -10.466583251953125}, "center8": {"mean_q": -3.557450771331787, "max_q": -0.8841522336006165, "min_q": -7.871119976043701}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 11022, "episodes_total": 42, "training_iteration": 11, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_13-36-48", "timestamp": 1580301408, "time_this_iter_s": 1227.9577949047089, "time_total_s": 12253.291967868805, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12253.291967868805, "timesteps_since_restore": 11022, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 24.613121387283236, "ram_util_percent": 82.08508670520231}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1807.5356173351372, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -200.83729081501534, "center1": -200.83729081501534, "center2": -200.83729081501534, "center3": -200.83729081501534, "center4": -200.83729081501534, "center5": -200.83729081501534, "center6": -200.83729081501534, "center7": -200.83729081501534, "center8": -200.83729081501534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 306.41360390389355, "mean_processing_ms": 8.116592241263143, "mean_inference_ms": 5.213482577011743}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2004, "num_steps_trained": 8770000, "num_steps_sampled": 12024, "sample_time_ms": 516.031, "replay_time_ms": 3298.627, "grad_time_ms": 3559.638, "update_time_ms": 115.792, "opt_peak_throughput": 1404.637, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -3.795632839202881, "max_q": 0.5647748112678528, "min_q": -12.013092994689941}, "center1": {"mean_q": -2.479295015335083, "max_q": -0.2768009603023529, "min_q": -8.7399320602417}, "center2": {"mean_q": -2.8155007362365723, "max_q": -0.3577026426792145, "min_q": -10.194040298461914}, "center3": {"mean_q": -3.0659234523773193, "max_q": -0.380401074886322, "min_q": -10.538052558898926}, "center4": {"mean_q": -2.860344409942627, "max_q": -0.4433996081352234, "min_q": -8.063994407653809}, "center5": {"mean_q": -2.7924346923828125, "max_q": -0.2956894040107727, "min_q": -9.323559761047363}, "center6": {"mean_q": -2.434316873550415, "max_q": -0.43811532855033875, "min_q": -7.516127586364746}, "center7": {"mean_q": -3.5782389640808105, "max_q": -0.3983396887779236, "min_q": -11.876533508300781}, "center8": {"mean_q": -3.4356868267059326, "max_q": -0.6703565120697021, "min_q": -7.926747798919678}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 12024, "episodes_total": 48, "training_iteration": 12, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_13-57-42", "timestamp": 1580302662, "time_this_iter_s": 1254.3981049060822, "time_total_s": 13507.690072774887, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13507.690072774887, "timesteps_since_restore": 12024, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 24.76543700340522, "ram_util_percent": 82.10703745743474}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1807.5356173351372, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -200.83729081501534, "center1": -200.83729081501534, "center2": -200.83729081501534, "center3": -200.83729081501534, "center4": -200.83729081501534, "center5": -200.83729081501534, "center6": -200.83729081501534, "center7": -200.83729081501534, "center8": -200.83729081501534}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 306.41360390389355, "mean_processing_ms": 8.116592241263143, "mean_inference_ms": 5.213482577011742}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2171, "num_steps_trained": 9605000, "num_steps_sampled": 13026, "sample_time_ms": 347.14, "replay_time_ms": 3293.499, "grad_time_ms": 3635.616, "update_time_ms": 247.269, "opt_peak_throughput": 1375.283, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.065303802490234, "max_q": 0.0735137015581131, "min_q": -12.354957580566406}, "center1": {"mean_q": -2.816366195678711, "max_q": -0.31488150358200073, "min_q": -8.653556823730469}, "center2": {"mean_q": -2.9804887771606445, "max_q": -0.2563490867614746, "min_q": -10.32738208770752}, "center3": {"mean_q": -3.0708460807800293, "max_q": -0.3150542974472046, "min_q": -10.912162780761719}, "center4": {"mean_q": -3.021291494369507, "max_q": -0.3715401589870453, "min_q": -8.68712043762207}, "center5": {"mean_q": -3.2470226287841797, "max_q": -0.4659790098667145, "min_q": -10.557772636413574}, "center6": {"mean_q": -2.819920778274536, "max_q": -0.6197434663772583, "min_q": -8.142024993896484}, "center7": {"mean_q": -3.4852054119110107, "max_q": -0.2900086045265198, "min_q": -12.535863876342773}, "center8": {"mean_q": -4.013570308685303, "max_q": -0.8764626383781433, "min_q": -9.07273006439209}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 13026, "episodes_total": 48, "training_iteration": 13, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_14-18-28", "timestamp": 1580303908, "time_this_iter_s": 1245.1981902122498, "time_total_s": 14752.888262987137, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14752.888262987137, "timesteps_since_restore": 13026, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 24.880227920227917, "ram_util_percent": 82.14131054131055}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1839.0063721932615, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -204.33404135480689, "center1": -204.33404135480689, "center2": -204.33404135480689, "center3": -204.33404135480689, "center4": -204.33404135480689, "center5": -204.33404135480689, "center6": -204.33404135480689, "center7": -204.33404135480689, "center8": -204.33404135480689}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 305.28080207783273, "mean_processing_ms": 8.129725836857606, "mean_inference_ms": 5.11205142540634}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2338, "num_steps_trained": 10440000, "num_steps_sampled": 14028, "sample_time_ms": 348.521, "replay_time_ms": 3225.273, "grad_time_ms": 3409.8, "update_time_ms": 126.144, "opt_peak_throughput": 1466.361, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.098272323608398, "max_q": -0.7658563852310181, "min_q": -11.707908630371094}, "center1": {"mean_q": -2.8518435955047607, "max_q": -0.33720946311950684, "min_q": -8.740043640136719}, "center2": {"mean_q": -3.023972272872925, "max_q": -0.011523542925715446, "min_q": -10.464001655578613}, "center3": {"mean_q": -3.332803964614868, "max_q": -0.25582167506217957, "min_q": -12.532071113586426}, "center4": {"mean_q": -3.0426371097564697, "max_q": -0.2633412778377533, "min_q": -8.826799392700195}, "center5": {"mean_q": -3.423091411590576, "max_q": -0.4759101867675781, "min_q": -10.999129295349121}, "center6": {"mean_q": -2.7422139644622803, "max_q": -0.4057043790817261, "min_q": -8.375268936157227}, "center7": {"mean_q": -3.800142288208008, "max_q": -0.44269809126853943, "min_q": -13.531912803649902}, "center8": {"mean_q": -4.231628894805908, "max_q": -0.9945400953292847, "min_q": -9.678919792175293}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 14028, "episodes_total": 54, "training_iteration": 14, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_14-39-07", "timestamp": 1580305147, "time_this_iter_s": 1238.9778802394867, "time_total_s": 15991.866143226624, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15991.866143226624, "timesteps_since_restore": 14028, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.533677567412507, "ram_util_percent": 82.152495697074}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1788.0349517505454, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -198.67055019450513, "center1": -198.67055019450513, "center2": -198.67055019450513, "center3": -198.67055019450513, "center4": -198.67055019450513, "center5": -198.67055019450513, "center6": -198.67055019450513, "center7": -198.67055019450513, "center8": -198.67055019450513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 304.3032802002636, "mean_processing_ms": 8.165993475470016, "mean_inference_ms": 5.026524863254606}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2505, "num_steps_trained": 11275000, "num_steps_sampled": 15030, "sample_time_ms": 520.67, "replay_time_ms": 3267.101, "grad_time_ms": 3551.465, "update_time_ms": 291.633, "opt_peak_throughput": 1407.87, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -3.968029022216797, "max_q": -0.383444219827652, "min_q": -11.781357765197754}, "center1": {"mean_q": -3.039111614227295, "max_q": -0.2908005118370056, "min_q": -9.207719802856445}, "center2": {"mean_q": -3.2130935192108154, "max_q": -0.03990790247917175, "min_q": -10.384468078613281}, "center3": {"mean_q": -3.512603998184204, "max_q": -0.3639804720878601, "min_q": -12.859498977661133}, "center4": {"mean_q": -3.2388479709625244, "max_q": -0.3269077241420746, "min_q": -9.070880889892578}, "center5": {"mean_q": -3.3587758541107178, "max_q": -0.39993876218795776, "min_q": -10.845101356506348}, "center6": {"mean_q": -2.928079605102539, "max_q": -0.4206320345401764, "min_q": -8.720783233642578}, "center7": {"mean_q": -3.8324577808380127, "max_q": -0.23818442225456238, "min_q": -14.210439682006836}, "center8": {"mean_q": -4.2977294921875, "max_q": -0.8223245739936829, "min_q": -9.46667194366455}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 15030, "episodes_total": 60, "training_iteration": 15, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_14-59-44", "timestamp": 1580306384, "time_this_iter_s": 1237.6076390743256, "time_total_s": 17229.47378230095, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17229.47378230095, "timesteps_since_restore": 15030, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.95060310166571, "ram_util_percent": 82.18242389431363}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1788.0349517505454, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -198.67055019450515, "center1": -198.67055019450515, "center2": -198.67055019450515, "center3": -198.67055019450515, "center4": -198.67055019450515, "center5": -198.67055019450515, "center6": -198.67055019450515, "center7": -198.67055019450515, "center8": -198.67055019450515}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 304.30328020026366, "mean_processing_ms": 8.165993475470014, "mean_inference_ms": 5.026524863254605}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2672, "num_steps_trained": 12110000, "num_steps_sampled": 16032, "sample_time_ms": 344.327, "replay_time_ms": 3303.382, "grad_time_ms": 3494.225, "update_time_ms": 319.465, "opt_peak_throughput": 1430.932, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.411918640136719, "max_q": -0.4197995960712433, "min_q": -12.741606712341309}, "center1": {"mean_q": -3.3347928524017334, "max_q": -0.44921696186065674, "min_q": -9.401679039001465}, "center2": {"mean_q": -3.621142625808716, "max_q": 0.6268545389175415, "min_q": -10.952485084533691}, "center3": {"mean_q": -3.9965643882751465, "max_q": -0.40067994594573975, "min_q": -13.72334098815918}, "center4": {"mean_q": -3.729372978210449, "max_q": -0.3743966817855835, "min_q": -10.140768051147461}, "center5": {"mean_q": -3.6748640537261963, "max_q": -0.47169119119644165, "min_q": -11.490941047668457}, "center6": {"mean_q": -3.1885552406311035, "max_q": -0.586922287940979, "min_q": -8.970804214477539}, "center7": {"mean_q": -4.303704738616943, "max_q": -0.5008914470672607, "min_q": -15.333558082580566}, "center8": {"mean_q": -4.664675235748291, "max_q": -0.9302636384963989, "min_q": -10.313698768615723}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 16032, "episodes_total": 60, "training_iteration": 16, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_15-20-21", "timestamp": 1580307621, "time_this_iter_s": 1236.5079889297485, "time_total_s": 18465.981771230698, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18465.981771230698, "timesteps_since_restore": 16032, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 24.96106651376147, "ram_util_percent": 82.21530963302752}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1763.2366536537406, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -195.91518373930458, "center1": -195.91518373930458, "center2": -195.91518373930458, "center3": -195.91518373930458, "center4": -195.91518373930458, "center5": -195.91518373930458, "center6": -195.91518373930458, "center7": -195.91518373930458, "center8": -195.91518373930458}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 303.3811502649592, "mean_processing_ms": 8.176574096131567, "mean_inference_ms": 4.949712248506147}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2839, "num_steps_trained": 12945000, "num_steps_sampled": 17034, "sample_time_ms": 344.641, "replay_time_ms": 3279.976, "grad_time_ms": 3598.68, "update_time_ms": 312.112, "opt_peak_throughput": 1389.399, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.645049095153809, "max_q": -0.8366272449493408, "min_q": -13.304455757141113}, "center1": {"mean_q": -3.5388858318328857, "max_q": -0.4227170944213867, "min_q": -9.547080039978027}, "center2": {"mean_q": -3.924551486968994, "max_q": 0.8474642634391785, "min_q": -11.231093406677246}, "center3": {"mean_q": -4.198523998260498, "max_q": -0.5294762849807739, "min_q": -15.28475284576416}, "center4": {"mean_q": -3.70961594581604, "max_q": -0.1405697464942932, "min_q": -10.94547176361084}, "center5": {"mean_q": -3.8285417556762695, "max_q": -0.4234031140804291, "min_q": -11.679553985595703}, "center6": {"mean_q": -3.7049777507781982, "max_q": -0.771842896938324, "min_q": -9.75305461883545}, "center7": {"mean_q": -4.595378398895264, "max_q": -0.42340409755706787, "min_q": -16.748037338256836}, "center8": {"mean_q": -4.759645938873291, "max_q": -0.8147297501564026, "min_q": -10.20882511138916}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 17034, "episodes_total": 66, "training_iteration": 17, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_15-41-07", "timestamp": 1580308867, "time_this_iter_s": 1246.1441748142242, "time_total_s": 19712.125946044922, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 19712.125946044922, "timesteps_since_restore": 17034, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 24.408576329331044, "ram_util_percent": 82.21886792452831}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1737.721630101954, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -193.0801811224394, "center1": -193.0801811224394, "center2": -193.0801811224394, "center3": -193.0801811224394, "center4": -193.0801811224394, "center5": -193.0801811224394, "center6": -193.0801811224394, "center7": -193.0801811224394, "center8": -193.0801811224394}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 302.57057729196106, "mean_processing_ms": 8.203345023093151, "mean_inference_ms": 4.882821592784016}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3006, "num_steps_trained": 13780000, "num_steps_sampled": 18036, "sample_time_ms": 521.113, "replay_time_ms": 3243.468, "grad_time_ms": 3565.959, "update_time_ms": 315.394, "opt_peak_throughput": 1402.147, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.8682098388671875, "max_q": -0.6153928637504578, "min_q": -13.903058052062988}, "center1": {"mean_q": -3.840729236602783, "max_q": -0.5143154859542847, "min_q": -10.042659759521484}, "center2": {"mean_q": -3.84667706489563, "max_q": -0.6147672533988953, "min_q": -10.6300687789917}, "center3": {"mean_q": -4.08012580871582, "max_q": -0.01653524860739708, "min_q": -16.28568458557129}, "center4": {"mean_q": -3.939436435699463, "max_q": -0.02578505501151085, "min_q": -10.906227111816406}, "center5": {"mean_q": -4.278157711029053, "max_q": -0.6371119618415833, "min_q": -12.326054573059082}, "center6": {"mean_q": -3.6751437187194824, "max_q": -0.6935510635375977, "min_q": -10.084380149841309}, "center7": {"mean_q": -4.829058647155762, "max_q": -0.6256681084632874, "min_q": -17.484506607055664}, "center8": {"mean_q": -4.912984371185303, "max_q": -0.8736514449119568, "min_q": -10.662674903869629}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 18036, "episodes_total": 72, "training_iteration": 18, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_16-01-43", "timestamp": 1580310103, "time_this_iter_s": 1235.9866118431091, "time_total_s": 20948.11255788803, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 20948.11255788803, "timesteps_since_restore": 18036, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 25.065249856404364, "ram_util_percent": 82.2506031016657}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1737.721630101954, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -193.08018112243937, "center1": -193.08018112243937, "center2": -193.08018112243937, "center3": -193.08018112243937, "center4": -193.08018112243937, "center5": -193.08018112243937, "center6": -193.08018112243937, "center7": -193.08018112243937, "center8": -193.08018112243937}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 302.57057729196106, "mean_processing_ms": 8.203345023093151, "mean_inference_ms": 4.882821592784016}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3173, "num_steps_trained": 14615000, "num_steps_sampled": 19038, "sample_time_ms": 339.348, "replay_time_ms": 3224.555, "grad_time_ms": 3550.715, "update_time_ms": 110.833, "opt_peak_throughput": 1408.167, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -5.019023418426514, "max_q": -0.8161304593086243, "min_q": -14.525339126586914}, "center1": {"mean_q": -4.046177387237549, "max_q": -0.5642528533935547, "min_q": -10.36536979675293}, "center2": {"mean_q": -3.936070680618286, "max_q": 0.3236025273799896, "min_q": -10.839734077453613}, "center3": {"mean_q": -4.53135871887207, "max_q": 0.02389509603381157, "min_q": -17.380352020263672}, "center4": {"mean_q": -4.318589687347412, "max_q": -0.5144778490066528, "min_q": -12.00098705291748}, "center5": {"mean_q": -4.169434547424316, "max_q": -0.44247326254844666, "min_q": -12.045710563659668}, "center6": {"mean_q": -3.836282730102539, "max_q": -0.41525885462760925, "min_q": -11.231565475463867}, "center7": {"mean_q": -4.795400142669678, "max_q": -0.2812914252281189, "min_q": -18.160789489746094}, "center8": {"mean_q": -5.286693096160889, "max_q": -1.0154184103012085, "min_q": -11.461228370666504}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 19038, "episodes_total": 72, "training_iteration": 19, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_16-22-34", "timestamp": 1580311354, "time_this_iter_s": 1250.1908571720123, "time_total_s": 22198.303415060043, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 22198.303415060043, "timesteps_since_restore": 19038, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 24.615073947667806, "ram_util_percent": 82.28384527872582}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1709.0435992153418, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -189.89373324614914, "center1": -189.89373324614914, "center2": -189.89373324614914, "center3": -189.89373324614914, "center4": -189.89373324614914, "center5": -189.89373324614914, "center6": -189.89373324614914, "center7": -189.89373324614914, "center8": -189.89373324614914}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 301.811482941053, "mean_processing_ms": 8.212896455071817, "mean_inference_ms": 4.822029023799413}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3340, "num_steps_trained": 15450000, "num_steps_sampled": 20040, "sample_time_ms": 344.072, "replay_time_ms": 3287.503, "grad_time_ms": 3543.839, "update_time_ms": 322.068, "opt_peak_throughput": 1410.899, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -4.923079490661621, "max_q": -0.5677803754806519, "min_q": -14.58176326751709}, "center1": {"mean_q": -4.233295917510986, "max_q": -0.3178723156452179, "min_q": -10.354814529418945}, "center2": {"mean_q": -4.542928695678711, "max_q": -0.5701231360435486, "min_q": -11.193840026855469}, "center3": {"mean_q": -4.847437858581543, "max_q": -0.17326146364212036, "min_q": -17.96038055419922}, "center4": {"mean_q": -4.495059013366699, "max_q": -0.6157354116439819, "min_q": -12.391100883483887}, "center5": {"mean_q": -4.718690872192383, "max_q": 0.019810296595096588, "min_q": -14.018056869506836}, "center6": {"mean_q": -3.8609602451324463, "max_q": 0.27296242117881775, "min_q": -10.710599899291992}, "center7": {"mean_q": -5.171723365783691, "max_q": -0.6699290871620178, "min_q": -19.058881759643555}, "center8": {"mean_q": -5.150374412536621, "max_q": -0.9252378940582275, "min_q": -10.955035209655762}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 20040, "episodes_total": 78, "training_iteration": 20, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_16-43-28", "timestamp": 1580312608, "time_this_iter_s": 1254.790662765503, "time_total_s": 23453.094077825546, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 23453.094077825546, "timesteps_since_restore": 20040, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 24.845779036827196, "ram_util_percent": 82.30152974504249}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1679.7227151523632, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -186.63585723915153, "center1": -186.63585723915153, "center2": -186.63585723915153, "center3": -186.63585723915153, "center4": -186.63585723915153, "center5": -186.63585723915153, "center6": -186.63585723915153, "center7": -186.63585723915153, "center8": -186.63585723915153}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 301.1627118439049, "mean_processing_ms": 8.234235905026502, "mean_inference_ms": 4.768602740320498}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3507, "num_steps_trained": 16285000, "num_steps_sampled": 21042, "sample_time_ms": 549.389, "replay_time_ms": 3596.781, "grad_time_ms": 4088.501, "update_time_ms": 116.852, "opt_peak_throughput": 1222.942, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -5.3103179931640625, "max_q": -0.544611930847168, "min_q": -15.883325576782227}, "center1": {"mean_q": -4.5856242179870605, "max_q": -0.6758993268013, "min_q": -10.62179183959961}, "center2": {"mean_q": -4.498420715332031, "max_q": -0.14303676784038544, "min_q": -10.950163841247559}, "center3": {"mean_q": -5.253936767578125, "max_q": -0.5935351252555847, "min_q": -19.269962310791016}, "center4": {"mean_q": -4.868927001953125, "max_q": -0.7803011536598206, "min_q": -13.67345905303955}, "center5": {"mean_q": -4.9585747718811035, "max_q": -0.7886650562286377, "min_q": -12.517648696899414}, "center6": {"mean_q": -4.2700371742248535, "max_q": -0.5801146626472473, "min_q": -12.228951454162598}, "center7": {"mean_q": -5.595609188079834, "max_q": -0.6131463646888733, "min_q": -21.36094093322754}, "center8": {"mean_q": -5.53795051574707, "max_q": 0.23454070091247559, "min_q": -11.706634521484375}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 21042, "episodes_total": 84, "training_iteration": 21, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_17-04-56", "timestamp": 1580313896, "time_this_iter_s": 1287.4952640533447, "time_total_s": 24740.58934187889, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 24740.58934187889, "timesteps_since_restore": 21042, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 26.14526431718062, "ram_util_percent": 82.32389867841408}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1679.7227151523634, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -186.63585723915153, "center1": -186.63585723915153, "center2": -186.63585723915153, "center3": -186.63585723915153, "center4": -186.63585723915153, "center5": -186.63585723915153, "center6": -186.63585723915153, "center7": -186.63585723915153, "center8": -186.63585723915153}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 301.1627118439049, "mean_processing_ms": 8.234235905026502, "mean_inference_ms": 4.768602740320498}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3674, "num_steps_trained": 17120000, "num_steps_sampled": 22044, "sample_time_ms": 444.463, "replay_time_ms": 3518.785, "grad_time_ms": 3969.17, "update_time_ms": 323.951, "opt_peak_throughput": 1259.709, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -5.414522647857666, "max_q": 0.27232858538627625, "min_q": -16.067890167236328}, "center1": {"mean_q": -4.473225116729736, "max_q": -0.48269397020339966, "min_q": -10.164410591125488}, "center2": {"mean_q": -4.918278694152832, "max_q": -0.6488271355628967, "min_q": -11.913150787353516}, "center3": {"mean_q": -5.250599384307861, "max_q": -0.6355404853820801, "min_q": -19.60393524169922}, "center4": {"mean_q": -4.831168174743652, "max_q": -0.17255799472332, "min_q": -14.939192771911621}, "center5": {"mean_q": -4.8853936195373535, "max_q": -0.6572216153144836, "min_q": -12.8934326171875}, "center6": {"mean_q": -4.617250919342041, "max_q": -0.7797627449035645, "min_q": -13.141615867614746}, "center7": {"mean_q": -5.852923393249512, "max_q": -0.6783680319786072, "min_q": -22.529489517211914}, "center8": {"mean_q": -5.907841205596924, "max_q": 0.7500622272491455, "min_q": -13.0178804397583}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 22044, "episodes_total": 84, "training_iteration": 22, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_17-27-44", "timestamp": 1580315264, "time_this_iter_s": 1367.5903401374817, "time_total_s": 26108.179682016373, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 26108.179682016373, "timesteps_since_restore": 22044, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 27.72201453790239, "ram_util_percent": 82.38234683281412}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1650.640499190746, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -183.4044999100829, "center1": -183.4044999100829, "center2": -183.4044999100829, "center3": -183.4044999100829, "center4": -183.4044999100829, "center5": -183.4044999100829, "center6": -183.4044999100829, "center7": -183.4044999100829, "center8": -183.4044999100829}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 300.6342323155573, "mean_processing_ms": 8.243402178997837, "mean_inference_ms": 4.721102051320964}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3841, "num_steps_trained": 17955000, "num_steps_sampled": 23046, "sample_time_ms": 356.289, "replay_time_ms": 3453.275, "grad_time_ms": 3725.913, "update_time_ms": 307.523, "opt_peak_throughput": 1341.953, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -5.863866329193115, "max_q": -0.7405965328216553, "min_q": -17.041027069091797}, "center1": {"mean_q": -4.671475887298584, "max_q": -0.5497498512268066, "min_q": -10.657445907592773}, "center2": {"mean_q": -4.943697452545166, "max_q": -0.5473751425743103, "min_q": -12.405974388122559}, "center3": {"mean_q": -5.344326019287109, "max_q": -0.4183749556541443, "min_q": -20.819793701171875}, "center4": {"mean_q": -5.006696701049805, "max_q": -0.6141780018806458, "min_q": -14.642046928405762}, "center5": {"mean_q": -4.919323444366455, "max_q": -0.21500462293624878, "min_q": -12.622590065002441}, "center6": {"mean_q": -4.65162992477417, "max_q": -0.27932360768318176, "min_q": -13.45035171508789}, "center7": {"mean_q": -5.8872785568237305, "max_q": -0.6202999353408813, "min_q": -22.027666091918945}, "center8": {"mean_q": -6.005932331085205, "max_q": -0.5806657671928406, "min_q": -13.888357162475586}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 23046, "episodes_total": 90, "training_iteration": 23, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_17-50-11", "timestamp": 1580316611, "time_this_iter_s": 1347.4459400177002, "time_total_s": 27455.625622034073, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 27455.625622034073, "timesteps_since_restore": 23046, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 28.860798738833424, "ram_util_percent": 64.4084077771939}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1622.638948750299, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -180.2932165278111, "center1": -180.2932165278111, "center2": -180.2932165278111, "center3": -180.2932165278111, "center4": -180.2932165278111, "center5": -180.2932165278111, "center6": -180.2932165278111, "center7": -180.2932165278111, "center8": -180.2932165278111}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 300.1477565555644, "mean_processing_ms": 8.258814435235264, "mean_inference_ms": 4.679176574328523}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4008, "num_steps_trained": 18790000, "num_steps_sampled": 24048, "sample_time_ms": 497.291, "replay_time_ms": 3326.61, "grad_time_ms": 3576.073, "update_time_ms": 42.948, "opt_peak_throughput": 1398.182, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -5.789053916931152, "max_q": -0.0885082259774208, "min_q": -16.763051986694336}, "center1": {"mean_q": -5.073215007781982, "max_q": -0.40051886439323425, "min_q": -11.348123550415039}, "center2": {"mean_q": -5.294322490692139, "max_q": -0.9103447198867798, "min_q": -12.48144245147705}, "center3": {"mean_q": -5.795474052429199, "max_q": -0.7654701471328735, "min_q": -22.200149536132812}, "center4": {"mean_q": -5.444224834442139, "max_q": -0.8533887267112732, "min_q": -15.110154151916504}, "center5": {"mean_q": -5.483353614807129, "max_q": -0.4401085674762726, "min_q": -13.548337936401367}, "center6": {"mean_q": -4.894565105438232, "max_q": -0.18098025023937225, "min_q": -13.002840042114258}, "center7": {"mean_q": -6.125065803527832, "max_q": -0.6701345443725586, "min_q": -25.276880264282227}, "center8": {"mean_q": -6.407116413116455, "max_q": 0.36994072794914246, "min_q": -15.299276351928711}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 24048, "episodes_total": 96, "training_iteration": 24, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_18-11-02", "timestamp": 1580317862, "time_this_iter_s": 1250.743614912033, "time_total_s": 28706.369236946106, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 28706.369236946106, "timesteps_since_restore": 24048, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.264301929625425, "ram_util_percent": 54.08524404086266}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1622.638948750299, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -180.2932165278111, "center1": -180.2932165278111, "center2": -180.2932165278111, "center3": -180.2932165278111, "center4": -180.2932165278111, "center5": -180.2932165278111, "center6": -180.2932165278111, "center7": -180.2932165278111, "center8": -180.2932165278111}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 300.1477565555644, "mean_processing_ms": 8.25881443523526, "mean_inference_ms": 4.679176574328523}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4175, "num_steps_trained": 19625000, "num_steps_sampled": 25050, "sample_time_ms": 341.585, "replay_time_ms": 3270.809, "grad_time_ms": 3592.491, "update_time_ms": 233.397, "opt_peak_throughput": 1391.792, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.019103050231934, "max_q": -0.3938482403755188, "min_q": -18.180622100830078}, "center1": {"mean_q": -5.310511112213135, "max_q": -0.5553650259971619, "min_q": -11.905351638793945}, "center2": {"mean_q": -5.363842010498047, "max_q": -0.18250036239624023, "min_q": -13.171046257019043}, "center3": {"mean_q": -5.8991780281066895, "max_q": 0.49567970633506775, "min_q": -21.74699592590332}, "center4": {"mean_q": -5.724498748779297, "max_q": -0.3871539235115051, "min_q": -18.91155433654785}, "center5": {"mean_q": -5.584750175476074, "max_q": 0.2157466560602188, "min_q": -13.393148422241211}, "center6": {"mean_q": -4.821401596069336, "max_q": -0.15666791796684265, "min_q": -12.102880477905273}, "center7": {"mean_q": -6.127116680145264, "max_q": -0.5353341698646545, "min_q": -24.243343353271484}, "center8": {"mean_q": -6.404839038848877, "max_q": -0.9626027345657349, "min_q": -13.918508529663086}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 25050, "episodes_total": 96, "training_iteration": 25, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_18-31-32", "timestamp": 1580319092, "time_this_iter_s": 1230.5135700702667, "time_total_s": 29936.882807016373, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 29936.882807016373, "timesteps_since_restore": 25050, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 24.322824207492793, "ram_util_percent": 63.81440922190202}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -837.1622226092799, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1603.5787917153118, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -93.01802473436405, "center1": -93.01802473436405, "center2": -93.01802473436405, "center3": -93.01802473436405, "center4": -93.01802473436405, "center5": -93.01802473436405, "center6": -93.01802473436405, "center7": -93.01802473436405, "center8": -93.01802473436405}, "policy_reward_mean": {"center0": -178.17542130170136, "center1": -178.17542130170136, "center2": -178.17542130170136, "center3": -178.17542130170136, "center4": -178.17542130170136, "center5": -178.17542130170136, "center6": -178.17542130170136, "center7": -178.17542130170136, "center8": -178.17542130170136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 299.46107245938543, "mean_processing_ms": 8.295109907890152, "mean_inference_ms": 4.594844802699251}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4342, "num_steps_trained": 20460000, "num_steps_sampled": 26052, "sample_time_ms": 639.604, "replay_time_ms": 6924.661, "grad_time_ms": 7112.734, "update_time_ms": 170.929, "opt_peak_throughput": 702.965, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.2656331062316895, "max_q": -0.3958851099014282, "min_q": -18.808134078979492}, "center1": {"mean_q": -5.259425163269043, "max_q": -0.6226415038108826, "min_q": -11.90534496307373}, "center2": {"mean_q": -5.707805633544922, "max_q": -0.9158390164375305, "min_q": -14.119641304016113}, "center3": {"mean_q": -6.070805072784424, "max_q": -0.2657510042190552, "min_q": -23.771705627441406}, "center4": {"mean_q": -5.784789562225342, "max_q": 0.6503036618232727, "min_q": -20.317832946777344}, "center5": {"mean_q": -5.564662456512451, "max_q": -0.9094992876052856, "min_q": -13.417624473571777}, "center6": {"mean_q": -5.184236526489258, "max_q": -0.127359539270401, "min_q": -13.47671127319336}, "center7": {"mean_q": -6.172865390777588, "max_q": -0.6641767621040344, "min_q": -26.279138565063477}, "center8": {"mean_q": -7.178926467895508, "max_q": 0.5868195295333862, "min_q": -14.495055198669434}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 26052, "episodes_total": 102, "training_iteration": 26, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_18-56-30", "timestamp": 1580320590, "time_this_iter_s": 1496.9146082401276, "time_total_s": 31433.7974152565, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 31433.7974152565, "timesteps_since_restore": 26052, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.272043519394515, "ram_util_percent": 78.74389782403027}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -976.0501169441859, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1541.2029825259826, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -108.45001299379842, "center1": -108.45001299379842, "center2": -108.45001299379842, "center3": -108.45001299379842, "center4": -108.45001299379842, "center5": -108.45001299379842, "center6": -108.45001299379842, "center7": -108.45001299379842, "center8": -108.45001299379842}, "policy_reward_mean": {"center0": -171.24477583622033, "center1": -171.24477583622033, "center2": -171.24477583622033, "center3": -171.24477583622033, "center4": -171.24477583622033, "center5": -171.24477583622033, "center6": -171.24477583622033, "center7": -171.24477583622033, "center8": -171.24477583622033}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 298.20779914315693, "mean_processing_ms": 8.363903288040582, "mean_inference_ms": 4.435012149353005}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4509, "num_steps_trained": 21295000, "num_steps_sampled": 27054, "sample_time_ms": 533.32, "replay_time_ms": 3487.564, "grad_time_ms": 3740.572, "update_time_ms": 265.917, "opt_peak_throughput": 1336.694, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.496528148651123, "max_q": -0.6337050199508667, "min_q": -18.805994033813477}, "center1": {"mean_q": -5.535857200622559, "max_q": 0.3604351282119751, "min_q": -12.13513469696045}, "center2": {"mean_q": -5.847293853759766, "max_q": -0.7498261332511902, "min_q": -13.980499267578125}, "center3": {"mean_q": -6.275570869445801, "max_q": 0.1681647002696991, "min_q": -25.687755584716797}, "center4": {"mean_q": -5.9265522956848145, "max_q": -0.26394495368003845, "min_q": -19.67647933959961}, "center5": {"mean_q": -5.709820747375488, "max_q": 0.5093916654586792, "min_q": -13.204833030700684}, "center6": {"mean_q": -5.53549861907959, "max_q": -0.9716773629188538, "min_q": -16.082069396972656}, "center7": {"mean_q": -6.586275577545166, "max_q": 2.143678903579712, "min_q": -28.579622268676758}, "center8": {"mean_q": -6.994732856750488, "max_q": 1.7520376443862915, "min_q": -16.062414169311523}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 27054, "episodes_total": 108, "training_iteration": 27, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_19-18-42", "timestamp": 1580321922, "time_this_iter_s": 1332.6503660678864, "time_total_s": 32766.447781324387, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 32766.447781324387, "timesteps_since_restore": 27054, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 26.119989339019188, "ram_util_percent": 82.48262260127932}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -976.0501169441859, "episode_reward_min": -4752.5919454407585, "episode_reward_mean": -1541.2029825259822, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -528.0657717156397, "center1": -528.0657717156397, "center2": -528.0657717156397, "center3": -528.0657717156397, "center4": -528.0657717156397, "center5": -528.0657717156397, "center6": -528.0657717156397, "center7": -528.0657717156397, "center8": -528.0657717156397}, "policy_reward_max": {"center0": -108.45001299379842, "center1": -108.45001299379842, "center2": -108.45001299379842, "center3": -108.45001299379842, "center4": -108.45001299379842, "center5": -108.45001299379842, "center6": -108.45001299379842, "center7": -108.45001299379842, "center8": -108.45001299379842}, "policy_reward_mean": {"center0": -171.24477583622038, "center1": -171.24477583622038, "center2": -171.24477583622038, "center3": -171.24477583622038, "center4": -171.24477583622038, "center5": -171.24477583622038, "center6": -171.24477583622038, "center7": -171.24477583622038, "center8": -171.24477583622038}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 298.20779914315693, "mean_processing_ms": 8.363903288040584, "mean_inference_ms": 4.435012149353003}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4676, "num_steps_trained": 22130000, "num_steps_sampled": 28056, "sample_time_ms": 342.644, "replay_time_ms": 3274.367, "grad_time_ms": 3473.148, "update_time_ms": 252.216, "opt_peak_throughput": 1439.616, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.580638885498047, "max_q": -0.6170582175254822, "min_q": -19.206130981445312}, "center1": {"mean_q": -5.658211708068848, "max_q": 0.30861592292785645, "min_q": -12.546723365783691}, "center2": {"mean_q": -5.906498908996582, "max_q": -0.5122816562652588, "min_q": -14.66075325012207}, "center3": {"mean_q": -6.335372447967529, "max_q": 2.126753568649292, "min_q": -25.438907623291016}, "center4": {"mean_q": -6.288876533508301, "max_q": -0.01818622276186943, "min_q": -18.988733291625977}, "center5": {"mean_q": -5.915297031402588, "max_q": -0.4110184609889984, "min_q": -14.337244033813477}, "center6": {"mean_q": -5.616685390472412, "max_q": -0.7018760442733765, "min_q": -16.882343292236328}, "center7": {"mean_q": -6.970171928405762, "max_q": 0.2522812485694885, "min_q": -29.25604820251465}, "center8": {"mean_q": -8.056524276733398, "max_q": 0.19338031113147736, "min_q": -18.97111701965332}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 28056, "episodes_total": 108, "training_iteration": 28, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_19-39-31", "timestamp": 1580323171, "time_this_iter_s": 1248.6796061992645, "time_total_s": 34015.12738752365, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 34015.12738752365, "timesteps_since_restore": 28056, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 24.999544937428894, "ram_util_percent": 75.39516496018203}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -976.0501169441859, "episode_reward_min": -2312.31063839472, "episode_reward_mean": -1387.1573050179682, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -256.9234042660802, "center1": -256.9234042660802, "center2": -256.9234042660802, "center3": -256.9234042660802, "center4": -256.9234042660802, "center5": -256.9234042660802, "center6": -256.9234042660802, "center7": -256.9234042660802, "center8": -256.9234042660802}, "policy_reward_max": {"center0": -108.45001299379842, "center1": -108.45001299379842, "center2": -108.45001299379842, "center3": -108.45001299379842, "center4": -108.45001299379842, "center5": -108.45001299379842, "center6": -108.45001299379842, "center7": -108.45001299379842, "center8": -108.45001299379842}, "policy_reward_mean": {"center0": -154.128589446441, "center1": -154.128589446441, "center2": -154.128589446441, "center3": -154.128589446441, "center4": -154.128589446441, "center5": -154.128589446441, "center6": -154.128589446441, "center7": -154.128589446441, "center8": -154.128589446441}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 297.10451385946834, "mean_processing_ms": 8.365722192319772, "mean_inference_ms": 4.327955991818261}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4843, "num_steps_trained": 22965000, "num_steps_sampled": 29058, "sample_time_ms": 346.205, "replay_time_ms": 3316.792, "grad_time_ms": 3621.301, "update_time_ms": 185.858, "opt_peak_throughput": 1380.719, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.6237688064575195, "max_q": -0.39265450835227966, "min_q": -21.073936462402344}, "center1": {"mean_q": -6.280241966247559, "max_q": -0.6128573417663574, "min_q": -13.270283699035645}, "center2": {"mean_q": -5.9958930015563965, "max_q": -0.27483922243118286, "min_q": -15.551273345947266}, "center3": {"mean_q": -6.666982173919678, "max_q": 1.5843822956085205, "min_q": -27.34152603149414}, "center4": {"mean_q": -6.44005012512207, "max_q": -0.7456399202346802, "min_q": -17.877168655395508}, "center5": {"mean_q": -6.044454097747803, "max_q": -0.5732800960540771, "min_q": -14.654168128967285}, "center6": {"mean_q": -5.494809150695801, "max_q": 0.2394086867570877, "min_q": -16.102645874023438}, "center7": {"mean_q": -6.73996114730835, "max_q": 1.3924015760421753, "min_q": -30.365314483642578}, "center8": {"mean_q": -8.214190483093262, "max_q": -0.8970122337341309, "min_q": -20.70994758605957}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 29058, "episodes_total": 114, "training_iteration": 29, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_20-00-06", "timestamp": 1580324406, "time_this_iter_s": 1235.3358721733093, "time_total_s": 35250.46325969696, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 35250.46325969696, "timesteps_since_restore": 29058, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 24.40701956271576, "ram_util_percent": 61.73141542002302}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -985.97832311454, "episode_reward_min": -2312.31063839472, "episode_reward_mean": -1377.0950731709354, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -256.9234042660802, "center1": -256.9234042660802, "center2": -256.9234042660802, "center3": -256.9234042660802, "center4": -256.9234042660802, "center5": -256.9234042660802, "center6": -256.9234042660802, "center7": -256.9234042660802, "center8": -256.9234042660802}, "policy_reward_max": {"center0": -109.55314701272671, "center1": -109.55314701272671, "center2": -109.55314701272671, "center3": -109.55314701272671, "center4": -109.55314701272671, "center5": -109.55314701272671, "center6": -109.55314701272671, "center7": -109.55314701272671, "center8": -109.55314701272671}, "policy_reward_mean": {"center0": -153.01056368565966, "center1": -153.01056368565966, "center2": -153.01056368565966, "center3": -153.01056368565966, "center4": -153.01056368565966, "center5": -153.01056368565966, "center6": -153.01056368565966, "center7": -153.01056368565966, "center8": -153.01056368565966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 296.1593959835629, "mean_processing_ms": 8.385692404701668, "mean_inference_ms": 4.259013920418463}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 5010, "num_steps_trained": 23800000, "num_steps_sampled": 30060, "sample_time_ms": 335.409, "replay_time_ms": 3286.184, "grad_time_ms": 3599.913, "update_time_ms": 274.707, "opt_peak_throughput": 1388.923, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -6.670245170593262, "max_q": 0.17931632697582245, "min_q": -21.016109466552734}, "center1": {"mean_q": -6.481605529785156, "max_q": -0.5170643925666809, "min_q": -14.295893669128418}, "center2": {"mean_q": -6.473822593688965, "max_q": -0.6699525117874146, "min_q": -15.604103088378906}, "center3": {"mean_q": -6.77971076965332, "max_q": 0.2495674192905426, "min_q": -27.57228660583496}, "center4": {"mean_q": -6.70563268661499, "max_q": -0.553493320941925, "min_q": -23.71257781982422}, "center5": {"mean_q": -6.24379825592041, "max_q": -1.1548844575881958, "min_q": -14.815130233764648}, "center6": {"mean_q": -6.015097618103027, "max_q": -0.9513003826141357, "min_q": -16.17922592163086}, "center7": {"mean_q": -7.076028347015381, "max_q": 1.8516021966934204, "min_q": -33.37392044067383}, "center8": {"mean_q": -8.576251983642578, "max_q": 2.58864164352417, "min_q": -22.857934951782227}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 30060, "episodes_total": 120, "training_iteration": 30, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_20-20-49", "timestamp": 1580325649, "time_this_iter_s": 1242.657185792923, "time_total_s": 36493.12044548988, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 36493.12044548988, "timesteps_since_restore": 30060, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.047031963470317, "ram_util_percent": 74.92248858447489}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
{"episode_reward_max": -985.97832311454, "episode_reward_min": -2312.31063839472, "episode_reward_mean": -1377.0950731709363, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -256.9234042660802, "center1": -256.9234042660802, "center2": -256.9234042660802, "center3": -256.9234042660802, "center4": -256.9234042660802, "center5": -256.9234042660802, "center6": -256.9234042660802, "center7": -256.9234042660802, "center8": -256.9234042660802}, "policy_reward_max": {"center0": -109.55314701272671, "center1": -109.55314701272671, "center2": -109.55314701272671, "center3": -109.55314701272671, "center4": -109.55314701272671, "center5": -109.55314701272671, "center6": -109.55314701272671, "center7": -109.55314701272671, "center8": -109.55314701272671}, "policy_reward_mean": {"center0": -153.01056368565966, "center1": -153.01056368565966, "center2": -153.01056368565966, "center3": -153.01056368565966, "center4": -153.01056368565966, "center5": -153.01056368565966, "center6": -153.01056368565966, "center7": -153.01056368565966, "center8": -153.01056368565966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 296.15939598356283, "mean_processing_ms": 8.385692404701667, "mean_inference_ms": 4.259013920418463}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 5177, "num_steps_trained": 24635000, "num_steps_sampled": 31062, "sample_time_ms": 347.933, "replay_time_ms": 3268.831, "grad_time_ms": 3503.264, "update_time_ms": 117.08, "opt_peak_throughput": 1427.24, "opt_samples": 5000.0, "learner": {"center0": {"mean_q": -7.329779624938965, "max_q": -0.921975314617157, "min_q": -23.03912925720215}, "center1": {"mean_q": -6.257471561431885, "max_q": 0.20367789268493652, "min_q": -13.81969165802002}, "center2": {"mean_q": -6.702277183532715, "max_q": -0.4502086043357849, "min_q": -17.884552001953125}, "center3": {"mean_q": -7.166360855102539, "max_q": 0.4106820225715637, "min_q": -30.482940673828125}, "center4": {"mean_q": -6.687193870544434, "max_q": 0.6842350959777832, "min_q": -18.49574089050293}, "center5": {"mean_q": -6.359269618988037, "max_q": -0.2518409490585327, "min_q": -14.9718656539917}, "center6": {"mean_q": -6.080041408538818, "max_q": 0.9068498015403748, "min_q": -17.574365615844727}, "center7": {"mean_q": -7.33886194229126, "max_q": 2.82405161857605, "min_q": -32.995933532714844}, "center8": {"mean_q": -8.903434753417969, "max_q": -0.4004492163658142, "min_q": -26.50636863708496}}}, "timesteps_this_iter": 1002, "done": false, "timesteps_total": 31062, "episodes_total": 120, "training_iteration": 31, "experiment_id": "ea6edb8748ea48c2b71f304835e665cc", "date": "2020-01-29_20-41-33", "timestamp": 1580326893, "time_this_iter_s": 1244.20840716362, "time_total_s": 37737.3288526535, "pid": 14357, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multimultiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center1": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center2": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center3": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center4": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center5": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center6": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center7": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}], "center8": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15dcd2440>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": false, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "ou", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 1000, "buffer_size": 50000, "prioritized_replay": true, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.002, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 1e-06, "grad_norm_clipping": null, "learning_starts": 1500, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 37737.3288526535, "timesteps_since_restore": 31062, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 23.716162193032552, "ram_util_percent": 83.02861222158766}, "num_healthy_workers": 6, "trial_id": "6b31257a", "experiment_tag": "0"}
