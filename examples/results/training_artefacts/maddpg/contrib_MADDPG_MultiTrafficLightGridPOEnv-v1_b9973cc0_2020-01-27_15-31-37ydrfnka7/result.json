{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_target_updates": 1, "num_steps_trained": 0, "num_steps_sampled": 600, "sample_time_ms": 77277.143, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 3346.271, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 600, "episodes_total": 0, "training_iteration": 1, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-33-21", "timestamp": 1580135601, "time_this_iter_s": 82.58884286880493, "time_total_s": 82.58884286880493, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba284d0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 82.58884286880493, "timesteps_since_restore": 600, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 58.650000000000006, "ram_util_percent": 56.63305084745764}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "sampler_perf": {}, "off_policy_estimator": {}, "info": {"num_target_updates": 2, "num_steps_trained": 0, "num_steps_sampled": 1200, "sample_time_ms": 56077.31, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 1678.439, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 1200, "episodes_total": 0, "training_iteration": 2, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-33-56", "timestamp": 1580135636, "time_this_iter_s": 34.8998441696167, "time_total_s": 117.48868703842163, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f59e0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 117.48868703842163, "timesteps_since_restore": 1200, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 42.614, "ram_util_percent": 57.32199999999999}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10878481749637, "episode_reward_min": -292.3126674031251, "episode_reward_mean": -292.27772001130455, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.479185267014024, "center1": -32.479185267014024, "center2": -32.479185267014024, "center3": -32.479185267014024, "center4": -32.479185267014024, "center5": -32.479185267014024, "center6": -32.479185267014024, "center7": -32.479185267014024, "center8": -32.479185267014024}, "policy_reward_max": {"center0": -32.4565316463888, "center1": -32.4565316463888, "center2": -32.4565316463888, "center3": -32.4565316463888, "center4": -32.4565316463888, "center5": -32.4565316463888, "center6": -32.4565316463888, "center7": -32.4565316463888, "center8": -32.4565316463888}, "policy_reward_mean": {"center0": -32.47530222347848, "center1": -32.47530222347848, "center2": -32.47530222347848, "center3": -32.47530222347848, "center4": -32.47530222347848, "center5": -32.47530222347848, "center6": -32.47530222347848, "center7": -32.47530222347848, "center8": -32.47530222347848}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 339.2332583698851, "mean_processing_ms": 5.746492779796173, "mean_inference_ms": 4.277692020665504}, "off_policy_estimator": {}, "info": {"num_target_updates": 3, "num_steps_trained": 0, "num_steps_sampled": 1800, "sample_time_ms": 49476.83, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 1122.809, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 1800, "episodes_total": 6, "training_iteration": 3, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-34-32", "timestamp": 1580135672, "time_this_iter_s": 36.29934501647949, "time_total_s": 153.78803205490112, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 153.78803205490112, "timesteps_since_restore": 1800, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 45.80588235294117, "ram_util_percent": 57.67254901960785}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10878481749637, "episode_reward_min": -292.3126674031251, "episode_reward_mean": -292.27772001130455, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.479185267014024, "center1": -32.479185267014024, "center2": -32.479185267014024, "center3": -32.479185267014024, "center4": -32.479185267014024, "center5": -32.479185267014024, "center6": -32.479185267014024, "center7": -32.479185267014024, "center8": -32.479185267014024}, "policy_reward_max": {"center0": -32.4565316463888, "center1": -32.4565316463888, "center2": -32.4565316463888, "center3": -32.4565316463888, "center4": -32.4565316463888, "center5": -32.4565316463888, "center6": -32.4565316463888, "center7": -32.4565316463888, "center8": -32.4565316463888}, "policy_reward_mean": {"center0": -32.47530222347848, "center1": -32.47530222347848, "center2": -32.47530222347848, "center3": -32.47530222347848, "center4": -32.47530222347848, "center5": -32.47530222347848, "center6": -32.47530222347848, "center7": -32.47530222347848, "center8": -32.47530222347848}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 339.2332583698851, "mean_processing_ms": 5.746492779796173, "mean_inference_ms": 4.277692020665504}, "off_policy_estimator": {}, "info": {"num_target_updates": 4, "num_steps_trained": 0, "num_steps_sampled": 2400, "sample_time_ms": 45653.087, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 844.986, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 2400, "episodes_total": 6, "training_iteration": 4, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-35-07", "timestamp": 1580135707, "time_this_iter_s": 34.20500040054321, "time_total_s": 187.99303245544434, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 187.99303245544434, "timesteps_since_restore": 2400, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 44.406122448979595, "ram_util_percent": 57.58163265306121}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10878481749637, "episode_reward_min": -294.68672586901766, "episode_reward_mean": -293.45614322555133, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.74296954100186, "center1": -32.74296954100186, "center2": -32.74296954100186, "center3": -32.74296954100186, "center4": -32.74296954100186, "center5": -32.74296954100186, "center6": -32.74296954100186, "center7": -32.74296954100186, "center8": -32.74296954100186}, "policy_reward_max": {"center0": -32.4565316463888, "center1": -32.4565316463888, "center2": -32.4565316463888, "center3": -32.4565316463888, "center4": -32.4565316463888, "center5": -32.4565316463888, "center6": -32.4565316463888, "center7": -32.4565316463888, "center8": -32.4565316463888}, "policy_reward_mean": {"center0": -32.606238136172486, "center1": -32.606238136172486, "center2": -32.606238136172486, "center3": -32.606238136172486, "center4": -32.606238136172486, "center5": -32.606238136172486, "center6": -32.606238136172486, "center7": -32.606238136172486, "center8": -32.606238136172486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 336.63591470930197, "mean_processing_ms": 6.134378822133936, "mean_inference_ms": 3.8316866873923288}, "off_policy_estimator": {}, "info": {"num_target_updates": 5, "num_steps_trained": 0, "num_steps_sampled": 3000, "sample_time_ms": 43427.296, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 678.278, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 3000, "episodes_total": 12, "training_iteration": 5, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-35-41", "timestamp": 1580135741, "time_this_iter_s": 34.54783892631531, "time_total_s": 222.54087138175964, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 222.54087138175964, "timesteps_since_restore": 3000, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.11632653061225, "ram_util_percent": 57.68163265306123}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10878481749637, "episode_reward_min": -294.68672586901766, "episode_reward_mean": -293.45614322555133, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.74296954100186, "center1": -32.74296954100186, "center2": -32.74296954100186, "center3": -32.74296954100186, "center4": -32.74296954100186, "center5": -32.74296954100186, "center6": -32.74296954100186, "center7": -32.74296954100186, "center8": -32.74296954100186}, "policy_reward_max": {"center0": -32.4565316463888, "center1": -32.4565316463888, "center2": -32.4565316463888, "center3": -32.4565316463888, "center4": -32.4565316463888, "center5": -32.4565316463888, "center6": -32.4565316463888, "center7": -32.4565316463888, "center8": -32.4565316463888}, "policy_reward_mean": {"center0": -32.606238136172486, "center1": -32.606238136172486, "center2": -32.606238136172486, "center3": -32.606238136172486, "center4": -32.606238136172486, "center5": -32.606238136172486, "center6": -32.606238136172486, "center7": -32.606238136172486, "center8": -32.606238136172486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 336.63591470930197, "mean_processing_ms": 6.134378822133936, "mean_inference_ms": 3.831686687392328}, "off_policy_estimator": {}, "info": {"num_target_updates": 6, "num_steps_trained": 0, "num_steps_sampled": 3600, "sample_time_ms": 41866.484, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 567.014, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 3600, "episodes_total": 12, "training_iteration": 6, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-36-15", "timestamp": 1580135775, "time_this_iter_s": 34.08421182632446, "time_total_s": 256.6250832080841, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 256.6250832080841, "timesteps_since_restore": 3600, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 45.99387755102041, "ram_util_percent": 57.52857142857144}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10878481749637, "episode_reward_min": -294.68672586901766, "episode_reward_mean": -293.45614322555133, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.74296954100186, "center1": -32.74296954100186, "center2": -32.74296954100186, "center3": -32.74296954100186, "center4": -32.74296954100186, "center5": -32.74296954100186, "center6": -32.74296954100186, "center7": -32.74296954100186, "center8": -32.74296954100186}, "policy_reward_max": {"center0": -32.4565316463888, "center1": -32.4565316463888, "center2": -32.4565316463888, "center3": -32.4565316463888, "center4": -32.4565316463888, "center5": -32.4565316463888, "center6": -32.4565316463888, "center7": -32.4565316463888, "center8": -32.4565316463888}, "policy_reward_mean": {"center0": -32.606238136172486, "center1": -32.606238136172486, "center2": -32.606238136172486, "center3": -32.606238136172486, "center4": -32.606238136172486, "center5": -32.606238136172486, "center6": -32.606238136172486, "center7": -32.606238136172486, "center8": -32.606238136172486}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 336.63591470930197, "mean_processing_ms": 6.134378822133936, "mean_inference_ms": 3.831686687392328}, "off_policy_estimator": {}, "info": {"num_target_updates": 7, "num_steps_trained": 0, "num_steps_sampled": 4200, "sample_time_ms": 40751.423, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 487.659, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 4200, "episodes_total": 12, "training_iteration": 7, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-36-49", "timestamp": 1580135809, "time_this_iter_s": 34.08378601074219, "time_total_s": 290.7088692188263, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 290.7088692188263, "timesteps_since_restore": 4200, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 46.70208333333333, "ram_util_percent": 57.69999999999999}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -294.68672586901766, "episode_reward_mean": -293.05224299092487, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.74296954100186, "center1": -32.74296954100186, "center2": -32.74296954100186, "center3": -32.74296954100186, "center4": -32.74296954100186, "center5": -32.74296954100186, "center6": -32.74296954100186, "center7": -32.74296954100186, "center8": -32.74296954100186}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.56136033232513, "center1": -32.56136033232513, "center2": -32.56136033232513, "center3": -32.56136033232513, "center4": -32.56136033232513, "center5": -32.56136033232513, "center6": -32.56136033232513, "center7": -32.56136033232513, "center8": -32.56136033232513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 334.82640630294674, "mean_processing_ms": 6.17681030253816, "mean_inference_ms": 3.5221301294310625}, "off_policy_estimator": {}, "info": {"num_target_updates": 8, "num_steps_trained": 0, "num_steps_sampled": 4800, "sample_time_ms": 39973.492, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 428.122, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 4800, "episodes_total": 18, "training_iteration": 8, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-37-24", "timestamp": 1580135844, "time_this_iter_s": 34.55120611190796, "time_total_s": 325.26007533073425, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 325.26007533073425, "timesteps_since_restore": 4800, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.062000000000005, "ram_util_percent": 57.86200000000001}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -294.68672586901766, "episode_reward_mean": -293.0522429909249, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.74296954100186, "center1": -32.74296954100186, "center2": -32.74296954100186, "center3": -32.74296954100186, "center4": -32.74296954100186, "center5": -32.74296954100186, "center6": -32.74296954100186, "center7": -32.74296954100186, "center8": -32.74296954100186}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.56136033232513, "center1": -32.56136033232513, "center2": -32.56136033232513, "center3": -32.56136033232513, "center4": -32.56136033232513, "center5": -32.56136033232513, "center6": -32.56136033232513, "center7": -32.56136033232513, "center8": -32.56136033232513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 334.8264063029468, "mean_processing_ms": 6.17681030253816, "mean_inference_ms": 3.5221301294310625}, "off_policy_estimator": {}, "info": {"num_target_updates": 9, "num_steps_trained": 0, "num_steps_sampled": 5400, "sample_time_ms": 39409.614, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 381.828, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 5400, "episodes_total": 18, "training_iteration": 9, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-37-59", "timestamp": 1580135879, "time_this_iter_s": 34.92128801345825, "time_total_s": 360.1813633441925, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 360.1813633441925, "timesteps_since_restore": 5400, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 44.83877551020408, "ram_util_percent": 57.83061224489796}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.4705448202297, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60783831335898, "center1": -32.60783831335898, "center2": -32.60783831335898, "center3": -32.60783831335898, "center4": -32.60783831335898, "center5": -32.60783831335898, "center6": -32.60783831335898, "center7": -32.60783831335898, "center8": -32.60783831335898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 334.0117712929935, "mean_processing_ms": 6.283029000163391, "mean_inference_ms": 3.327774574268999}, "off_policy_estimator": {}, "info": {"num_target_updates": 10, "num_steps_trained": 0, "num_steps_sampled": 6000, "sample_time_ms": 38993.069, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 344.788, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 6000, "episodes_total": 24, "training_iteration": 10, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-38-34", "timestamp": 1580135914, "time_this_iter_s": 35.268378019332886, "time_total_s": 395.4497413635254, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 395.4497413635254, "timesteps_since_restore": 6000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 43.998039215686276, "ram_util_percent": 57.32745098039215}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.47054482022975, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60783831335898, "center1": -32.60783831335898, "center2": -32.60783831335898, "center3": -32.60783831335898, "center4": -32.60783831335898, "center5": -32.60783831335898, "center6": -32.60783831335898, "center7": -32.60783831335898, "center8": -32.60783831335898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 334.01177129299356, "mean_processing_ms": 6.283029000163391, "mean_inference_ms": 3.327774574268999}, "off_policy_estimator": {}, "info": {"num_target_updates": 11, "num_steps_trained": 0, "num_steps_sampled": 6600, "sample_time_ms": 34551.349, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.317, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 6600, "episodes_total": 24, "training_iteration": 11, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-39-07", "timestamp": 1580135947, "time_this_iter_s": 32.88146996498108, "time_total_s": 428.33121132850647, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 428.33121132850647, "timesteps_since_restore": 6600, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 42.7695652173913, "ram_util_percent": 57.43260869565218}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.47054482022975, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60783831335898, "center1": -32.60783831335898, "center2": -32.60783831335898, "center3": -32.60783831335898, "center4": -32.60783831335898, "center5": -32.60783831335898, "center6": -32.60783831335898, "center7": -32.60783831335898, "center8": -32.60783831335898}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 334.01177129299356, "mean_processing_ms": 6.283029000163391, "mean_inference_ms": 3.327774574268999}, "off_policy_estimator": {}, "info": {"num_target_updates": 12, "num_steps_trained": 0, "num_steps_sampled": 7200, "sample_time_ms": 34368.036, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.326, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 7200, "episodes_total": 24, "training_iteration": 12, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-39-40", "timestamp": 1580135980, "time_this_iter_s": 33.065943002700806, "time_total_s": 461.3971543312073, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 461.3971543312073, "timesteps_since_restore": 7200, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.89148936170213, "ram_util_percent": 57.55106382978724}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.2387305808744, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.58208117565285, "center1": -32.58208117565285, "center2": -32.58208117565285, "center3": -32.58208117565285, "center4": -32.58208117565285, "center5": -32.58208117565285, "center6": -32.58208117565285, "center7": -32.58208117565285, "center8": -32.58208117565285}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 332.9536066848031, "mean_processing_ms": 6.333330707088611, "mean_inference_ms": 3.1779819401366667}, "off_policy_estimator": {}, "info": {"num_target_updates": 13, "num_steps_trained": 0, "num_steps_sampled": 7800, "sample_time_ms": 34227.733, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.287, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 7800, "episodes_total": 30, "training_iteration": 13, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-40-15", "timestamp": 1580136015, "time_this_iter_s": 34.89702486991882, "time_total_s": 496.2941792011261, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba287a0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 496.2941792011261, "timesteps_since_restore": 7800, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.837999999999994, "ram_util_percent": 57.52799999999999}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.23873058087446, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.58208117565286, "center1": -32.58208117565286, "center2": -32.58208117565286, "center3": -32.58208117565286, "center4": -32.58208117565286, "center5": -32.58208117565286, "center6": -32.58208117565286, "center7": -32.58208117565286, "center8": -32.58208117565286}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 332.9536066848031, "mean_processing_ms": 6.333330707088612, "mean_inference_ms": 3.1779819401366662}, "off_policy_estimator": {}, "info": {"num_target_updates": 14, "num_steps_trained": 0, "num_steps_sampled": 8400, "sample_time_ms": 34235.143, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.319, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 8400, "episodes_total": 30, "training_iteration": 14, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-40-49", "timestamp": 1580136049, "time_this_iter_s": 34.27872610092163, "time_total_s": 530.5729053020477, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 530.5729053020477, "timesteps_since_restore": 8400, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.828571428571436, "ram_util_percent": 57.80408163265305}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.47674498597365, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60852722066389, "center1": -32.60852722066389, "center2": -32.60852722066389, "center3": -32.60852722066389, "center4": -32.60852722066389, "center5": -32.60852722066389, "center6": -32.60852722066389, "center7": -32.60852722066389, "center8": -32.60852722066389}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 332.0799153207626, "mean_processing_ms": 6.4005931198277, "mean_inference_ms": 3.065496398646706}, "off_policy_estimator": {}, "info": {"num_target_updates": 15, "num_steps_trained": 0, "num_steps_sampled": 9000, "sample_time_ms": 34140.347, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.336, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 9000, "episodes_total": 36, "training_iteration": 15, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-41-23", "timestamp": 1580136083, "time_this_iter_s": 33.60130000114441, "time_total_s": 564.1742053031921, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28680>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 564.1742053031921, "timesteps_since_restore": 9000, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 42.072916666666664, "ram_util_percent": 57.84583333333333}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.47674498597365, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60852722066389, "center1": -32.60852722066389, "center2": -32.60852722066389, "center3": -32.60852722066389, "center4": -32.60852722066389, "center5": -32.60852722066389, "center6": -32.60852722066389, "center7": -32.60852722066389, "center8": -32.60852722066389}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 332.07991532076255, "mean_processing_ms": 6.4005931198277, "mean_inference_ms": 3.065496398646705}, "off_policy_estimator": {}, "info": {"num_target_updates": 16, "num_steps_trained": 0, "num_steps_sampled": 9600, "sample_time_ms": 34040.259, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.534, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 9600, "episodes_total": 36, "training_iteration": 16, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-41-56", "timestamp": 1580136116, "time_this_iter_s": 33.08584809303284, "time_total_s": 597.260053396225, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 597.260053396225, "timesteps_since_restore": 9600, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 41.310638297872345, "ram_util_percent": 57.77659574468083}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90822209177253, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.47674498597365, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.434246899086084, "center1": -32.434246899086084, "center2": -32.434246899086084, "center3": -32.434246899086084, "center4": -32.434246899086084, "center5": -32.434246899086084, "center6": -32.434246899086084, "center7": -32.434246899086084, "center8": -32.434246899086084}, "policy_reward_mean": {"center0": -32.60852722066389, "center1": -32.60852722066389, "center2": -32.60852722066389, "center3": -32.60852722066389, "center4": -32.60852722066389, "center5": -32.60852722066389, "center6": -32.60852722066389, "center7": -32.60852722066389, "center8": -32.60852722066389}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 332.07991532076255, "mean_processing_ms": 6.4005931198277, "mean_inference_ms": 3.065496398646705}, "off_policy_estimator": {}, "info": {"num_target_updates": 17, "num_steps_trained": 0, "num_steps_sampled": 10200, "sample_time_ms": 33934.869, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.592, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 10200, "episodes_total": 36, "training_iteration": 17, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-42-29", "timestamp": 1580136149, "time_this_iter_s": 33.03109812736511, "time_total_s": 630.2911515235901, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 630.2911515235901, "timesteps_since_restore": 10200, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 42.85744680851064, "ram_util_percent": 57.94255319148937}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.2829274308807, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.586991936764676, "center1": -32.586991936764676, "center2": -32.586991936764676, "center3": -32.586991936764676, "center4": -32.586991936764676, "center5": -32.586991936764676, "center6": -32.586991936764676, "center7": -32.586991936764676, "center8": -32.586991936764676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 331.19476421637944, "mean_processing_ms": 6.420552781467184, "mean_inference_ms": 2.972717354434481}, "off_policy_estimator": {}, "info": {"num_target_updates": 18, "num_steps_trained": 0, "num_steps_sampled": 10800, "sample_time_ms": 33838.463, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.661, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 10800, "episodes_total": 42, "training_iteration": 18, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-43-03", "timestamp": 1580136183, "time_this_iter_s": 33.58823013305664, "time_total_s": 663.8793816566467, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28200>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 663.8793816566467, "timesteps_since_restore": 10800, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.90833333333333, "ram_util_percent": 57.791666666666664}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0281320896657, "episode_reward_mean": -293.2829274308807, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78090356551869, "center1": -32.78090356551869, "center2": -32.78090356551869, "center3": -32.78090356551869, "center4": -32.78090356551869, "center5": -32.78090356551869, "center6": -32.78090356551869, "center7": -32.78090356551869, "center8": -32.78090356551869}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.586991936764676, "center1": -32.586991936764676, "center2": -32.586991936764676, "center3": -32.586991936764676, "center4": -32.586991936764676, "center5": -32.586991936764676, "center6": -32.586991936764676, "center7": -32.586991936764676, "center8": -32.586991936764676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 331.19476421637944, "mean_processing_ms": 6.420552781467184, "mean_inference_ms": 2.9727173544344807}, "off_policy_estimator": {}, "info": {"num_target_updates": 19, "num_steps_trained": 0, "num_steps_sampled": 11400, "sample_time_ms": 33535.454, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.636, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 11400, "episodes_total": 42, "training_iteration": 19, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-43-35", "timestamp": 1580136215, "time_this_iter_s": 31.889993906021118, "time_total_s": 695.7693755626678, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f50e0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 695.7693755626678, "timesteps_since_restore": 11400, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 39.83777777777778, "ram_util_percent": 57.75555555555554}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4558712704148, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60620791893513, "center1": -32.60620791893513, "center2": -32.60620791893513, "center3": -32.60620791893513, "center4": -32.60620791893513, "center5": -32.60620791893513, "center6": -32.60620791893513, "center7": -32.60620791893513, "center8": -32.60620791893513}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 330.37003710673486, "mean_processing_ms": 6.455414803778548, "mean_inference_ms": 2.8973154523334146}, "off_policy_estimator": {}, "info": {"num_target_updates": 20, "num_steps_trained": 0, "num_steps_sampled": 12000, "sample_time_ms": 33440.595, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.483, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 12000, "episodes_total": 48, "training_iteration": 20, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-44-09", "timestamp": 1580136249, "time_this_iter_s": 34.318833112716675, "time_total_s": 730.0882086753845, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 730.0882086753845, "timesteps_since_restore": 12000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 41.761224489795914, "ram_util_percent": 57.81020408163266}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.45587127041483, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60620791893512, "center1": -32.60620791893512, "center2": -32.60620791893512, "center3": -32.60620791893512, "center4": -32.60620791893512, "center5": -32.60620791893512, "center6": -32.60620791893512, "center7": -32.60620791893512, "center8": -32.60620791893512}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 330.37003710673486, "mean_processing_ms": 6.455414803778548, "mean_inference_ms": 2.8973154523334146}, "off_policy_estimator": {}, "info": {"num_target_updates": 21, "num_steps_trained": 0, "num_steps_sampled": 12600, "sample_time_ms": 33512.966, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.685, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 12600, "episodes_total": 48, "training_iteration": 21, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-44-43", "timestamp": 1580136283, "time_this_iter_s": 33.60893797874451, "time_total_s": 763.697146654129, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 763.697146654129, "timesteps_since_restore": 12600, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 45.45624999999999, "ram_util_percent": 57.87500000000001}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.45587127041483, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60620791893512, "center1": -32.60620791893512, "center2": -32.60620791893512, "center3": -32.60620791893512, "center4": -32.60620791893512, "center5": -32.60620791893512, "center6": -32.60620791893512, "center7": -32.60620791893512, "center8": -32.60620791893512}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 330.37003710673486, "mean_processing_ms": 6.455414803778548, "mean_inference_ms": 2.8973154523334146}, "off_policy_estimator": {}, "info": {"num_target_updates": 22, "num_steps_trained": 0, "num_steps_sampled": 13200, "sample_time_ms": 33473.806, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.832, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 13200, "episodes_total": 48, "training_iteration": 22, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-45-15", "timestamp": 1580136315, "time_this_iter_s": 32.675867319107056, "time_total_s": 796.3730139732361, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28680>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 796.3730139732361, "timesteps_since_restore": 13200, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 39.457446808510646, "ram_util_percent": 57.702127659574494}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.32505001578835, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.59167222397664, "center1": -32.59167222397664, "center2": -32.59167222397664, "center3": -32.59167222397664, "center4": -32.59167222397664, "center5": -32.59167222397664, "center6": -32.59167222397664, "center7": -32.59167222397664, "center8": -32.59167222397664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 329.61227818684966, "mean_processing_ms": 6.464545731730239, "mean_inference_ms": 2.8335042125663015}, "off_policy_estimator": {}, "info": {"num_target_updates": 23, "num_steps_trained": 0, "num_steps_sampled": 13800, "sample_time_ms": 33326.076, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.928, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 13800, "episodes_total": 54, "training_iteration": 23, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-45-49", "timestamp": 1580136349, "time_this_iter_s": 33.419453144073486, "time_total_s": 829.7924671173096, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 829.7924671173096, "timesteps_since_restore": 13800, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 40.18936170212765, "ram_util_percent": 57.79361702127663}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.32505001578835, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.59167222397664, "center1": -32.59167222397664, "center2": -32.59167222397664, "center3": -32.59167222397664, "center4": -32.59167222397664, "center5": -32.59167222397664, "center6": -32.59167222397664, "center7": -32.59167222397664, "center8": -32.59167222397664}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 329.6122781868497, "mean_processing_ms": 6.464545731730242, "mean_inference_ms": 2.833504212566302}, "off_policy_estimator": {}, "info": {"num_target_updates": 24, "num_steps_trained": 0, "num_steps_sampled": 14400, "sample_time_ms": 33265.802, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.936, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 14400, "episodes_total": 54, "training_iteration": 24, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-46-22", "timestamp": 1580136382, "time_this_iter_s": 33.676653146743774, "time_total_s": 863.4691202640533, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 863.4691202640533, "timesteps_since_restore": 14400, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 45.64166666666666, "ram_util_percent": 57.9}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4591319229806, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60657021366466, "center1": -32.60657021366466, "center2": -32.60657021366466, "center3": -32.60657021366466, "center4": -32.60657021366466, "center5": -32.60657021366466, "center6": -32.60657021366466, "center7": -32.60657021366466, "center8": -32.60657021366466}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 328.98641609236614, "mean_processing_ms": 6.483368065181958, "mean_inference_ms": 2.779907208736951}, "off_policy_estimator": {}, "info": {"num_target_updates": 25, "num_steps_trained": 0, "num_steps_sampled": 15000, "sample_time_ms": 33327.133, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 12.053, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 15000, "episodes_total": 60, "training_iteration": 25, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-46-57", "timestamp": 1580136417, "time_this_iter_s": 34.21528601646423, "time_total_s": 897.6844062805176, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 897.6844062805176, "timesteps_since_restore": 15000, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 41.85918367346939, "ram_util_percent": 57.81020408163266}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4591319229806, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.606570213664654, "center1": -32.606570213664654, "center2": -32.606570213664654, "center3": -32.606570213664654, "center4": -32.606570213664654, "center5": -32.606570213664654, "center6": -32.606570213664654, "center7": -32.606570213664654, "center8": -32.606570213664654}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 328.9864160923662, "mean_processing_ms": 6.483368065181957, "mean_inference_ms": 2.779907208736951}, "off_policy_estimator": {}, "info": {"num_target_updates": 26, "num_steps_trained": 0, "num_steps_sampled": 15600, "sample_time_ms": 33294.188, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.919, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 15600, "episodes_total": 60, "training_iteration": 26, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-47-30", "timestamp": 1580136450, "time_this_iter_s": 32.75454115867615, "time_total_s": 930.4389474391937, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba287a0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 930.4389474391937, "timesteps_since_restore": 15600, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 42.457446808510646, "ram_util_percent": 57.844680851063856}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4591319229806, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.606570213664654, "center1": -32.606570213664654, "center2": -32.606570213664654, "center3": -32.606570213664654, "center4": -32.606570213664654, "center5": -32.606570213664654, "center6": -32.606570213664654, "center7": -32.606570213664654, "center8": -32.606570213664654}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 328.9864160923662, "mean_processing_ms": 6.483368065181957, "mean_inference_ms": 2.779907208736951}, "off_policy_estimator": {}, "info": {"num_target_updates": 27, "num_steps_trained": 0, "num_steps_sampled": 16200, "sample_time_ms": 33242.046, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.76, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 16200, "episodes_total": 60, "training_iteration": 27, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-48-02", "timestamp": 1580136482, "time_this_iter_s": 32.50737500190735, "time_total_s": 962.9463224411011, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 962.9463224411011, "timesteps_since_restore": 16200, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 39.400000000000006, "ram_util_percent": 57.80652173913045}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.3486637072442, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.594295967471744, "center1": -32.594295967471744, "center2": -32.594295967471744, "center3": -32.594295967471744, "center4": -32.594295967471744, "center5": -32.594295967471744, "center6": -32.594295967471744, "center7": -32.594295967471744, "center8": -32.594295967471744}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 328.414398760135, "mean_processing_ms": 6.489124770884631, "mean_inference_ms": 2.7330603977668817}, "off_policy_estimator": {}, "info": {"num_target_updates": 28, "num_steps_trained": 0, "num_steps_sampled": 16800, "sample_time_ms": 33347.477, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.683, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 16800, "episodes_total": 66, "training_iteration": 28, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-48-37", "timestamp": 1580136517, "time_this_iter_s": 34.64129710197449, "time_total_s": 997.5876195430756, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba284d0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 997.5876195430756, "timesteps_since_restore": 16800, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 46.24285714285715, "ram_util_percent": 57.88163265306121}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.3486637072442, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.594295967471744, "center1": -32.594295967471744, "center2": -32.594295967471744, "center3": -32.594295967471744, "center4": -32.594295967471744, "center5": -32.594295967471744, "center6": -32.594295967471744, "center7": -32.594295967471744, "center8": -32.594295967471744}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 328.41439876013493, "mean_processing_ms": 6.48912477088463, "mean_inference_ms": 2.7330603977668817}, "off_policy_estimator": {}, "info": {"num_target_updates": 29, "num_steps_trained": 0, "num_steps_sampled": 17400, "sample_time_ms": 33382.251, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.684, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 17400, "episodes_total": 66, "training_iteration": 29, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-49-09", "timestamp": 1580136549, "time_this_iter_s": 32.23891592025757, "time_total_s": 1029.8265354633331, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28290>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1029.8265354633331, "timesteps_since_restore": 17400, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 38.06521739130435, "ram_util_percent": 57.76739130434784}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4595212670435, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60661347411608, "center1": -32.60661347411608, "center2": -32.60661347411608, "center3": -32.60661347411608, "center4": -32.60661347411608, "center5": -32.60661347411608, "center6": -32.60661347411608, "center7": -32.60661347411608, "center8": -32.60661347411608}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 327.8774716073758, "mean_processing_ms": 6.500515167008626, "mean_inference_ms": 2.6923049008767292}, "off_policy_estimator": {}, "info": {"num_target_updates": 30, "num_steps_trained": 0, "num_steps_sampled": 18000, "sample_time_ms": 33321.325, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.884, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 18000, "episodes_total": 72, "training_iteration": 30, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-49-43", "timestamp": 1580136583, "time_this_iter_s": 33.710591077804565, "time_total_s": 1063.5371265411377, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1063.5371265411377, "timesteps_since_restore": 18000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 41.34583333333333, "ram_util_percent": 57.91041666666666}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4595212670435, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60661347411608, "center1": -32.60661347411608, "center2": -32.60661347411608, "center3": -32.60661347411608, "center4": -32.60661347411608, "center5": -32.60661347411608, "center6": -32.60661347411608, "center7": -32.60661347411608, "center8": -32.60661347411608}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 327.8774716073758, "mean_processing_ms": 6.5005151670086265, "mean_inference_ms": 2.6923049008767292}, "off_policy_estimator": {}, "info": {"num_target_updates": 31, "num_steps_trained": 0, "num_steps_sampled": 18600, "sample_time_ms": 33261.828, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.769, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 18600, "episodes_total": 72, "training_iteration": 31, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-50-16", "timestamp": 1580136616, "time_this_iter_s": 33.01255917549133, "time_total_s": 1096.549685716629, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5a70>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1096.549685716629, "timesteps_since_restore": 18600, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 43.81489361702127, "ram_util_percent": 57.96808510638297}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.4595212670435, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60661347411608, "center1": -32.60661347411608, "center2": -32.60661347411608, "center3": -32.60661347411608, "center4": -32.60661347411608, "center5": -32.60661347411608, "center6": -32.60661347411608, "center7": -32.60661347411608, "center8": -32.60661347411608}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 327.8774716073758, "mean_processing_ms": 6.5005151670086265, "mean_inference_ms": 2.6923049008767292}, "off_policy_estimator": {}, "info": {"num_target_updates": 32, "num_steps_trained": 0, "num_steps_sampled": 19200, "sample_time_ms": 33255.198, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.656, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 19200, "episodes_total": 72, "training_iteration": 32, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-50-48", "timestamp": 1580136648, "time_this_iter_s": 32.608253955841064, "time_total_s": 1129.15793967247, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1129.15793967247, "timesteps_since_restore": 19200, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 40.55744680851064, "ram_util_percent": 57.9276595744681}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.36605240989263, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.59622804554376, "center1": -32.59622804554376, "center2": -32.59622804554376, "center3": -32.59622804554376, "center4": -32.59622804554376, "center5": -32.59622804554376, "center6": -32.59622804554376, "center7": -32.59622804554376, "center8": -32.59622804554376}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 327.3624811344445, "mean_processing_ms": 6.502324081738505, "mean_inference_ms": 2.655982245162493}, "off_policy_estimator": {}, "info": {"num_target_updates": 33, "num_steps_trained": 0, "num_steps_sampled": 19800, "sample_time_ms": 33220.02, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.646, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 19800, "episodes_total": 78, "training_iteration": 33, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-51-21", "timestamp": 1580136681, "time_this_iter_s": 33.06699800491333, "time_total_s": 1162.2249376773834, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15b8f5c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1162.2249376773834, "timesteps_since_restore": 19800, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 37.93191489361702, "ram_util_percent": 57.34255319148937}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.3660524098927, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.596228045543775, "center1": -32.596228045543775, "center2": -32.596228045543775, "center3": -32.596228045543775, "center4": -32.596228045543775, "center5": -32.596228045543775, "center6": -32.596228045543775, "center7": -32.596228045543775, "center8": -32.596228045543775}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 327.3624811344445, "mean_processing_ms": 6.502324081738505, "mean_inference_ms": 2.6559822451624933}, "off_policy_estimator": {}, "info": {"num_target_updates": 34, "num_steps_trained": 0, "num_steps_sampled": 20400, "sample_time_ms": 33135.199, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.469, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 20400, "episodes_total": 78, "training_iteration": 34, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-51-54", "timestamp": 1580136714, "time_this_iter_s": 32.82673096656799, "time_total_s": 1195.0516686439514, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1195.0516686439514, "timesteps_since_restore": 20400, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 43.06956521739131, "ram_util_percent": 57.11086956521737}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.45792882336576, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60643653592966, "center1": -32.60643653592966, "center2": -32.60643653592966, "center3": -32.60643653592966, "center4": -32.60643653592966, "center5": -32.60643653592966, "center6": -32.60643653592966, "center7": -32.60643653592966, "center8": -32.60643653592966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.9133515245572, "mean_processing_ms": 6.509532646321676, "mean_inference_ms": 2.6239747333025787}, "off_policy_estimator": {}, "info": {"num_target_updates": 35, "num_steps_trained": 0, "num_steps_sampled": 21000, "sample_time_ms": 33184.388, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.294, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 21000, "episodes_total": 84, "training_iteration": 35, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-52-29", "timestamp": 1580136749, "time_this_iter_s": 34.70512008666992, "time_total_s": 1229.7567887306213, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1229.7567887306213, "timesteps_since_restore": 21000, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 45.017999999999994, "ram_util_percent": 57.268}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.45792882336565, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60643653592966, "center1": -32.60643653592966, "center2": -32.60643653592966, "center3": -32.60643653592966, "center4": -32.60643653592966, "center5": -32.60643653592966, "center6": -32.60643653592966, "center7": -32.60643653592966, "center8": -32.60643653592966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.91335152455713, "mean_processing_ms": 6.509532646321681, "mean_inference_ms": 2.6239747333025782}, "off_policy_estimator": {}, "info": {"num_target_updates": 36, "num_steps_trained": 0, "num_steps_sampled": 21600, "sample_time_ms": 33100.621, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.335, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 21600, "episodes_total": 84, "training_iteration": 36, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-53-01", "timestamp": 1580136781, "time_this_iter_s": 31.91673707962036, "time_total_s": 1261.6735258102417, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1261.6735258102417, "timesteps_since_restore": 21600, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.5, "ram_util_percent": 57.144444444444424}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.45792882336565, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60643653592966, "center1": -32.60643653592966, "center2": -32.60643653592966, "center3": -32.60643653592966, "center4": -32.60643653592966, "center5": -32.60643653592966, "center6": -32.60643653592966, "center7": -32.60643653592966, "center8": -32.60643653592966}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.91335152455713, "mean_processing_ms": 6.509532646321681, "mean_inference_ms": 2.6239747333025782}, "off_policy_estimator": {}, "info": {"num_target_updates": 37, "num_steps_trained": 0, "num_steps_sampled": 22200, "sample_time_ms": 33077.098, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.329, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 22200, "episodes_total": 84, "training_iteration": 37, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-53-33", "timestamp": 1580136813, "time_this_iter_s": 32.27274489402771, "time_total_s": 1293.9462707042694, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28320>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1293.9462707042694, "timesteps_since_restore": 22200, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 40.69130434782608, "ram_util_percent": 57.22608695652175}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.39716779520836, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.599685310578856, "center1": -32.599685310578856, "center2": -32.599685310578856, "center3": -32.599685310578856, "center4": -32.599685310578856, "center5": -32.599685310578856, "center6": -32.599685310578856, "center7": -32.599685310578856, "center8": -32.599685310578856}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.50162172141853, "mean_processing_ms": 6.51152942873925, "mean_inference_ms": 2.595196436799619}, "off_policy_estimator": {}, "info": {"num_target_updates": 38, "num_steps_trained": 0, "num_steps_sampled": 22800, "sample_time_ms": 33160.974, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.427, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 22800, "episodes_total": 90, "training_iteration": 38, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-54-09", "timestamp": 1580136849, "time_this_iter_s": 35.48183512687683, "time_total_s": 1329.4281058311462, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1329.4281058311462, "timesteps_since_restore": 22800, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.46078431372549, "ram_util_percent": 57.3705882352941}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.39716779520836, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.59968531057885, "center1": -32.59968531057885, "center2": -32.59968531057885, "center3": -32.59968531057885, "center4": -32.59968531057885, "center5": -32.59968531057885, "center6": -32.59968531057885, "center7": -32.59968531057885, "center8": -32.59968531057885}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.50162172141853, "mean_processing_ms": 6.51152942873925, "mean_inference_ms": 2.595196436799619}, "off_policy_estimator": {}, "info": {"num_target_updates": 39, "num_steps_trained": 0, "num_steps_sampled": 23400, "sample_time_ms": 33164.48, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.547, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 23400, "episodes_total": 90, "training_iteration": 39, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-54-41", "timestamp": 1580136881, "time_this_iter_s": 32.27409315109253, "time_total_s": 1361.7021989822388, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1361.7021989822388, "timesteps_since_restore": 23400, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 41.73695652173913, "ram_util_percent": 57.33478260869566}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.47475283337377, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.608305870375, "center1": -32.608305870375, "center2": -32.608305870375, "center3": -32.608305870375, "center4": -32.608305870375, "center5": -32.608305870375, "center6": -32.608305870375, "center7": -32.608305870375, "center8": -32.608305870375}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.10536842088715, "mean_processing_ms": 6.517884991055586, "mean_inference_ms": 2.5691427705005414}, "off_policy_estimator": {}, "info": {"num_target_updates": 40, "num_steps_trained": 0, "num_steps_sampled": 24000, "sample_time_ms": 33111.07, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.4, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 24000, "episodes_total": 96, "training_iteration": 40, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-55-14", "timestamp": 1580136914, "time_this_iter_s": 33.17551112174988, "time_total_s": 1394.8777101039886, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1394.8777101039886, "timesteps_since_restore": 24000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 39.67659574468085, "ram_util_percent": 57.2446808510638}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.47475283337377, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.608305870375, "center1": -32.608305870375, "center2": -32.608305870375, "center3": -32.608305870375, "center4": -32.608305870375, "center5": -32.608305870375, "center6": -32.608305870375, "center7": -32.608305870375, "center8": -32.608305870375}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.1053684208871, "mean_processing_ms": 6.517884991055586, "mean_inference_ms": 2.5691427705005414}, "off_policy_estimator": {}, "info": {"num_target_updates": 41, "num_steps_trained": 0, "num_steps_sampled": 24600, "sample_time_ms": 33022.188, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.398, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 24600, "episodes_total": 96, "training_iteration": 41, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-55-46", "timestamp": 1580136946, "time_this_iter_s": 32.12438607215881, "time_total_s": 1427.0020961761475, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1427.0020961761475, "timesteps_since_restore": 24600, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 42.10434782608696, "ram_util_percent": 57.293478260869584}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.47475283337377, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.608305870375, "center1": -32.608305870375, "center2": -32.608305870375, "center3": -32.608305870375, "center4": -32.608305870375, "center5": -32.608305870375, "center6": -32.608305870375, "center7": -32.608305870375, "center8": -32.608305870375}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 326.1053684208871, "mean_processing_ms": 6.517884991055586, "mean_inference_ms": 2.5691427705005414}, "off_policy_estimator": {}, "info": {"num_target_updates": 42, "num_steps_trained": 0, "num_steps_sampled": 25200, "sample_time_ms": 33016.681, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.398, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 25200, "episodes_total": 96, "training_iteration": 42, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-56-19", "timestamp": 1580136979, "time_this_iter_s": 32.55299687385559, "time_total_s": 1459.555093050003, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1459.555093050003, "timesteps_since_restore": 25200, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 43.52173913043479, "ram_util_percent": 57.445652173913054}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.42822726895906, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60313636321782, "center1": -32.60313636321782, "center2": -32.60313636321782, "center3": -32.60313636321782, "center4": -32.60313636321782, "center5": -32.60313636321782, "center6": -32.60313636321782, "center7": -32.60313636321782, "center8": -32.60313636321782}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 325.4845706241182, "mean_processing_ms": 6.533453959908518, "mean_inference_ms": 2.504932563328329}, "off_policy_estimator": {}, "info": {"num_target_updates": 43, "num_steps_trained": 0, "num_steps_sampled": 25800, "sample_time_ms": 32961.948, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 11.307, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 25800, "episodes_total": 102, "training_iteration": 43, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-56-51", "timestamp": 1580137011, "time_this_iter_s": 32.5467472076416, "time_total_s": 1492.1018402576447, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1492.1018402576447, "timesteps_since_restore": 25800, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 38.94893617021276, "ram_util_percent": 57.46170212765958}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.0303712559853, "episode_reward_mean": -293.42822726895906, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78115236177642, "center1": -32.78115236177642, "center2": -32.78115236177642, "center3": -32.78115236177642, "center4": -32.78115236177642, "center5": -32.78115236177642, "center6": -32.78115236177642, "center7": -32.78115236177642, "center8": -32.78115236177642}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.603136363217814, "center1": -32.603136363217814, "center2": -32.603136363217814, "center3": -32.603136363217814, "center4": -32.603136363217814, "center5": -32.603136363217814, "center6": -32.603136363217814, "center7": -32.603136363217814, "center8": -32.603136363217814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 325.4845706241182, "mean_processing_ms": 6.533453959908518, "mean_inference_ms": 2.504932563328329}, "off_policy_estimator": {}, "info": {"num_target_updates": 44, "num_steps_trained": 5000, "num_steps_sampled": 26400, "sample_time_ms": 32910.689, "replay_time_ms": 2719.501, "grad_time_ms": 2185.076, "update_time_ms": 11.623, "opt_peak_throughput": 2288.25, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 26400, "episodes_total": 102, "training_iteration": 44, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-57-29", "timestamp": 1580137049, "time_this_iter_s": 37.22628569602966, "time_total_s": 1529.3281259536743, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6e60>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1529.3281259536743, "timesteps_since_restore": 26400, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.90566037735849, "ram_util_percent": 57.588679245283025}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5320471155698, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61467190173011, "center1": -32.61467190173011, "center2": -32.61467190173011, "center3": -32.61467190173011, "center4": -32.61467190173011, "center5": -32.61467190173011, "center6": -32.61467190173011, "center7": -32.61467190173011, "center8": -32.61467190173011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 324.3806376911344, "mean_processing_ms": 6.570830067984539, "mean_inference_ms": 2.397781514895429}, "off_policy_estimator": {}, "info": {"num_target_updates": 45, "num_steps_trained": 10000, "num_steps_sampled": 27000, "sample_time_ms": 33022.265, "replay_time_ms": 2649.271, "grad_time_ms": 1156.159, "update_time_ms": 11.577, "opt_peak_throughput": 4324.663, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 27000, "episodes_total": 108, "training_iteration": 45, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-58-07", "timestamp": 1580137087, "time_this_iter_s": 38.53146409988403, "time_total_s": 1567.8595900535583, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1567.8595900535583, "timesteps_since_restore": 27000, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 46.7537037037037, "ram_util_percent": 57.833333333333336}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5320471155698, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61467190173011, "center1": -32.61467190173011, "center2": -32.61467190173011, "center3": -32.61467190173011, "center4": -32.61467190173011, "center5": -32.61467190173011, "center6": -32.61467190173011, "center7": -32.61467190173011, "center8": -32.61467190173011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 324.38063769113444, "mean_processing_ms": 6.57083006798454, "mean_inference_ms": 2.3977815148954296}, "off_policy_estimator": {}, "info": {"num_target_updates": 46, "num_steps_trained": 15000, "num_steps_sampled": 27600, "sample_time_ms": 33009.474, "replay_time_ms": 2566.89, "grad_time_ms": 813.982, "update_time_ms": 11.511, "opt_peak_throughput": 6142.642, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 27600, "episodes_total": 108, "training_iteration": 46, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-58-42", "timestamp": 1580137122, "time_this_iter_s": 34.325342893600464, "time_total_s": 1602.1849329471588, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6e60>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1602.1849329471588, "timesteps_since_restore": 27600, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.60204081632653, "ram_util_percent": 57.76326530612246}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5320471155698, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61467190173011, "center1": -32.61467190173011, "center2": -32.61467190173011, "center3": -32.61467190173011, "center4": -32.61467190173011, "center5": -32.61467190173011, "center6": -32.61467190173011, "center7": -32.61467190173011, "center8": -32.61467190173011}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 324.38063769113444, "mean_processing_ms": 6.57083006798454, "mean_inference_ms": 2.3977815148954296}, "off_policy_estimator": {}, "info": {"num_target_updates": 47, "num_steps_trained": 20000, "num_steps_sampled": 28200, "sample_time_ms": 33019.48, "replay_time_ms": 2581.037, "grad_time_ms": 642.964, "update_time_ms": 11.605, "opt_peak_throughput": 7776.488, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 28200, "episodes_total": 108, "training_iteration": 47, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-59-17", "timestamp": 1580137157, "time_this_iter_s": 35.13018488883972, "time_total_s": 1637.3151178359985, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c84db00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1637.3151178359985, "timesteps_since_restore": 28200, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 40.834, "ram_util_percent": 57.768}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4426043789297, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60473381988121, "center1": -32.60473381988121, "center2": -32.60473381988121, "center3": -32.60473381988121, "center4": -32.60473381988121, "center5": -32.60473381988121, "center6": -32.60473381988121, "center7": -32.60473381988121, "center8": -32.60473381988121}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 323.5229947917214, "mean_processing_ms": 6.577967059498395, "mean_inference_ms": 2.3343618526047463}, "off_policy_estimator": {}, "info": {"num_target_updates": 48, "num_steps_trained": 25000, "num_steps_sampled": 28800, "sample_time_ms": 32858.259, "replay_time_ms": 2563.051, "grad_time_ms": 540.018, "update_time_ms": 11.495, "opt_peak_throughput": 9258.953, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 28800, "episodes_total": 114, "training_iteration": 48, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_15-59-53", "timestamp": 1580137193, "time_this_iter_s": 36.49086594581604, "time_total_s": 1673.8059837818146, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6ef0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1673.8059837818146, "timesteps_since_restore": 28800, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 42.065384615384616, "ram_util_percent": 57.80384615384616}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4426043789296, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.604733819881204, "center1": -32.604733819881204, "center2": -32.604733819881204, "center3": -32.604733819881204, "center4": -32.604733819881204, "center5": -32.604733819881204, "center6": -32.604733819881204, "center7": -32.604733819881204, "center8": -32.604733819881204}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 323.5229947917214, "mean_processing_ms": 6.5779670594983966, "mean_inference_ms": 2.3343618526047463}, "off_policy_estimator": {}, "info": {"num_target_updates": 49, "num_steps_trained": 30000, "num_steps_sampled": 29400, "sample_time_ms": 32830.603, "replay_time_ms": 2532.561, "grad_time_ms": 471.509, "update_time_ms": 11.388, "opt_peak_throughput": 10604.247, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 29400, "episodes_total": 114, "training_iteration": 49, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-00-28", "timestamp": 1580137228, "time_this_iter_s": 34.51044011116028, "time_total_s": 1708.3164238929749, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28320>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1708.3164238929749, "timesteps_since_restore": 29400, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 37.732, "ram_util_percent": 57.80999999999999}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5362202492626, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61513558325154, "center1": -32.61513558325154, "center2": -32.61513558325154, "center3": -32.61513558325154, "center4": -32.61513558325154, "center5": -32.61513558325154, "center6": -32.61513558325154, "center7": -32.61513558325154, "center8": -32.61513558325154}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 322.7606866595091, "mean_processing_ms": 6.592205341463295, "mean_inference_ms": 2.2919525306213187}, "off_policy_estimator": {}, "info": {"num_target_updates": 50, "num_steps_trained": 35000, "num_steps_sampled": 30000, "sample_time_ms": 32881.879, "replay_time_ms": 2552.711, "grad_time_ms": 423.499, "update_time_ms": 11.452, "opt_peak_throughput": 11806.395, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 30000, "episodes_total": 120, "training_iteration": 50, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-01-04", "timestamp": 1580137264, "time_this_iter_s": 36.50138187408447, "time_total_s": 1744.8178057670593, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6ef0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1744.8178057670593, "timesteps_since_restore": 30000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 40.06346153846154, "ram_util_percent": 57.89807692307692}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.53622024926267, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61513558325155, "center1": -32.61513558325155, "center2": -32.61513558325155, "center3": -32.61513558325155, "center4": -32.61513558325155, "center5": -32.61513558325155, "center6": -32.61513558325155, "center7": -32.61513558325155, "center8": -32.61513558325155}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 322.7606866595091, "mean_processing_ms": 6.592205341463295, "mean_inference_ms": 2.2919525306213187}, "off_policy_estimator": {}, "info": {"num_target_updates": 51, "num_steps_trained": 40000, "num_steps_sampled": 30600, "sample_time_ms": 32934.426, "replay_time_ms": 2558.765, "grad_time_ms": 388.371, "update_time_ms": 11.402, "opt_peak_throughput": 12874.283, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 30600, "episodes_total": 120, "training_iteration": 51, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-01-40", "timestamp": 1580137300, "time_this_iter_s": 35.395999908447266, "time_total_s": 1780.2138056755066, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28320>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1780.2138056755066, "timesteps_since_restore": 30600, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 40.212, "ram_util_percent": 57.87}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.53622024926267, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61513558325155, "center1": -32.61513558325155, "center2": -32.61513558325155, "center3": -32.61513558325155, "center4": -32.61513558325155, "center5": -32.61513558325155, "center6": -32.61513558325155, "center7": -32.61513558325155, "center8": -32.61513558325155}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 322.7606866595091, "mean_processing_ms": 6.592205341463295, "mean_inference_ms": 2.2919525306213187}, "off_policy_estimator": {}, "info": {"num_target_updates": 52, "num_steps_trained": 45000, "num_steps_sampled": 31200, "sample_time_ms": 32867.614, "replay_time_ms": 2542.191, "grad_time_ms": 359.831, "update_time_ms": 11.349, "opt_peak_throughput": 13895.428, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 31200, "episodes_total": 120, "training_iteration": 52, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-02-14", "timestamp": 1580137334, "time_this_iter_s": 34.429970026016235, "time_total_s": 1814.6437757015228, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1814.6437757015228, "timesteps_since_restore": 31200, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 37.512244897959185, "ram_util_percent": 57.78571428571429}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.43844188902733, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60427132100319, "center1": -32.60427132100319, "center2": -32.60427132100319, "center3": -32.60427132100319, "center4": -32.60427132100319, "center5": -32.60427132100319, "center6": -32.60427132100319, "center7": -32.60427132100319, "center8": -32.60427132100319}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 322.0244027644305, "mean_processing_ms": 6.5909800709135915, "mean_inference_ms": 2.2587533609730417}, "off_policy_estimator": {}, "info": {"num_target_updates": 53, "num_steps_trained": 50000, "num_steps_sampled": 31800, "sample_time_ms": 33002.255, "replay_time_ms": 2552.191, "grad_time_ms": 336.863, "update_time_ms": 11.292, "opt_peak_throughput": 14842.82, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 31800, "episodes_total": 126, "training_iteration": 53, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-02-51", "timestamp": 1580137371, "time_this_iter_s": 36.641555070877075, "time_total_s": 1851.2853307724, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28710>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1851.2853307724, "timesteps_since_restore": 31800, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 37.92884615384615, "ram_util_percent": 57.81730769230771}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.43844188902733, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60427132100318, "center1": -32.60427132100318, "center2": -32.60427132100318, "center3": -32.60427132100318, "center4": -32.60427132100318, "center5": -32.60427132100318, "center6": -32.60427132100318, "center7": -32.60427132100318, "center8": -32.60427132100318}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 322.0244027644305, "mean_processing_ms": 6.590980070913588, "mean_inference_ms": 2.258753360973042}, "off_policy_estimator": {}, "info": {"num_target_updates": 54, "num_steps_trained": 55000, "num_steps_sampled": 32400, "sample_time_ms": 33035.576, "replay_time_ms": 2540.081, "grad_time_ms": 132.535, "update_time_ms": 11.099, "opt_peak_throughput": 37725.876, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 32400, "episodes_total": 126, "training_iteration": 54, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-03-26", "timestamp": 1580137406, "time_this_iter_s": 35.394184827804565, "time_total_s": 1886.6795156002045, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28d40>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1886.6795156002045, "timesteps_since_restore": 32400, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 42.20400000000001, "ram_util_percent": 57.902}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5337725178668, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.614863613096446, "center1": -32.614863613096446, "center2": -32.614863613096446, "center3": -32.614863613096446, "center4": -32.614863613096446, "center5": -32.614863613096446, "center6": -32.614863613096446, "center7": -32.614863613096446, "center8": -32.614863613096446}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 321.40284088294504, "mean_processing_ms": 6.590231500361377, "mean_inference_ms": 2.2329809276368993}, "off_policy_estimator": {}, "info": {"num_target_updates": 55, "num_steps_trained": 60000, "num_steps_sampled": 33000, "sample_time_ms": 32760.595, "replay_time_ms": 2539.921, "grad_time_ms": 132.813, "update_time_ms": 11.12, "opt_peak_throughput": 37646.829, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 33000, "episodes_total": 132, "training_iteration": 55, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-04-02", "timestamp": 1580137442, "time_this_iter_s": 35.7821581363678, "time_total_s": 1922.4616737365723, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1922.4616737365723, "timesteps_since_restore": 33000, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 38.325490196078434, "ram_util_percent": 57.768627450980404}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.53377251786674, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61486361309645, "center1": -32.61486361309645, "center2": -32.61486361309645, "center3": -32.61486361309645, "center4": -32.61486361309645, "center5": -32.61486361309645, "center6": -32.61486361309645, "center7": -32.61486361309645, "center8": -32.61486361309645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 321.40284088294504, "mean_processing_ms": 6.59023150036138, "mean_inference_ms": 2.2329809276368993}, "off_policy_estimator": {}, "info": {"num_target_updates": 56, "num_steps_trained": 65000, "num_steps_sampled": 33600, "sample_time_ms": 32817.531, "replay_time_ms": 2561.697, "grad_time_ms": 134.406, "update_time_ms": 11.158, "opt_peak_throughput": 37200.616, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 33600, "episodes_total": 132, "training_iteration": 56, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-04-37", "timestamp": 1580137477, "time_this_iter_s": 35.12770104408264, "time_total_s": 1957.589374780655, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28320>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1957.589374780655, "timesteps_since_restore": 33600, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 39.006, "ram_util_percent": 57.78200000000001}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.53377251786674, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.61486361309645, "center1": -32.61486361309645, "center2": -32.61486361309645, "center3": -32.61486361309645, "center4": -32.61486361309645, "center5": -32.61486361309645, "center6": -32.61486361309645, "center7": -32.61486361309645, "center8": -32.61486361309645}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 321.40284088294504, "mean_processing_ms": 6.59023150036138, "mean_inference_ms": 2.2329809276368993}, "off_policy_estimator": {}, "info": {"num_target_updates": 57, "num_steps_trained": 70000, "num_steps_sampled": 34200, "sample_time_ms": 32835.655, "replay_time_ms": 2564.804, "grad_time_ms": 136.784, "update_time_ms": 11.129, "opt_peak_throughput": 36553.86, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 34200, "episodes_total": 132, "training_iteration": 57, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-05-13", "timestamp": 1580137513, "time_this_iter_s": 35.366337060928345, "time_total_s": 1992.9557118415833, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 1992.9557118415833, "timesteps_since_restore": 34200, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 42.33, "ram_util_percent": 57.827999999999996}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4417460056958, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.60463844507746, "center1": -32.60463844507746, "center2": -32.60463844507746, "center3": -32.60463844507746, "center4": -32.60463844507746, "center5": -32.60463844507746, "center6": -32.60463844507746, "center7": -32.60463844507746, "center8": -32.60463844507746}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 320.8364338689329, "mean_processing_ms": 6.582674906119702, "mean_inference_ms": 2.2115638597259832}, "off_policy_estimator": {}, "info": {"num_target_updates": 58, "num_steps_trained": 75000, "num_steps_sampled": 34800, "sample_time_ms": 32732.96, "replay_time_ms": 2582.429, "grad_time_ms": 136.926, "update_time_ms": 11.13, "opt_peak_throughput": 36516.117, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 34800, "episodes_total": 138, "training_iteration": 58, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-05-48", "timestamp": 1580137548, "time_this_iter_s": 35.64188861846924, "time_total_s": 2028.5976004600525, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2028.5976004600525, "timesteps_since_restore": 34800, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.86078431372549, "ram_util_percent": 57.71372549019609}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.7103812510825, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.44174600569573, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.412264583453855, "center1": -32.412264583453855, "center2": -32.412264583453855, "center3": -32.412264583453855, "center4": -32.412264583453855, "center5": -32.412264583453855, "center6": -32.412264583453855, "center7": -32.412264583453855, "center8": -32.412264583453855}, "policy_reward_mean": {"center0": -32.604638445077455, "center1": -32.604638445077455, "center2": -32.604638445077455, "center3": -32.604638445077455, "center4": -32.604638445077455, "center5": -32.604638445077455, "center6": -32.604638445077455, "center7": -32.604638445077455, "center8": -32.604638445077455}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 320.8364338689328, "mean_processing_ms": 6.582674906119701, "mean_inference_ms": 2.2115638597259832}, "off_policy_estimator": {}, "info": {"num_target_updates": 59, "num_steps_trained": 80000, "num_steps_sampled": 35400, "sample_time_ms": 32762.942, "replay_time_ms": 2599.09, "grad_time_ms": 137.637, "update_time_ms": 11.088, "opt_peak_throughput": 36327.405, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 35400, "episodes_total": 138, "training_iteration": 59, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-06-23", "timestamp": 1580137583, "time_this_iter_s": 34.98375988006592, "time_total_s": 2063.5813603401184, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2063.5813603401184, "timesteps_since_restore": 35400, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 40.91836734693877, "ram_util_percent": 57.74897959183673}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54854839625096, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.61650537736135, "center1": -32.61650537736135, "center2": -32.61650537736135, "center3": -32.61650537736135, "center4": -32.61650537736135, "center5": -32.61650537736135, "center6": -32.61650537736135, "center7": -32.61650537736135, "center8": -32.61650537736135}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 320.36570398926773, "mean_processing_ms": 6.582450333490033, "mean_inference_ms": 2.1942014155167406}, "off_policy_estimator": {}, "info": {"num_target_updates": 60, "num_steps_trained": 85000, "num_steps_sampled": 36000, "sample_time_ms": 32829.127, "replay_time_ms": 2612.815, "grad_time_ms": 139.722, "update_time_ms": 11.056, "opt_peak_throughput": 35785.305, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 36000, "episodes_total": 144, "training_iteration": 60, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-07-01", "timestamp": 1580137621, "time_this_iter_s": 37.32061505317688, "time_total_s": 2100.9019753932953, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2100.9019753932953, "timesteps_since_restore": 36000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 43.296226415094345, "ram_util_percent": 57.890566037735844}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54854839625096, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.61650537736136, "center1": -32.61650537736136, "center2": -32.61650537736136, "center3": -32.61650537736136, "center4": -32.61650537736136, "center5": -32.61650537736136, "center6": -32.61650537736136, "center7": -32.61650537736136, "center8": -32.61650537736136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 320.3657039892677, "mean_processing_ms": 6.582450333490033, "mean_inference_ms": 2.194201415516741}, "off_policy_estimator": {}, "info": {"num_target_updates": 61, "num_steps_trained": 90000, "num_steps_sampled": 36600, "sample_time_ms": 32725.092, "replay_time_ms": 2591.98, "grad_time_ms": 138.105, "update_time_ms": 10.967, "opt_peak_throughput": 36204.297, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 36600, "episodes_total": 144, "training_iteration": 61, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-07-35", "timestamp": 1580137655, "time_this_iter_s": 34.12966513633728, "time_total_s": 2135.0316405296326, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28320>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2135.0316405296326, "timesteps_since_restore": 36600, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 38.0265306122449, "ram_util_percent": 57.73673469387756}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54854839625096, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.61650537736136, "center1": -32.61650537736136, "center2": -32.61650537736136, "center3": -32.61650537736136, "center4": -32.61650537736136, "center5": -32.61650537736136, "center6": -32.61650537736136, "center7": -32.61650537736136, "center8": -32.61650537736136}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 320.3657039892677, "mean_processing_ms": 6.582450333490033, "mean_inference_ms": 2.194201415516741}, "off_policy_estimator": {}, "info": {"num_target_updates": 62, "num_steps_trained": 95000, "num_steps_sampled": 37200, "sample_time_ms": 32688.295, "replay_time_ms": 2595.661, "grad_time_ms": 139.367, "update_time_ms": 11.016, "opt_peak_throughput": 35876.411, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 37200, "episodes_total": 144, "training_iteration": 62, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-08-09", "timestamp": 1580137689, "time_this_iter_s": 34.112131118774414, "time_total_s": 2169.143771648407, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6dd0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2169.143771648407, "timesteps_since_restore": 37200, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 36.9375, "ram_util_percent": 57.802083333333336}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.45271649819296, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.60585738868824, "center1": -32.60585738868824, "center2": -32.60585738868824, "center3": -32.60585738868824, "center4": -32.60585738868824, "center5": -32.60585738868824, "center6": -32.60585738868824, "center7": -32.60585738868824, "center8": -32.60585738868824}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.94328613673844, "mean_processing_ms": 6.577008673037613, "mean_inference_ms": 2.179273459637579}, "off_policy_estimator": {}, "info": {"num_target_updates": 63, "num_steps_trained": 100000, "num_steps_sampled": 37800, "sample_time_ms": 32698.455, "replay_time_ms": 2596.159, "grad_time_ms": 140.564, "update_time_ms": 11.055, "opt_peak_throughput": 35571.012, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 37800, "episodes_total": 150, "training_iteration": 63, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-08-46", "timestamp": 1580137726, "time_this_iter_s": 36.768194913864136, "time_total_s": 2205.911966562271, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2205.911966562271, "timesteps_since_restore": 37800, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 42.73269230769232, "ram_util_percent": 57.92115384615385}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.45271649819296, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.60585738868825, "center1": -32.60585738868825, "center2": -32.60585738868825, "center3": -32.60585738868825, "center4": -32.60585738868825, "center5": -32.60585738868825, "center6": -32.60585738868825, "center7": -32.60585738868825, "center8": -32.60585738868825}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.94328613673844, "mean_processing_ms": 6.5770086730376125, "mean_inference_ms": 2.1792734596375785}, "off_policy_estimator": {}, "info": {"num_target_updates": 64, "num_steps_trained": 105000, "num_steps_sampled": 38400, "sample_time_ms": 32670.752, "replay_time_ms": 2583.731, "grad_time_ms": 138.962, "update_time_ms": 11.169, "opt_peak_throughput": 35981.033, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 38400, "episodes_total": 150, "training_iteration": 64, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-09-21", "timestamp": 1580137761, "time_this_iter_s": 34.97544026374817, "time_total_s": 2240.8874068260193, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28440>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2240.8874068260193, "timesteps_since_restore": 38400, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 38.56, "ram_util_percent": 57.492}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54867776430774, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.616519751589884, "center1": -32.616519751589884, "center2": -32.616519751589884, "center3": -32.616519751589884, "center4": -32.616519751589884, "center5": -32.616519751589884, "center6": -32.616519751589884, "center7": -32.616519751589884, "center8": -32.616519751589884}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.5613074177087, "mean_processing_ms": 6.577481185518923, "mean_inference_ms": 2.166403161565206}, "off_policy_estimator": {}, "info": {"num_target_updates": 65, "num_steps_trained": 110000, "num_steps_sampled": 39000, "sample_time_ms": 32774.887, "replay_time_ms": 2575.167, "grad_time_ms": 139.866, "update_time_ms": 11.254, "opt_peak_throughput": 35748.4, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 39000, "episodes_total": 156, "training_iteration": 65, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-09-57", "timestamp": 1580137797, "time_this_iter_s": 36.74764585494995, "time_total_s": 2277.6350526809692, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2277.6350526809692, "timesteps_since_restore": 39000, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 39.869230769230775, "ram_util_percent": 57.56153846153847}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54867776430774, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.61651975158988, "center1": -32.61651975158988, "center2": -32.61651975158988, "center3": -32.61651975158988, "center4": -32.61651975158988, "center5": -32.61651975158988, "center6": -32.61651975158988, "center7": -32.61651975158988, "center8": -32.61651975158988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.56130741770875, "mean_processing_ms": 6.577481185518923, "mean_inference_ms": 2.1664031615652064}, "off_policy_estimator": {}, "info": {"num_target_updates": 66, "num_steps_trained": 115000, "num_steps_sampled": 39600, "sample_time_ms": 32859.326, "replay_time_ms": 2595.992, "grad_time_ms": 139.39, "update_time_ms": 11.212, "opt_peak_throughput": 35870.679, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 39600, "episodes_total": 156, "training_iteration": 66, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-10-34", "timestamp": 1580137834, "time_this_iter_s": 36.17511200904846, "time_total_s": 2313.8101646900177, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2313.8101646900177, "timesteps_since_restore": 39600, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 41.00961538461539, "ram_util_percent": 57.57115384615384}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.54867776430774, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.61651975158988, "center1": -32.61651975158988, "center2": -32.61651975158988, "center3": -32.61651975158988, "center4": -32.61651975158988, "center5": -32.61651975158988, "center6": -32.61651975158988, "center7": -32.61651975158988, "center8": -32.61651975158988}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.56130741770875, "mean_processing_ms": 6.577481185518923, "mean_inference_ms": 2.1664031615652064}, "off_policy_estimator": {}, "info": {"num_target_updates": 67, "num_steps_trained": 120000, "num_steps_sampled": 40200, "sample_time_ms": 32803.075, "replay_time_ms": 2615.493, "grad_time_ms": 138.452, "update_time_ms": 11.21, "opt_peak_throughput": 36113.666, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 40200, "episodes_total": 156, "training_iteration": 67, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-11-09", "timestamp": 1580137869, "time_this_iter_s": 34.99001407623291, "time_total_s": 2348.8001787662506, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28170>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2348.8001787662506, "timesteps_since_restore": 40200, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 39.098, "ram_util_percent": 57.62999999999999}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4538794431774, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.60598660479762, "center1": -32.60598660479762, "center2": -32.60598660479762, "center3": -32.60598660479762, "center4": -32.60598660479762, "center5": -32.60598660479762, "center6": -32.60598660479762, "center7": -32.60598660479762, "center8": -32.60598660479762}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.20604195030586, "mean_processing_ms": 6.57251605400316, "mean_inference_ms": 2.155057261429993}, "off_policy_estimator": {}, "info": {"num_target_updates": 68, "num_steps_trained": 125000, "num_steps_sampled": 40800, "sample_time_ms": 33057.806, "replay_time_ms": 2669.505, "grad_time_ms": 141.893, "update_time_ms": 11.183, "opt_peak_throughput": 35237.807, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 40800, "episodes_total": 162, "training_iteration": 68, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-11-47", "timestamp": 1580137907, "time_this_iter_s": 38.767114877700806, "time_total_s": 2387.5672936439514, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba47440>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2387.5672936439514, "timesteps_since_restore": 40800, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.34181818181818, "ram_util_percent": 57.163636363636364}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.90906783043437, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4538794431774, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.43434087004841, "center1": -32.43434087004841, "center2": -32.43434087004841, "center3": -32.43434087004841, "center4": -32.43434087004841, "center5": -32.43434087004841, "center6": -32.43434087004841, "center7": -32.43434087004841, "center8": -32.43434087004841}, "policy_reward_mean": {"center0": -32.60598660479762, "center1": -32.60598660479762, "center2": -32.60598660479762, "center3": -32.60598660479762, "center4": -32.60598660479762, "center5": -32.60598660479762, "center6": -32.60598660479762, "center7": -32.60598660479762, "center8": -32.60598660479762}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 319.2060419503058, "mean_processing_ms": 6.57251605400316, "mean_inference_ms": 2.1550572614299934}, "off_policy_estimator": {}, "info": {"num_target_updates": 69, "num_steps_trained": 130000, "num_steps_sampled": 41400, "sample_time_ms": 33408.118, "replay_time_ms": 2680.466, "grad_time_ms": 141.807, "update_time_ms": 11.722, "opt_peak_throughput": 35259.159, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 41400, "episodes_total": 162, "training_iteration": 69, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-12-26", "timestamp": 1580137946, "time_this_iter_s": 38.60116505622864, "time_total_s": 2426.16845870018, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2426.16845870018, "timesteps_since_restore": 41400, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 48.234545454545454, "ram_util_percent": 57.18363636363638}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1090423478087, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5527749419632, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45656026086789, "center1": -32.45656026086789, "center2": -32.45656026086789, "center3": -32.45656026086789, "center4": -32.45656026086789, "center5": -32.45656026086789, "center6": -32.45656026086789, "center7": -32.45656026086789, "center8": -32.45656026086789}, "policy_reward_mean": {"center0": -32.616974993551594, "center1": -32.616974993551594, "center2": -32.616974993551594, "center3": -32.616974993551594, "center4": -32.616974993551594, "center5": -32.616974993551594, "center6": -32.616974993551594, "center7": -32.616974993551594, "center8": -32.616974993551594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.9287562129164, "mean_processing_ms": 6.573026961989981, "mean_inference_ms": 2.145560552546282}, "off_policy_estimator": {}, "info": {"num_target_updates": 70, "num_steps_trained": 135000, "num_steps_sampled": 42000, "sample_time_ms": 33523.395, "replay_time_ms": 2662.828, "grad_time_ms": 139.863, "update_time_ms": 11.793, "opt_peak_throughput": 35749.162, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 42000, "episodes_total": 168, "training_iteration": 70, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-13-04", "timestamp": 1580137984, "time_this_iter_s": 38.27872323989868, "time_total_s": 2464.4471819400787, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba47440>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2464.4471819400787, "timesteps_since_restore": 42000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 42.199999999999996, "ram_util_percent": 57.1648148148148}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1090423478087, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5527749419632, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45656026086789, "center1": -32.45656026086789, "center2": -32.45656026086789, "center3": -32.45656026086789, "center4": -32.45656026086789, "center5": -32.45656026086789, "center6": -32.45656026086789, "center7": -32.45656026086789, "center8": -32.45656026086789}, "policy_reward_mean": {"center0": -32.616974993551594, "center1": -32.616974993551594, "center2": -32.616974993551594, "center3": -32.616974993551594, "center4": -32.616974993551594, "center5": -32.616974993551594, "center6": -32.616974993551594, "center7": -32.616974993551594, "center8": -32.616974993551594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.9287562129164, "mean_processing_ms": 6.57302696198998, "mean_inference_ms": 2.145560552546282}, "off_policy_estimator": {}, "info": {"num_target_updates": 71, "num_steps_trained": 140000, "num_steps_sampled": 42600, "sample_time_ms": 33901.611, "replay_time_ms": 2728.341, "grad_time_ms": 142.423, "update_time_ms": 11.794, "opt_peak_throughput": 35106.657, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 42600, "episodes_total": 168, "training_iteration": 71, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-13-43", "timestamp": 1580138023, "time_this_iter_s": 38.59283709526062, "time_total_s": 2503.0400190353394, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6dd0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2503.0400190353394, "timesteps_since_restore": 42600, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 44.3909090909091, "ram_util_percent": 57.412727272727295}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1090423478087, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5527749419632, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45656026086789, "center1": -32.45656026086789, "center2": -32.45656026086789, "center3": -32.45656026086789, "center4": -32.45656026086789, "center5": -32.45656026086789, "center6": -32.45656026086789, "center7": -32.45656026086789, "center8": -32.45656026086789}, "policy_reward_mean": {"center0": -32.616974993551594, "center1": -32.616974993551594, "center2": -32.616974993551594, "center3": -32.616974993551594, "center4": -32.616974993551594, "center5": -32.616974993551594, "center6": -32.616974993551594, "center7": -32.616974993551594, "center8": -32.616974993551594}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.9287562129164, "mean_processing_ms": 6.57302696198998, "mean_inference_ms": 2.145560552546282}, "off_policy_estimator": {}, "info": {"num_target_updates": 72, "num_steps_trained": 145000, "num_steps_sampled": 43200, "sample_time_ms": 34120.201, "replay_time_ms": 2747.335, "grad_time_ms": 142.947, "update_time_ms": 11.916, "opt_peak_throughput": 34977.898, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 43200, "episodes_total": 168, "training_iteration": 72, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-14-19", "timestamp": 1580138059, "time_this_iter_s": 36.49412393569946, "time_total_s": 2539.534142971039, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28710>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2539.534142971039, "timesteps_since_restore": 43200, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 42.736538461538466, "ram_util_percent": 57.39423076923076}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10977597309517, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.45722799716816, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45664177478859, "center1": -32.45664177478859, "center2": -32.45664177478859, "center3": -32.45664177478859, "center4": -32.45664177478859, "center5": -32.45664177478859, "center6": -32.45664177478859, "center7": -32.45664177478859, "center8": -32.45664177478859}, "policy_reward_mean": {"center0": -32.60635866635215, "center1": -32.60635866635215, "center2": -32.60635866635215, "center3": -32.60635866635215, "center4": -32.60635866635215, "center5": -32.60635866635215, "center6": -32.60635866635215, "center7": -32.60635866635215, "center8": -32.60635866635215}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.7338518423314, "mean_processing_ms": 6.570386705094183, "mean_inference_ms": 2.1375853010589325}, "off_policy_estimator": {}, "info": {"num_target_updates": 73, "num_steps_trained": 150000, "num_steps_sampled": 43800, "sample_time_ms": 34302.646, "replay_time_ms": 2751.074, "grad_time_ms": 143.06, "update_time_ms": 11.855, "opt_peak_throughput": 34950.366, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 43800, "episodes_total": 174, "training_iteration": 73, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-14-58", "timestamp": 1580138098, "time_this_iter_s": 38.6227970123291, "time_total_s": 2578.156939983368, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba280e0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2578.156939983368, "timesteps_since_restore": 43800, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 45.127272727272725, "ram_util_percent": 57.4709090909091}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.10977597309517, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4572279971682, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45664177478859, "center1": -32.45664177478859, "center2": -32.45664177478859, "center3": -32.45664177478859, "center4": -32.45664177478859, "center5": -32.45664177478859, "center6": -32.45664177478859, "center7": -32.45664177478859, "center8": -32.45664177478859}, "policy_reward_mean": {"center0": -32.60635866635215, "center1": -32.60635866635215, "center2": -32.60635866635215, "center3": -32.60635866635215, "center4": -32.60635866635215, "center5": -32.60635866635215, "center6": -32.60635866635215, "center7": -32.60635866635215, "center8": -32.60635866635215}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.73385184233143, "mean_processing_ms": 6.570386705094183, "mean_inference_ms": 2.1375853010589334}, "off_policy_estimator": {}, "info": {"num_target_updates": 74, "num_steps_trained": 155000, "num_steps_sampled": 44400, "sample_time_ms": 34319.504, "replay_time_ms": 2758.843, "grad_time_ms": 144.832, "update_time_ms": 11.729, "opt_peak_throughput": 34522.708, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 44400, "episodes_total": 174, "training_iteration": 74, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-15-33", "timestamp": 1580138133, "time_this_iter_s": 35.23792099952698, "time_total_s": 2613.394860982895, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28440>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2613.394860982895, "timesteps_since_restore": 44400, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 39.396, "ram_util_percent": 57.508}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1109844270565, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.55127341478646, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45677604745083, "center1": -32.45677604745083, "center2": -32.45677604745083, "center3": -32.45677604745083, "center4": -32.45677604745083, "center5": -32.45677604745083, "center6": -32.45677604745083, "center7": -32.45677604745083, "center8": -32.45677604745083}, "policy_reward_mean": {"center0": -32.61680815719862, "center1": -32.61680815719862, "center2": -32.61680815719862, "center3": -32.61680815719862, "center4": -32.61680815719862, "center5": -32.61680815719862, "center6": -32.61680815719862, "center7": -32.61680815719862, "center8": -32.61680815719862}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.5736714364882, "mean_processing_ms": 6.5721150192085, "mean_inference_ms": 2.130632673185244}, "off_policy_estimator": {}, "info": {"num_target_updates": 75, "num_steps_trained": 160000, "num_steps_sampled": 45000, "sample_time_ms": 34363.37, "replay_time_ms": 2772.791, "grad_time_ms": 144.293, "update_time_ms": 11.656, "opt_peak_throughput": 34651.785, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 45000, "episodes_total": 180, "training_iteration": 75, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-16-11", "timestamp": 1580138171, "time_this_iter_s": 37.31896114349365, "time_total_s": 2650.7138221263885, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28710>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2650.7138221263885, "timesteps_since_restore": 45000, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 41.08518518518518, "ram_util_percent": 57.45}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1109844270565, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5512734147864, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45677604745083, "center1": -32.45677604745083, "center2": -32.45677604745083, "center3": -32.45677604745083, "center4": -32.45677604745083, "center5": -32.45677604745083, "center6": -32.45677604745083, "center7": -32.45677604745083, "center8": -32.45677604745083}, "policy_reward_mean": {"center0": -32.61680815719862, "center1": -32.61680815719862, "center2": -32.61680815719862, "center3": -32.61680815719862, "center4": -32.61680815719862, "center5": -32.61680815719862, "center6": -32.61680815719862, "center7": -32.61680815719862, "center8": -32.61680815719862}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.5736714364882, "mean_processing_ms": 6.5721150192085, "mean_inference_ms": 2.130632673185243}, "off_policy_estimator": {}, "info": {"num_target_updates": 76, "num_steps_trained": 165000, "num_steps_sampled": 45600, "sample_time_ms": 34366.91, "replay_time_ms": 2746.52, "grad_time_ms": 143.481, "update_time_ms": 11.659, "opt_peak_throughput": 34847.862, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 45600, "episodes_total": 180, "training_iteration": 76, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-16-47", "timestamp": 1580138207, "time_this_iter_s": 35.939457178115845, "time_total_s": 2686.6532793045044, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6b90>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2686.6532793045044, "timesteps_since_restore": 45600, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 42.547058823529426, "ram_util_percent": 57.6}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -292.1109844270565, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5512734147864, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.45677604745083, "center1": -32.45677604745083, "center2": -32.45677604745083, "center3": -32.45677604745083, "center4": -32.45677604745083, "center5": -32.45677604745083, "center6": -32.45677604745083, "center7": -32.45677604745083, "center8": -32.45677604745083}, "policy_reward_mean": {"center0": -32.61680815719862, "center1": -32.61680815719862, "center2": -32.61680815719862, "center3": -32.61680815719862, "center4": -32.61680815719862, "center5": -32.61680815719862, "center6": -32.61680815719862, "center7": -32.61680815719862, "center8": -32.61680815719862}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.5736714364882, "mean_processing_ms": 6.5721150192085, "mean_inference_ms": 2.130632673185243}, "off_policy_estimator": {}, "info": {"num_target_updates": 77, "num_steps_trained": 170000, "num_steps_sampled": 46200, "sample_time_ms": 34509.08, "replay_time_ms": 2723.911, "grad_time_ms": 142.928, "update_time_ms": 11.79, "opt_peak_throughput": 34982.548, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 46200, "episodes_total": 180, "training_iteration": 77, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-17-23", "timestamp": 1580138243, "time_this_iter_s": 36.18074917793274, "time_total_s": 2722.834028482437, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6dd0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2722.834028482437, "timesteps_since_restore": 46200, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 40.12549019607843, "ram_util_percent": 57.625490196078445}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4438883105992, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.60487647895561, "center1": -32.60487647895561, "center2": -32.60487647895561, "center3": -32.60487647895561, "center4": -32.60487647895561, "center5": -32.60487647895561, "center6": -32.60487647895561, "center7": -32.60487647895561, "center8": -32.60487647895561}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.4418159623627, "mean_processing_ms": 6.569711818244318, "mean_inference_ms": 2.1244451183276385}, "off_policy_estimator": {}, "info": {"num_target_updates": 78, "num_steps_trained": 175000, "num_steps_sampled": 46800, "sample_time_ms": 34547.407, "replay_time_ms": 2679.952, "grad_time_ms": 139.991, "update_time_ms": 11.89, "opt_peak_throughput": 35716.479, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 46800, "episodes_total": 186, "training_iteration": 78, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-18-01", "timestamp": 1580138281, "time_this_iter_s": 38.678173780441284, "time_total_s": 2761.5122022628784, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2761.5122022628784, "timesteps_since_restore": 46800, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 45.83636363636364, "ram_util_percent": 57.350909090909084}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4438883105993, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.60487647895561, "center1": -32.60487647895561, "center2": -32.60487647895561, "center3": -32.60487647895561, "center4": -32.60487647895561, "center5": -32.60487647895561, "center6": -32.60487647895561, "center7": -32.60487647895561, "center8": -32.60487647895561}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.4418159623627, "mean_processing_ms": 6.569711818244318, "mean_inference_ms": 2.124445118327639}, "off_policy_estimator": {}, "info": {"num_target_updates": 79, "num_steps_trained": 180000, "num_steps_sampled": 47400, "sample_time_ms": 34485.636, "replay_time_ms": 2710.375, "grad_time_ms": 142.889, "update_time_ms": 11.404, "opt_peak_throughput": 34992.185, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 47400, "episodes_total": 186, "training_iteration": 79, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-18-40", "timestamp": 1580138320, "time_this_iter_s": 38.311864137649536, "time_total_s": 2799.824066400528, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2799.824066400528, "timesteps_since_restore": 47400, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 44.50727272727273, "ram_util_percent": 57.30727272727274}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5302469214203, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61447188015795, "center1": -32.61447188015795, "center2": -32.61447188015795, "center3": -32.61447188015795, "center4": -32.61447188015795, "center5": -32.61447188015795, "center6": -32.61447188015795, "center7": -32.61447188015795, "center8": -32.61447188015795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.35116065204716, "mean_processing_ms": 6.570483735243069, "mean_inference_ms": 2.119170306751356}, "off_policy_estimator": {}, "info": {"num_target_updates": 80, "num_steps_trained": 185000, "num_steps_sampled": 48000, "sample_time_ms": 34377.843, "replay_time_ms": 2704.597, "grad_time_ms": 143.154, "update_time_ms": 11.517, "opt_peak_throughput": 34927.386, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 48000, "episodes_total": 192, "training_iteration": 80, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-19-17", "timestamp": 1580138357, "time_this_iter_s": 37.14635610580444, "time_total_s": 2836.9704225063324, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28b00>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2836.9704225063324, "timesteps_since_restore": 48000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 38.89622641509434, "ram_util_percent": 57.33962264150944}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5302469214203, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61447188015795, "center1": -32.61447188015795, "center2": -32.61447188015795, "center3": -32.61447188015795, "center4": -32.61447188015795, "center5": -32.61447188015795, "center6": -32.61447188015795, "center7": -32.61447188015795, "center8": -32.61447188015795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.3511606520471, "mean_processing_ms": 6.5704837352430685, "mean_inference_ms": 2.119170306751356}, "off_policy_estimator": {}, "info": {"num_target_updates": 81, "num_steps_trained": 190000, "num_steps_sampled": 48600, "sample_time_ms": 34202.42, "replay_time_ms": 2685.295, "grad_time_ms": 141.278, "update_time_ms": 11.53, "opt_peak_throughput": 35391.285, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 48600, "episodes_total": 192, "training_iteration": 81, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-19-54", "timestamp": 1580138394, "time_this_iter_s": 36.626949071884155, "time_total_s": 2873.5973715782166, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba474d0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2873.5973715782166, "timesteps_since_restore": 48600, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 44.06153846153846, "ram_util_percent": 57.49423076923077}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.5302469214203, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61447188015795, "center1": -32.61447188015795, "center2": -32.61447188015795, "center3": -32.61447188015795, "center4": -32.61447188015795, "center5": -32.61447188015795, "center6": -32.61447188015795, "center7": -32.61447188015795, "center8": -32.61447188015795}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.3511606520471, "mean_processing_ms": 6.5704837352430685, "mean_inference_ms": 2.119170306751356}, "off_policy_estimator": {}, "info": {"num_target_updates": 82, "num_steps_trained": 195000, "num_steps_sampled": 49200, "sample_time_ms": 34113.415, "replay_time_ms": 2674.949, "grad_time_ms": 139.979, "update_time_ms": 11.359, "opt_peak_throughput": 35719.74, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 49200, "episodes_total": 192, "training_iteration": 82, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-20-29", "timestamp": 1580138429, "time_this_iter_s": 35.48624396324158, "time_total_s": 2909.083615541458, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba28c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2909.083615541458, "timesteps_since_restore": 49200, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 40.86274509803921, "ram_util_percent": 57.535294117647055}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.43327609295994, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.603697343662354, "center1": -32.603697343662354, "center2": -32.603697343662354, "center3": -32.603697343662354, "center4": -32.603697343662354, "center5": -32.603697343662354, "center6": -32.603697343662354, "center7": -32.603697343662354, "center8": -32.603697343662354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2999964455128, "mean_processing_ms": 6.567629651267777, "mean_inference_ms": 2.1146549472667213}, "off_policy_estimator": {}, "info": {"num_target_updates": 83, "num_steps_trained": 200000, "num_steps_sampled": 49800, "sample_time_ms": 33940.352, "replay_time_ms": 2681.747, "grad_time_ms": 139.397, "update_time_ms": 11.55, "opt_peak_throughput": 35868.698, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 49800, "episodes_total": 198, "training_iteration": 83, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-21-06", "timestamp": 1580138466, "time_this_iter_s": 36.95573806762695, "time_total_s": 2946.039353609085, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba47440>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2946.039353609085, "timesteps_since_restore": 49800, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 40.38653846153847, "ram_util_percent": 57.559615384615384}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.2861522817257, "episode_reward_mean": -293.4332760929599, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.809572475747224, "center1": -32.809572475747224, "center2": -32.809572475747224, "center3": -32.809572475747224, "center4": -32.809572475747224, "center5": -32.809572475747224, "center6": -32.809572475747224, "center7": -32.809572475747224, "center8": -32.809572475747224}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.603697343662354, "center1": -32.603697343662354, "center2": -32.603697343662354, "center3": -32.603697343662354, "center4": -32.603697343662354, "center5": -32.603697343662354, "center6": -32.603697343662354, "center7": -32.603697343662354, "center8": -32.603697343662354}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.29999644551293, "mean_processing_ms": 6.567629651267778, "mean_inference_ms": 2.1146549472667218}, "off_policy_estimator": {}, "info": {"num_target_updates": 84, "num_steps_trained": 205000, "num_steps_sampled": 50400, "sample_time_ms": 33959.077, "replay_time_ms": 2692.274, "grad_time_ms": 138.037, "update_time_ms": 11.51, "opt_peak_throughput": 36222.062, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 50400, "episodes_total": 198, "training_iteration": 84, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-21-42", "timestamp": 1580138502, "time_this_iter_s": 35.51662802696228, "time_total_s": 2981.5559816360474, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6dd0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 2981.5559816360474, "timesteps_since_restore": 50400, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 39.166666666666664, "ram_util_percent": 57.51960784313726}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.02661499430815, "episode_reward_mean": -293.52130924744574, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.78073499936787, "center1": -32.78073499936787, "center2": -32.78073499936787, "center3": -32.78073499936787, "center4": -32.78073499936787, "center5": -32.78073499936787, "center6": -32.78073499936787, "center7": -32.78073499936787, "center8": -32.78073499936787}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.613478805271875, "center1": -32.613478805271875, "center2": -32.613478805271875, "center3": -32.613478805271875, "center4": -32.613478805271875, "center5": -32.613478805271875, "center6": -32.613478805271875, "center7": -32.613478805271875, "center8": -32.613478805271875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2809817599905, "mean_processing_ms": 6.567872243508495, "mean_inference_ms": 2.110715407924218}, "off_policy_estimator": {}, "info": {"num_target_updates": 85, "num_steps_trained": 210000, "num_steps_sampled": 51000, "sample_time_ms": 33950.651, "replay_time_ms": 2668.304, "grad_time_ms": 137.867, "update_time_ms": 11.545, "opt_peak_throughput": 36266.932, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 51000, "episodes_total": 204, "training_iteration": 85, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-22-19", "timestamp": 1580138539, "time_this_iter_s": 36.9938428401947, "time_total_s": 3018.549824476242, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba475f0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3018.549824476242, "timesteps_since_restore": 51000, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 40.61698113207548, "ram_util_percent": 57.592452830188684}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.02661499430815, "episode_reward_mean": -293.52130924744574, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78073499936787, "center1": -32.78073499936787, "center2": -32.78073499936787, "center3": -32.78073499936787, "center4": -32.78073499936787, "center5": -32.78073499936787, "center6": -32.78073499936787, "center7": -32.78073499936787, "center8": -32.78073499936787}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.613478805271875, "center1": -32.613478805271875, "center2": -32.613478805271875, "center3": -32.613478805271875, "center4": -32.613478805271875, "center5": -32.613478805271875, "center6": -32.613478805271875, "center7": -32.613478805271875, "center8": -32.613478805271875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2809817599905, "mean_processing_ms": 6.5678722435084955, "mean_inference_ms": 2.110715407924218}, "off_policy_estimator": {}, "info": {"num_target_updates": 86, "num_steps_trained": 215000, "num_steps_sampled": 51600, "sample_time_ms": 33821.319, "replay_time_ms": 2666.915, "grad_time_ms": 138.483, "update_time_ms": 11.541, "opt_peak_throughput": 36105.633, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 51600, "episodes_total": 204, "training_iteration": 86, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-22-53", "timestamp": 1580138573, "time_this_iter_s": 34.63835120201111, "time_total_s": 3053.188175678253, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3053.188175678253, "timesteps_since_restore": 51600, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 38.655102040816324, "ram_util_percent": 57.61836734693877}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -295.02661499430815, "episode_reward_mean": -293.52130924744574, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.78073499936787, "center1": -32.78073499936787, "center2": -32.78073499936787, "center3": -32.78073499936787, "center4": -32.78073499936787, "center5": -32.78073499936787, "center6": -32.78073499936787, "center7": -32.78073499936787, "center8": -32.78073499936787}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.613478805271875, "center1": -32.613478805271875, "center2": -32.613478805271875, "center3": -32.613478805271875, "center4": -32.613478805271875, "center5": -32.613478805271875, "center6": -32.613478805271875, "center7": -32.613478805271875, "center8": -32.613478805271875}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2809817599905, "mean_processing_ms": 6.5678722435084955, "mean_inference_ms": 2.110715407924218}, "off_policy_estimator": {}, "info": {"num_target_updates": 87, "num_steps_trained": 220000, "num_steps_sampled": 52200, "sample_time_ms": 33738.631, "replay_time_ms": 2670.973, "grad_time_ms": 139.133, "update_time_ms": 11.36, "opt_peak_throughput": 35936.751, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 52200, "episodes_total": 204, "training_iteration": 87, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-23-29", "timestamp": 1580138609, "time_this_iter_s": 35.39893198013306, "time_total_s": 3088.5871076583862, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba475f0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3088.5871076583862, "timesteps_since_restore": 52200, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 40.208, "ram_util_percent": 57.732000000000006}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.42191121199517, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.60243457911071, "center1": -32.60243457911071, "center2": -32.60243457911071, "center3": -32.60243457911071, "center4": -32.60243457911071, "center5": -32.60243457911071, "center6": -32.60243457911071, "center7": -32.60243457911071, "center8": -32.60243457911071}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.25559356717537, "mean_processing_ms": 6.564552152381331, "mean_inference_ms": 2.1070363568834796}, "off_policy_estimator": {}, "info": {"num_target_updates": 88, "num_steps_trained": 225000, "num_steps_sampled": 52800, "sample_time_ms": 33599.254, "replay_time_ms": 2650.224, "grad_time_ms": 138.646, "update_time_ms": 11.284, "opt_peak_throughput": 36063.034, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 52800, "episodes_total": 210, "training_iteration": 88, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-24-06", "timestamp": 1580138646, "time_this_iter_s": 37.07300090789795, "time_total_s": 3125.660108566284, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3125.660108566284, "timesteps_since_restore": 52800, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 43.34905660377358, "ram_util_percent": 57.77924528301885}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.42191121199517, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.60243457911071, "center1": -32.60243457911071, "center2": -32.60243457911071, "center3": -32.60243457911071, "center4": -32.60243457911071, "center5": -32.60243457911071, "center6": -32.60243457911071, "center7": -32.60243457911071, "center8": -32.60243457911071}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.25559356717537, "mean_processing_ms": 6.56455215238133, "mean_inference_ms": 2.1070363568834796}, "off_policy_estimator": {}, "info": {"num_target_updates": 89, "num_steps_trained": 230000, "num_steps_sampled": 53400, "sample_time_ms": 33388.085, "replay_time_ms": 2620.357, "grad_time_ms": 134.942, "update_time_ms": 11.289, "opt_peak_throughput": 37052.869, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 53400, "episodes_total": 210, "training_iteration": 89, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-24-42", "timestamp": 1580138682, "time_this_iter_s": 35.86361598968506, "time_total_s": 3161.5237245559692, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba475f0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3161.5237245559692, "timesteps_since_restore": 53400, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 38.95882352941177, "ram_util_percent": 57.69019607843138}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.5160134205157, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61289038005742, "center1": -32.61289038005742, "center2": -32.61289038005742, "center3": -32.61289038005742, "center4": -32.61289038005742, "center5": -32.61289038005742, "center6": -32.61289038005742, "center7": -32.61289038005742, "center8": -32.61289038005742}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.25584492978203, "mean_processing_ms": 6.564525419245681, "mean_inference_ms": 2.103907687238895}, "off_policy_estimator": {}, "info": {"num_target_updates": 90, "num_steps_trained": 235000, "num_steps_sampled": 54000, "sample_time_ms": 33376.348, "replay_time_ms": 2632.307, "grad_time_ms": 139.242, "update_time_ms": 11.102, "opt_peak_throughput": 35908.729, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 54000, "episodes_total": 216, "training_iteration": 90, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-25-19", "timestamp": 1580138719, "time_this_iter_s": 37.19548177719116, "time_total_s": 3198.7192063331604, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba47560>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3198.7192063331604, "timesteps_since_restore": 54000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 38.75660377358491, "ram_util_percent": 57.53207547169813}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.5160134205157, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61289038005743, "center1": -32.61289038005743, "center2": -32.61289038005743, "center3": -32.61289038005743, "center4": -32.61289038005743, "center5": -32.61289038005743, "center6": -32.61289038005743, "center7": -32.61289038005743, "center8": -32.61289038005743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2558449297821, "mean_processing_ms": 6.564525419245683, "mean_inference_ms": 2.1039076872388955}, "off_policy_estimator": {}, "info": {"num_target_updates": 91, "num_steps_trained": 240000, "num_steps_sampled": 54600, "sample_time_ms": 33372.761, "replay_time_ms": 2610.988, "grad_time_ms": 139.805, "update_time_ms": 11.396, "opt_peak_throughput": 35764.037, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 54600, "episodes_total": 216, "training_iteration": 91, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-25-55", "timestamp": 1580138755, "time_this_iter_s": 36.38629198074341, "time_total_s": 3235.105498313904, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6c20>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3235.105498313904, "timesteps_since_restore": 54600, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 42.4923076923077, "ram_util_percent": 57.50384615384616}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.5160134205157, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61289038005743, "center1": -32.61289038005743, "center2": -32.61289038005743, "center3": -32.61289038005743, "center4": -32.61289038005743, "center5": -32.61289038005743, "center6": -32.61289038005743, "center7": -32.61289038005743, "center8": -32.61289038005743}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.2558449297821, "mean_processing_ms": 6.564525419245683, "mean_inference_ms": 2.1039076872388955}, "off_policy_estimator": {}, "info": {"num_target_updates": 92, "num_steps_trained": 245000, "num_steps_sampled": 55200, "sample_time_ms": 33389.781, "replay_time_ms": 2603.004, "grad_time_ms": 139.12, "update_time_ms": 11.508, "opt_peak_throughput": 35940.231, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 55200, "episodes_total": 216, "training_iteration": 92, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-26-31", "timestamp": 1580138791, "time_this_iter_s": 35.57087016105652, "time_total_s": 3270.6763684749603, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3270.6763684749603, "timesteps_since_restore": 55200, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 39.34509803921569, "ram_util_percent": 57.313725490196084}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.41494901621917, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.601661001802256, "center1": -32.601661001802256, "center2": -32.601661001802256, "center3": -32.601661001802256, "center4": -32.601661001802256, "center5": -32.601661001802256, "center6": -32.601661001802256, "center7": -32.601661001802256, "center8": -32.601661001802256}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.278903309888, "mean_processing_ms": 6.562124258875284, "mean_inference_ms": 2.101207928103424}, "off_policy_estimator": {}, "info": {"num_target_updates": 93, "num_steps_trained": 250000, "num_steps_sampled": 55800, "sample_time_ms": 33412.5, "replay_time_ms": 2590.561, "grad_time_ms": 140.529, "update_time_ms": 11.381, "opt_peak_throughput": 35579.914, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 55800, "episodes_total": 222, "training_iteration": 93, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-27-08", "timestamp": 1580138828, "time_this_iter_s": 37.0810387134552, "time_total_s": 3307.7574071884155, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6dd0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3307.7574071884155, "timesteps_since_restore": 55800, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 40.328301886792445, "ram_util_percent": 57.422641509433966}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.41494901621905, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.60166100180225, "center1": -32.60166100180225, "center2": -32.60166100180225, "center3": -32.60166100180225, "center4": -32.60166100180225, "center5": -32.60166100180225, "center6": -32.60166100180225, "center7": -32.60166100180225, "center8": -32.60166100180225}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.27890330988794, "mean_processing_ms": 6.562124258875283, "mean_inference_ms": 2.101207928103423}, "off_policy_estimator": {}, "info": {"num_target_updates": 94, "num_steps_trained": 255000, "num_steps_sampled": 56400, "sample_time_ms": 33578.135, "replay_time_ms": 2569.57, "grad_time_ms": 140.521, "update_time_ms": 11.684, "opt_peak_throughput": 35581.761, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 56400, "episodes_total": 222, "training_iteration": 94, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-27-45", "timestamp": 1580138865, "time_this_iter_s": 36.96721792221069, "time_total_s": 3344.724625110626, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28ba47560>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3344.724625110626, "timesteps_since_restore": 56400, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 44.263461538461534, "ram_util_percent": 57.63269230769231}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.50886338442916, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61209593160336, "center1": -32.61209593160336, "center2": -32.61209593160336, "center3": -32.61209593160336, "center4": -32.61209593160336, "center5": -32.61209593160336, "center6": -32.61209593160336, "center7": -32.61209593160336, "center8": -32.61209593160336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.32516538555575, "mean_processing_ms": 6.562694167270262, "mean_inference_ms": 2.0989690374455168}, "off_policy_estimator": {}, "info": {"num_target_updates": 95, "num_steps_trained": 260000, "num_steps_sampled": 57000, "sample_time_ms": 33507.533, "replay_time_ms": 2594.998, "grad_time_ms": 141.708, "update_time_ms": 11.65, "opt_peak_throughput": 35283.712, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 57000, "episodes_total": 228, "training_iteration": 95, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-28-22", "timestamp": 1580138902, "time_this_iter_s": 36.55460810661316, "time_total_s": 3381.2792332172394, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x15c7c6cb0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3381.2792332172394, "timesteps_since_restore": 57000, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.223076923076924, "ram_util_percent": 57.53461538461538}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.5088633844292, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61209593160336, "center1": -32.61209593160336, "center2": -32.61209593160336, "center3": -32.61209593160336, "center4": -32.61209593160336, "center5": -32.61209593160336, "center6": -32.61209593160336, "center7": -32.61209593160336, "center8": -32.61209593160336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.32516538555575, "mean_processing_ms": 6.562694167270263, "mean_inference_ms": 2.098969037445517}, "off_policy_estimator": {}, "info": {"num_target_updates": 96, "num_steps_trained": 265000, "num_steps_sampled": 57600, "sample_time_ms": 33575.037, "replay_time_ms": 2612.604, "grad_time_ms": 142.079, "update_time_ms": 11.749, "opt_peak_throughput": 35191.802, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 57600, "episodes_total": 228, "training_iteration": 96, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-28-57", "timestamp": 1580138937, "time_this_iter_s": 35.494505882263184, "time_total_s": 3416.7737390995026, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28c082ef0>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3416.7737390995026, "timesteps_since_restore": 57600, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 41.699999999999996, "ram_util_percent": 57.772549019607844}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
{"episode_reward_max": -291.71521166194833, "episode_reward_min": -294.8477032545726, "episode_reward_mean": -293.5088633844292, "episode_len_mean": 250.0, "episodes_this_iter": 0, "policy_reward_min": {"center0": -32.7608559171747, "center1": -32.7608559171747, "center2": -32.7608559171747, "center3": -32.7608559171747, "center4": -32.7608559171747, "center5": -32.7608559171747, "center6": -32.7608559171747, "center7": -32.7608559171747, "center8": -32.7608559171747}, "policy_reward_max": {"center0": -32.41280129577231, "center1": -32.41280129577231, "center2": -32.41280129577231, "center3": -32.41280129577231, "center4": -32.41280129577231, "center5": -32.41280129577231, "center6": -32.41280129577231, "center7": -32.41280129577231, "center8": -32.41280129577231}, "policy_reward_mean": {"center0": -32.61209593160336, "center1": -32.61209593160336, "center2": -32.61209593160336, "center3": -32.61209593160336, "center4": -32.61209593160336, "center5": -32.61209593160336, "center6": -32.61209593160336, "center7": -32.61209593160336, "center8": -32.61209593160336}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 318.32516538555575, "mean_processing_ms": 6.562694167270263, "mean_inference_ms": 2.098969037445517}, "off_policy_estimator": {}, "info": {"num_target_updates": 97, "num_steps_trained": 270000, "num_steps_sampled": 58200, "sample_time_ms": 33688.977, "replay_time_ms": 2604.347, "grad_time_ms": 139.854, "update_time_ms": 11.829, "opt_peak_throughput": 35751.478, "opt_samples": 5000.0, "learner": {"center0": {}, "center1": {}, "center2": {}, "center3": {}, "center4": {}, "center5": {}, "center6": {}, "center7": {}, "center8": {}}}, "timesteps_this_iter": 600, "done": false, "timesteps_total": 58200, "episodes_total": 228, "training_iteration": 97, "experiment_id": "83857e62c04a4219974be09da6b548f8", "date": "2020-01-27_16-29-33", "timestamp": 1580138973, "time_this_iter_s": 36.43420696258545, "time_total_s": 3453.207946062088, "pid": 61761, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 100, "batch_mode": "truncate_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"grid_0_3x3_i300_multiagent\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 25,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "contrib/MADDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": null, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"center0": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 0, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center1": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 1, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center2": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 2, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center3": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 3, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center4": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 4, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center5": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 5, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center6": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 6, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center7": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 7, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}], "center8": ["<class 'ray.rllib.contrib.maddpg.maddpg_policy.MADDPGTFPolicy'>", "Box(42,)", "Box(1,)", {"agent_id": 8, "use_local_critic": false, "obs_space_dict": {"0": "Box(42,)", "1": "Box(42,)", "2": "Box(42,)", "3": "Box(42,)", "4": "Box(42,)"}, "act_space_dict": {"0": "Box(1,)", "1": "Box(1,)", "2": "Box(1,)", "3": "Box(1,)", "4": "Box(1,)"}}]}, "policy_mapping_fn": "<function setup_exps_rllib.<locals>.<lambda> at 0x28c082e60>", "policies_to_train": null}, "agent_id": null, "use_local_critic": false, "use_state_preprocessor": false, "actor_hiddens": [64, 64], "actor_hidden_activation": "relu", "critic_hiddens": [64, 64], "critic_hidden_activation": "relu", "n_step": 1, "good_policy": "maddpg", "adv_policy": "maddpg", "buffer_size": 1000000, "critic_lr": 0.01, "actor_lr": 0.01, "target_network_update_freq": 0, "tau": 0.01, "actor_feature_reg": 0.001, "grad_norm_clipping": 0.5, "learning_starts": 25600}, "time_since_restore": 3453.207946062088, "timesteps_since_restore": 58200, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 44.86346153846155, "ram_util_percent": 57.80384615384615}, "num_healthy_workers": 6, "trial_id": "b9973cc0", "experiment_tag": "0"}
