{"episode_reward_max": -549.8511639240808, "episode_reward_min": -594.8925370799385, "episode_reward_mean": -571.4018615223142, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -66.09917078665984}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -63.489095724701556}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 315.9629695443993, "mean_processing_ms": 6.246219909840213, "mean_inference_ms": 1.1471956374635734}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 1, "num_steps_trained": 0, "num_steps_sampled": 1500, "sample_time_ms": 90025.35, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 945.92, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 1500, "episodes_total": 6, "training_iteration": 1, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-23-14", "timestamp": 1579886594, "time_this_iter_s": 90.9851450920105, "time_total_s": 90.9851450920105, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 90.9851450920105, "timesteps_since_restore": 1500, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 41.81, "ram_util_percent": 36.38384615384615}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -595.5468399653007, "episode_reward_mean": -572.5863919276952, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -66.17187110725584}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -63.620710214188364}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 313.67443455423296, "mean_processing_ms": 6.235915098404601, "mean_inference_ms": 1.0661629096751848}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 2, "num_steps_trained": 0, "num_steps_sampled": 3000, "sample_time_ms": 85137.787, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 476.195, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 3000, "episodes_total": 12, "training_iteration": 2, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-24-34", "timestamp": 1579886674, "time_this_iter_s": 80.26869201660156, "time_total_s": 171.25383710861206, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 171.25383710861206, "timesteps_since_restore": 3000, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 40.10263157894737, "ram_util_percent": 36.75175438596491}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -600.9256977003993, "episode_reward_mean": -576.1718582901644, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -66.76952196671103}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -64.01909536557383}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 312.2204737960913, "mean_processing_ms": 6.226875116595823, "mean_inference_ms": 1.020972518611205}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 3, "num_steps_trained": 0, "num_steps_sampled": 4500, "sample_time_ms": 83369.596, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 319.502, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 4500, "episodes_total": 18, "training_iteration": 3, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-25-54", "timestamp": 1579886754, "time_this_iter_s": 79.85105919837952, "time_total_s": 251.10489630699158, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 251.10489630699158, "timesteps_since_restore": 4500, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.733333333333334, "ram_util_percent": 36.9842105263158}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -604.3065315271823, "episode_reward_mean": -580.032048733858, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -67.14517016968703}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -64.44800541487314}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 311.631633464128, "mean_processing_ms": 6.216285698465183, "mean_inference_ms": 0.9926273409616414}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 4, "num_steps_trained": 0, "num_steps_sampled": 6000, "sample_time_ms": 82846.656, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 241.16, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 6000, "episodes_total": 24, "training_iteration": 4, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-27-15", "timestamp": 1579886835, "time_this_iter_s": 81.29660177230835, "time_total_s": 332.4014980792999, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 332.4014980792999, "timesteps_since_restore": 6000, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 41.83362068965518, "ram_util_percent": 37.19224137931034}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -604.3065315271823, "episode_reward_mean": -577.1210073370988, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -67.14517016968703}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -64.12455637078877}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 311.31093464764314, "mean_processing_ms": 6.204444466441112, "mean_inference_ms": 0.9726002407619307}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 5, "num_steps_trained": 0, "num_steps_sampled": 7500, "sample_time_ms": 82440.22, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 194.051, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 7500, "episodes_total": 30, "training_iteration": 5, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-28-36", "timestamp": 1579886916, "time_this_iter_s": 80.83292484283447, "time_total_s": 413.2344229221344, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 413.2344229221344, "timesteps_since_restore": 7500, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 40.21999999999999, "ram_util_percent": 37.489565217391316}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -619.4606414108883, "episode_reward_mean": -578.8350005082247, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -68.8289601567653}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -64.31500005646942}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 310.65692654963414, "mean_processing_ms": 6.195498492060645, "mean_inference_ms": 0.956086162576509}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 6, "num_steps_trained": 0, "num_steps_sampled": 9000, "sample_time_ms": 81481.841, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 162.546, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 9000, "episodes_total": 36, "training_iteration": 6, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-29-53", "timestamp": 1579886993, "time_this_iter_s": 76.70643401145935, "time_total_s": 489.94085693359375, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 489.94085693359375, "timesteps_since_restore": 9000, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.51100917431193, "ram_util_percent": 37.64036697247706}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -619.4606414108883, "episode_reward_mean": -578.9159045682127, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -68.8289601567653}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -64.32398939646808}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 309.80576745363095, "mean_processing_ms": 6.186347468314838, "mean_inference_ms": 0.9422610819784009}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 7, "num_steps_trained": 0, "num_steps_sampled": 10500, "sample_time_ms": 80634.473, "replay_time_ms": NaN, "grad_time_ms": NaN, "update_time_ms": 140.081, "opt_peak_throughput": 0.0, "opt_samples": NaN, "learner": {}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 10500, "episodes_total": 42, "training_iteration": 7, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-31-08", "timestamp": 1579887068, "time_this_iter_s": 75.56649327278137, "time_total_s": 565.5073502063751, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 565.5073502063751, "timesteps_since_restore": 10500, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.010280373831776, "ram_util_percent": 37.70841121495327}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -1424.4604814167033, "episode_reward_mean": -630.6540068796166, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -158.27338682407873}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -70.07266743106852}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 308.83897510546643, "mean_processing_ms": 6.17804533534979, "mean_inference_ms": 0.9305172098002421}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 8, "num_steps_trained": 5000, "num_steps_sampled": 12000, "sample_time_ms": 79843.47, "replay_time_ms": 317.673, "grad_time_ms": 303.047, "update_time_ms": 123.305, "opt_peak_throughput": 16499.081, "opt_samples": 5000.0, "learner": {"av": {"mean_q": 0.014602255076169968, "max_q": 0.27875852584838867, "min_q": -0.3416496217250824}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 12000, "episodes_total": 48, "training_iteration": 8, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-32-23", "timestamp": 1579887143, "time_this_iter_s": 74.94947218894958, "time_total_s": 640.4568223953247, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 640.4568223953247, "timesteps_since_restore": 12000, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.43018867924528, "ram_util_percent": 37.82547169811321}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -1424.4604814167033, "episode_reward_mean": -656.1473798066436, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -158.27338682407873}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -72.90526442296039}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 307.9253057513011, "mean_processing_ms": 6.171498676364501, "mean_inference_ms": 0.9206092383195126}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 9, "num_steps_trained": 10000, "num_steps_sampled": 13500, "sample_time_ms": 79360.7, "replay_time_ms": 297.465, "grad_time_ms": 189.269, "update_time_ms": 110.346, "opt_peak_throughput": 26417.484, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4745287001132965, "max_q": -0.13697297871112823, "min_q": -1.0201950073242188}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 13500, "episodes_total": 54, "training_iteration": 9, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-33-39", "timestamp": 1579887219, "time_this_iter_s": 75.87276697158813, "time_total_s": 716.3295893669128, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 716.3295893669128, "timesteps_since_restore": 13500, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 36.71388888888889, "ram_util_percent": 38.004629629629626}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -894.6476011663531, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -99.40528901848374}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 307.09352233724206, "mean_processing_ms": 6.163101207922486, "mean_inference_ms": 0.9121817626967176}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 10, "num_steps_trained": 15000, "num_steps_sampled": 15000, "sample_time_ms": 79006.248, "replay_time_ms": 292.949, "grad_time_ms": 148.173, "update_time_ms": 99.898, "opt_peak_throughput": 33744.409, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.5226429104804993, "max_q": -0.177791029214859, "min_q": -0.9874382615089417}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 15000, "episodes_total": 60, "training_iteration": 10, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-34-56", "timestamp": 1579887296, "time_this_iter_s": 76.18534183502197, "time_total_s": 792.5149312019348, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 792.5149312019348, "timesteps_since_restore": 15000, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 37.23055555555556, "ram_util_percent": 38.137962962962966}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -549.8511639240808, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -1090.1894166154932, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -61.09457376934226}, "policy_reward_mean": {"av": -121.13215740172156}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 306.39323914659184, "mean_processing_ms": 6.154981983761965, "mean_inference_ms": 0.9050680232633068}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 11, "num_steps_trained": 20000, "num_steps_sampled": 16500, "sample_time_ms": 77754.07, "replay_time_ms": 289.731, "grad_time_ms": 129.417, "update_time_ms": 5.936, "opt_peak_throughput": 38634.658, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4607183039188385, "max_q": -0.18430618941783905, "min_q": -0.8081069588661194}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 16500, "episodes_total": 66, "training_iteration": 11, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-36-13", "timestamp": 1579887373, "time_this_iter_s": 77.87802696228027, "time_total_s": 870.3929581642151, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 870.3929581642151, "timesteps_since_restore": 16500, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.797297297297305, "ram_util_percent": 40.092792792792814}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -425.5983204120827, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -1036.6035708705228, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -47.28870226800921}, "policy_reward_mean": {"av": -115.17817454116924}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 305.73388280655104, "mean_processing_ms": 6.147822588292556, "mean_inference_ms": 0.898814151697664}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 12, "num_steps_trained": 25000, "num_steps_sampled": 18000, "sample_time_ms": 77278.137, "replay_time_ms": 294.389, "grad_time_ms": 118.633, "update_time_ms": 5.923, "opt_peak_throughput": 42146.659, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.43793848156929016, "max_q": -0.16816167533397675, "min_q": -0.7273290753364563}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 18000, "episodes_total": 72, "training_iteration": 12, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-37-29", "timestamp": 1579887449, "time_this_iter_s": 75.90138387680054, "time_total_s": 946.2943420410156, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 946.2943420410156, "timesteps_since_restore": 18000, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.998130841121494, "ram_util_percent": 40.13831775700935}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -425.5983204120827, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -991.8614519719727, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -47.28870226800921}, "policy_reward_mean": {"av": -110.20682799688593}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 305.0775464210447, "mean_processing_ms": 6.142219849417559, "mean_inference_ms": 0.8931688357260962}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 13, "num_steps_trained": 30000, "num_steps_sampled": 19500, "sample_time_ms": 76677.713, "replay_time_ms": 298.481, "grad_time_ms": 112.281, "update_time_ms": 5.928, "opt_peak_throughput": 44531.193, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4483318328857422, "max_q": -0.20977747440338135, "min_q": -0.7554659843444824}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 19500, "episodes_total": 78, "training_iteration": 13, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-38-44", "timestamp": 1579887524, "time_this_iter_s": 74.24908494949341, "time_total_s": 1020.543426990509, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1020.543426990509, "timesteps_since_restore": 19500, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.50188679245283, "ram_util_percent": 40.24905660377358}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -341.45687614519716, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -945.9668654804528, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.93965290502203}, "policy_reward_mean": {"av": -105.10742949782814}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 304.45257991218693, "mean_processing_ms": 6.13613961303566, "mean_inference_ms": 0.8880613284157536}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 14, "num_steps_trained": 35000, "num_steps_sampled": 21000, "sample_time_ms": 75987.366, "replay_time_ms": 296.205, "grad_time_ms": 105.948, "update_time_ms": 5.89, "opt_peak_throughput": 47193.082, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4841770529747009, "max_q": -0.21403397619724274, "min_q": -0.8881241679191589}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 21000, "episodes_total": 84, "training_iteration": 14, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-39-58", "timestamp": 1579887598, "time_this_iter_s": 74.74644589424133, "time_total_s": 1095.2898728847504, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1095.2898728847504, "timesteps_since_restore": 21000, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.35283018867925, "ram_util_percent": 40.52075471698114}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -336.4424575580255, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -906.0536165429684, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.382495284225165}, "policy_reward_mean": {"av": -100.67262406032985}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 303.8669715687411, "mean_processing_ms": 6.129866314632412, "mean_inference_ms": 0.8834516593317571}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 15, "num_steps_trained": 40000, "num_steps_sampled": 22500, "sample_time_ms": 75384.603, "replay_time_ms": 296.236, "grad_time_ms": 101.066, "update_time_ms": 5.951, "opt_peak_throughput": 49472.859, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.5216594934463501, "max_q": -0.24300134181976318, "min_q": -1.0520071983337402}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 22500, "episodes_total": 90, "training_iteration": 15, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-41-14", "timestamp": 1579887674, "time_this_iter_s": 75.17232894897461, "time_total_s": 1170.462201833725, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1170.462201833725, "timesteps_since_restore": 22500, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.51603773584905, "ram_util_percent": 40.68396226415094}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -871.1724984494164, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -96.79694427215742}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 303.32232013693937, "mean_processing_ms": 6.124296257097683, "mean_inference_ms": 0.8792783604799189}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 16, "num_steps_trained": 45000, "num_steps_sampled": 24000, "sample_time_ms": 75222.459, "replay_time_ms": 296.025, "grad_time_ms": 97.287, "update_time_ms": 6.24, "opt_peak_throughput": 51394.542, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.5447791218757629, "max_q": -0.21079790592193604, "min_q": -1.1798574924468994}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 24000, "episodes_total": 96, "training_iteration": 16, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-42-29", "timestamp": 1579887749, "time_this_iter_s": 75.455087184906, "time_total_s": 1245.917289018631, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1245.917289018631, "timesteps_since_restore": 24000, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 36.87102803738318, "ram_util_percent": 40.79906542056076}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -846.0186429372824, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -94.00207143747586}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 302.57781832221025, "mean_processing_ms": 6.113815027332816, "mean_inference_ms": 0.8703605465378569}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 17, "num_steps_trained": 50000, "num_steps_sampled": 25500, "sample_time_ms": 75152.355, "replay_time_ms": 295.961, "grad_time_ms": 94.243, "update_time_ms": 6.4, "opt_peak_throughput": 53054.485, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.5344712734222412, "max_q": -0.16852955520153046, "min_q": -1.2854390144348145}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 25500, "episodes_total": 102, "training_iteration": 17, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-43-44", "timestamp": 1579887824, "time_this_iter_s": 75.23494291305542, "time_total_s": 1321.1522319316864, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1321.1522319316864, "timesteps_since_restore": 25500, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.38504672897196, "ram_util_percent": 40.94953271028038}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -832.6635915494403, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -92.51817683882676}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 301.32907903483664, "mean_processing_ms": 6.104579978096078, "mean_inference_ms": 0.8533778087133941}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 18, "num_steps_trained": 55000, "num_steps_sampled": 27000, "sample_time_ms": 75093.782, "replay_time_ms": 295.549, "grad_time_ms": 71.641, "update_time_ms": 6.491, "opt_peak_throughput": 69792.817, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.49669149518013, "max_q": -0.09854042530059814, "min_q": -1.3679240942001343}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 27000, "episodes_total": 108, "training_iteration": 18, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-44-58", "timestamp": 1579887898, "time_this_iter_s": 74.13336300849915, "time_total_s": 1395.2855949401855, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1395.2855949401855, "timesteps_since_restore": 27000, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 35.36095238095238, "ram_util_percent": 41.051428571428566}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -818.8251799614135, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -90.9805755512682}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 300.2766611688076, "mean_processing_ms": 6.093793535268236, "mean_inference_ms": 0.8438614648831408}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 19, "num_steps_trained": 60000, "num_steps_sampled": 28500, "sample_time_ms": 74936.365, "replay_time_ms": 296.482, "grad_time_ms": 72.043, "update_time_ms": 6.47, "opt_peak_throughput": 69403.166, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.43872758746147156, "max_q": 0.018990304321050644, "min_q": -1.4188296794891357}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 28500, "episodes_total": 114, "training_iteration": 19, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-46-13", "timestamp": 1579887973, "time_this_iter_s": 74.3125331401825, "time_total_s": 1469.598128080368, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1469.598128080368, "timesteps_since_restore": 28500, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 36.40943396226415, "ram_util_percent": 41.0867924528302}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -804.5831307648027, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -89.3981256405337}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 299.28444453034155, "mean_processing_ms": 6.085549114194983, "mean_inference_ms": 0.836943951341635}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 20, "num_steps_trained": 65000, "num_steps_sampled": 30000, "sample_time_ms": 74870.038, "replay_time_ms": 299.827, "grad_time_ms": 71.912, "update_time_ms": 6.482, "opt_peak_throughput": 69529.399, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3913685977458954, "max_q": 0.11499827355146408, "min_q": -1.510941743850708}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 30000, "episodes_total": 120, "training_iteration": 20, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-47-28", "timestamp": 1579888048, "time_this_iter_s": 75.556973695755, "time_total_s": 1545.155101776123, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1545.155101776123, "timesteps_since_restore": 30000, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.995327102803735, "ram_util_percent": 41.15327102803739}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -790.577055411525, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -87.84189504572504}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 298.2508974598479, "mean_processing_ms": 6.0793056951231925, "mean_inference_ms": 0.8312342130953234}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 21, "num_steps_trained": 70000, "num_steps_sampled": 31500, "sample_time_ms": 74607.952, "replay_time_ms": 300.034, "grad_time_ms": 71.466, "update_time_ms": 6.537, "opt_peak_throughput": 69963.673, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3668987452983856, "max_q": 0.14614127576351166, "min_q": -1.5912128686904907}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 31500, "episodes_total": 126, "training_iteration": 21, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-48-44", "timestamp": 1579888124, "time_this_iter_s": 75.25661587715149, "time_total_s": 1620.4117176532745, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1620.4117176532745, "timesteps_since_restore": 31500, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.061682242990656, "ram_util_percent": 41.30934579439251}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -776.8358697271776, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -86.31509663635313}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 297.2472185171727, "mean_processing_ms": 6.073288607393483, "mean_inference_ms": 0.8264290664202708}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 22, "num_steps_trained": 75000, "num_steps_sampled": 33000, "sample_time_ms": 74540.387, "replay_time_ms": 296.61, "grad_time_ms": 71.859, "update_time_ms": 6.568, "opt_peak_throughput": 69580.543, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.37632861733436584, "max_q": 0.1291700303554535, "min_q": -1.7058637142181396}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 33000, "episodes_total": 132, "training_iteration": 22, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-49-59", "timestamp": 1579888199, "time_this_iter_s": 75.19626379013062, "time_total_s": 1695.6079814434052, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1695.6079814434052, "timesteps_since_restore": 33000, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 36.814018691588785, "ram_util_percent": 41.43364485981308}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -763.2199253406767, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -84.80221392674194}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 296.37617312210614, "mean_processing_ms": 6.067896844081714, "mean_inference_ms": 0.8225472642180908}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 23, "num_steps_trained": 80000, "num_steps_sampled": 34500, "sample_time_ms": 74525.867, "replay_time_ms": 295.656, "grad_time_ms": 72.072, "update_time_ms": 6.562, "opt_peak_throughput": 69375.11, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4087476134300232, "max_q": 0.13143712282180786, "min_q": -1.8304657936096191}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 34500, "episodes_total": 138, "training_iteration": 23, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-51-13", "timestamp": 1579888273, "time_this_iter_s": 74.09745693206787, "time_total_s": 1769.705438375473, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1769.705438375473, "timesteps_since_restore": 34500, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 36.33619047619048, "ram_util_percent": 41.5352380952381}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -742.4824144054602, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -82.49804604505121}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 295.63352722676734, "mean_processing_ms": 6.063128401887999, "mean_inference_ms": 0.819353620515366}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 24, "num_steps_trained": 85000, "num_steps_sampled": 36000, "sample_time_ms": 74402.272, "replay_time_ms": 297.848, "grad_time_ms": 73.513, "update_time_ms": 6.602, "opt_peak_throughput": 68014.866, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.417559415102005, "max_q": 0.10662195086479187, "min_q": -1.8179479837417603}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 36000, "episodes_total": 144, "training_iteration": 24, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-52-27", "timestamp": 1579888347, "time_this_iter_s": 73.54613208770752, "time_total_s": 1843.2515704631805, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1843.2515704631805, "timesteps_since_restore": 36000, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.84615384615385, "ram_util_percent": 41.67788461538461}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -705.776468427397, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -78.41960760304417}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 295.0071901518321, "mean_processing_ms": 6.058168617214697, "mean_inference_ms": 0.8166675692977452}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 25, "num_steps_trained": 90000, "num_steps_sampled": 37500, "sample_time_ms": 74350.196, "replay_time_ms": 297.079, "grad_time_ms": 74.811, "update_time_ms": 6.582, "opt_peak_throughput": 66834.894, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.41056084632873535, "max_q": 0.10587550699710846, "min_q": -1.840117335319519}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 37500, "episodes_total": 150, "training_iteration": 25, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-53-41", "timestamp": 1579888421, "time_this_iter_s": 74.6566367149353, "time_total_s": 1917.9082071781158, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1917.9082071781158, "timesteps_since_restore": 37500, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 36.697169811320755, "ram_util_percent": 41.80283018867926}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3629.480960831675, "episode_reward_mean": -632.8016421464998, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -403.2756623146304}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -70.31129357183339}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 294.4513413928919, "mean_processing_ms": 6.054054591850254, "mean_inference_ms": 0.8143379124536633}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 26, "num_steps_trained": 95000, "num_steps_sampled": 39000, "sample_time_ms": 74329.884, "replay_time_ms": 295.882, "grad_time_ms": 74.853, "update_time_ms": 6.317, "opt_peak_throughput": 66797.321, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.38405483961105347, "max_q": 0.12196264415979385, "min_q": -1.7762413024902344}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 39000, "episodes_total": 156, "training_iteration": 26, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-54-57", "timestamp": 1579888497, "time_this_iter_s": 75.23591303825378, "time_total_s": 1993.1441202163696, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 1993.1441202163696, "timesteps_since_restore": 39000, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.09158878504673, "ram_util_percent": 41.93644859813083}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -3431.460314874071, "episode_reward_mean": -465.763043920339, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -381.2733683193398}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -51.75144932448216}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 293.9305185686946, "mean_processing_ms": 6.0514133055441315, "mean_inference_ms": 0.8122201014937903}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 27, "num_steps_trained": 100000, "num_steps_sampled": 40500, "sample_time_ms": 74334.126, "replay_time_ms": 294.51, "grad_time_ms": 74.976, "update_time_ms": 6.309, "opt_peak_throughput": 66687.866, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.37541279196739197, "max_q": 0.13948042690753937, "min_q": -1.812583088874817}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 40500, "episodes_total": 162, "training_iteration": 27, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-56-12", "timestamp": 1579888572, "time_this_iter_s": 75.26763796806335, "time_total_s": 2068.411758184433, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2068.411758184433, "timesteps_since_restore": 40500, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 36.68411214953271, "ram_util_percent": 42.06915887850469}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -466.4133963457112, "episode_reward_mean": -358.9642717833122, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -51.82371070507891}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -39.884919087034746}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 293.42081548299393, "mean_processing_ms": 6.049701504649578, "mean_inference_ms": 0.8102130784366363}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 28, "num_steps_trained": 105000, "num_steps_sampled": 42000, "sample_time_ms": 74369.981, "replay_time_ms": 294.09, "grad_time_ms": 74.603, "update_time_ms": 6.266, "opt_peak_throughput": 67021.297, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3839748203754425, "max_q": 0.12691272795200348, "min_q": -1.775995135307312}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 42000, "episodes_total": 168, "training_iteration": 28, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-57-26", "timestamp": 1579888646, "time_this_iter_s": 74.48401284217834, "time_total_s": 2142.8957710266113, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2142.8957710266113, "timesteps_since_restore": 42000, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 36.645714285714284, "ram_util_percent": 42.12000000000001}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -466.4133963457112, "episode_reward_mean": -353.39441642501197, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -51.82371070507891}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -39.26604626944583}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 292.95388633786456, "mean_processing_ms": 6.048309468631641, "mean_inference_ms": 0.8083854689470205}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 29, "num_steps_trained": 110000, "num_steps_sampled": 43500, "sample_time_ms": 74346.941, "replay_time_ms": 296.396, "grad_time_ms": 74.238, "update_time_ms": 6.244, "opt_peak_throughput": 67350.723, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4020588994026184, "max_q": 0.06963302195072174, "min_q": -1.7569143772125244}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 43500, "episodes_total": 174, "training_iteration": 29, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-58-40", "timestamp": 1579888720, "time_this_iter_s": 74.10118126869202, "time_total_s": 2216.9969522953033, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2216.9969522953033, "timesteps_since_restore": 43500, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.42547169811321, "ram_util_percent": 42.33207547169811}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.033615758075, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78151286200837}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 292.5413253945584, "mean_processing_ms": 6.046994089184194, "mean_inference_ms": 0.8067733488451438}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 30, "num_steps_trained": 115000, "num_steps_sampled": 45000, "sample_time_ms": 74248.609, "replay_time_ms": 295.066, "grad_time_ms": 74.91, "update_time_ms": 6.286, "opt_peak_throughput": 66746.978, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.434171199798584, "max_q": 0.014329954981803894, "min_q": -1.875540852546692}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 45000, "episodes_total": 180, "training_iteration": 30, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_18-59-55", "timestamp": 1579888795, "time_this_iter_s": 74.56773924827576, "time_total_s": 2291.564691543579, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2291.564691543579, "timesteps_since_restore": 45000, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 37.17333333333333, "ram_util_percent": 42.42571428571428}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 292.1702682389073, "mean_processing_ms": 6.046431340103356, "mean_inference_ms": 0.8053292993187664}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 31, "num_steps_trained": 120000, "num_steps_sampled": 46500, "sample_time_ms": 74241.773, "replay_time_ms": 295.362, "grad_time_ms": 74.624, "update_time_ms": 6.267, "opt_peak_throughput": 67002.625, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4373495578765869, "max_q": 0.038420192897319794, "min_q": -1.9827829599380493}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 46500, "episodes_total": 186, "training_iteration": 31, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-01-10", "timestamp": 1579888870, "time_this_iter_s": 75.1879608631134, "time_total_s": 2366.7526524066925, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2366.7526524066925, "timesteps_since_restore": 46500, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.79158878504673, "ram_util_percent": 42.587850467289734}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.8306094917752, "mean_processing_ms": 6.046398791062705, "mean_inference_ms": 0.804003360949311}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 32, "num_steps_trained": 125000, "num_steps_sampled": 48000, "sample_time_ms": 74247.133, "replay_time_ms": 298.145, "grad_time_ms": 74.435, "update_time_ms": 6.245, "opt_peak_throughput": 67172.576, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.4198746979236603, "max_q": 0.039468903094530106, "min_q": -1.8322449922561646}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 48000, "episodes_total": 192, "training_iteration": 32, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-02-26", "timestamp": 1579888946, "time_this_iter_s": 75.27482008934021, "time_total_s": 2442.0274724960327, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2442.0274724960327, "timesteps_since_restore": 48000, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 37.40093457943925, "ram_util_percent": 42.654205607476634}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.5135759693799, "mean_processing_ms": 6.046856521701016, "mean_inference_ms": 0.8027814408072278}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 33, "num_steps_trained": 130000, "num_steps_sampled": 49500, "sample_time_ms": 74339.348, "replay_time_ms": 298.381, "grad_time_ms": 73.977, "update_time_ms": 6.28, "opt_peak_throughput": 67588.537, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.38686585426330566, "max_q": 0.06296508759260178, "min_q": -1.964577555656433}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 49500, "episodes_total": 198, "training_iteration": 33, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-03-41", "timestamp": 1579889021, "time_this_iter_s": 75.0172061920166, "time_total_s": 2517.0446786880493, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2517.0446786880493, "timesteps_since_restore": 49500, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 36.99056603773585, "ram_util_percent": 42.75660377358491}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.21607857390364, "mean_processing_ms": 6.046754736469476, "mean_inference_ms": 0.8016298516560693}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 34, "num_steps_trained": 135000, "num_steps_sampled": 51000, "sample_time_ms": 74360.659, "replay_time_ms": 297.168, "grad_time_ms": 73.543, "update_time_ms": 6.273, "opt_peak_throughput": 67987.193, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3747235834598541, "max_q": 0.07875148952007294, "min_q": -2.000443935394287}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 51000, "episodes_total": 204, "training_iteration": 34, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-04-54", "timestamp": 1579889094, "time_this_iter_s": 73.74391794204712, "time_total_s": 2590.7885966300964, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2590.7885966300964, "timesteps_since_restore": 51000, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 34.93904761904762, "ram_util_percent": 42.935238095238084}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.95340855183537, "mean_processing_ms": 6.046237997669458, "mean_inference_ms": 0.8005988837399465}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 35, "num_steps_trained": 140000, "num_steps_sampled": 52500, "sample_time_ms": 74406.697, "replay_time_ms": 298.436, "grad_time_ms": 72.681, "update_time_ms": 6.294, "opt_peak_throughput": 68793.704, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3665086328983307, "max_q": 0.026859914883971214, "min_q": -1.8665320873260498}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 52500, "episodes_total": 210, "training_iteration": 35, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-06-10", "timestamp": 1579889170, "time_this_iter_s": 75.12099003791809, "time_total_s": 2665.9095866680145, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2665.9095866680145, "timesteps_since_restore": 52500, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 34.83490566037736, "ram_util_percent": 43.065094339622654}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.71808287195336, "mean_processing_ms": 6.045608003535478, "mean_inference_ms": 0.7996735673159511}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 36, "num_steps_trained": 145000, "num_steps_sampled": 54000, "sample_time_ms": 74430.869, "replay_time_ms": 299.919, "grad_time_ms": 72.778, "update_time_ms": 6.44, "opt_peak_throughput": 68701.845, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.374429851770401, "max_q": 0.07675968110561371, "min_q": -2.066439151763916}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 54000, "episodes_total": 216, "training_iteration": 36, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-07-25", "timestamp": 1579889245, "time_this_iter_s": 75.49531698226929, "time_total_s": 2741.404903650284, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2741.404903650284, "timesteps_since_restore": 54000, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 37.004629629629626, "ram_util_percent": 43.196296296296296}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.4972035148983, "mean_processing_ms": 6.044292750080142, "mean_inference_ms": 0.7988121253353826}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 37, "num_steps_trained": 150000, "num_steps_sampled": 55500, "sample_time_ms": 74417.448, "replay_time_ms": 299.872, "grad_time_ms": 73.004, "update_time_ms": 6.374, "opt_peak_throughput": 68489.123, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3699507713317871, "max_q": 0.02307867258787155, "min_q": -2.1636345386505127}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 55500, "episodes_total": 222, "training_iteration": 37, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-08-40", "timestamp": 1579889320, "time_this_iter_s": 75.13032698631287, "time_total_s": 2816.5352306365967, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2816.5352306365967, "timesteps_since_restore": 55500, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 37.35, "ram_util_percent": 43.31132075471698}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.2811735809827, "mean_processing_ms": 6.043193669739691, "mean_inference_ms": 0.7979810148850228}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 38, "num_steps_trained": 155000, "num_steps_sampled": 57000, "sample_time_ms": 74379.935, "replay_time_ms": 299.375, "grad_time_ms": 74.159, "update_time_ms": 6.345, "opt_peak_throughput": 67422.676, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3591378629207611, "max_q": 0.008602697402238846, "min_q": -2.173083543777466}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 57000, "episodes_total": 228, "training_iteration": 38, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-09-54", "timestamp": 1579889394, "time_this_iter_s": 74.11485314369202, "time_total_s": 2890.6500837802887, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2890.6500837802887, "timesteps_since_restore": 57000, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 35.81809523809523, "ram_util_percent": 43.44857142857143}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.07194862391725, "mean_processing_ms": 6.042193571917383, "mean_inference_ms": 0.797184498339952}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 39, "num_steps_trained": 160000, "num_steps_sampled": 58500, "sample_time_ms": 74340.499, "replay_time_ms": 296.933, "grad_time_ms": 73.09, "update_time_ms": 6.317, "opt_peak_throughput": 68408.449, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34932875633239746, "max_q": 0.025982137769460678, "min_q": -2.1769919395446777}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 58500, "episodes_total": 234, "training_iteration": 39, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-11-08", "timestamp": 1579889468, "time_this_iter_s": 73.67211270332336, "time_total_s": 2964.322196483612, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 2964.322196483612, "timesteps_since_restore": 58500, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 34.6552380952381, "ram_util_percent": 43.52761904761904}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.9072088629947, "mean_processing_ms": 6.041620039955351, "mean_inference_ms": 0.796555186765866}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 40, "num_steps_trained": 165000, "num_steps_sampled": 60000, "sample_time_ms": 74730.569, "replay_time_ms": 306.905, "grad_time_ms": 74.182, "update_time_ms": 6.369, "opt_peak_throughput": 67402.198, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.35526734590530396, "max_q": 0.006490614265203476, "min_q": -2.2023508548736572}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 60000, "episodes_total": 240, "training_iteration": 40, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-12-27", "timestamp": 1579889547, "time_this_iter_s": 78.58066582679749, "time_total_s": 3042.9028623104095, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3042.9028623104095, "timesteps_since_restore": 60000, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 40.72232142857143, "ram_util_percent": 43.73303571428572}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.77503770949016, "mean_processing_ms": 6.040995141601395, "mean_inference_ms": 0.796033763827257}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 41, "num_steps_trained": 170000, "num_steps_sampled": 61500, "sample_time_ms": 74910.426, "replay_time_ms": 306.834, "grad_time_ms": 74.346, "update_time_ms": 6.32, "opt_peak_throughput": 67253.141, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3628608286380768, "max_q": 0.012567514553666115, "min_q": -2.4321699142456055}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 61500, "episodes_total": 246, "training_iteration": 41, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-13-44", "timestamp": 1579889624, "time_this_iter_s": 76.98698210716248, "time_total_s": 3119.889844417572, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3119.889844417572, "timesteps_since_restore": 61500, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.417431192660544, "ram_util_percent": 43.74770642201835}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.65242284736087, "mean_processing_ms": 6.041278009821063, "mean_inference_ms": 0.7955367530833323}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 42, "num_steps_trained": 175000, "num_steps_sampled": 63000, "sample_time_ms": 74904.526, "replay_time_ms": 306.41, "grad_time_ms": 73.472, "update_time_ms": 6.338, "opt_peak_throughput": 68052.695, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3639167547225952, "max_q": -0.04422631859779358, "min_q": -2.4152684211730957}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 63000, "episodes_total": 252, "training_iteration": 42, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-14-59", "timestamp": 1579889699, "time_this_iter_s": 75.20572996139526, "time_total_s": 3195.0955743789673, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3195.0955743789673, "timesteps_since_restore": 63000, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.702803738317755, "ram_util_percent": 43.846728971962605}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.52492976764586, "mean_processing_ms": 6.041558702936693, "mean_inference_ms": 0.7950411198051015}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 43, "num_steps_trained": 180000, "num_steps_sampled": 64500, "sample_time_ms": 74753.282, "replay_time_ms": 306.415, "grad_time_ms": 73.105, "update_time_ms": 6.288, "opt_peak_throughput": 68394.818, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.37763383984565735, "max_q": -0.05572810769081116, "min_q": -2.475543737411499}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 64500, "episodes_total": 258, "training_iteration": 43, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-16-12", "timestamp": 1579889772, "time_this_iter_s": 73.50057697296143, "time_total_s": 3268.5961513519287, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3268.5961513519287, "timesteps_since_restore": 64500, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 36.08557692307692, "ram_util_percent": 43.9076923076923}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.40023155837866, "mean_processing_ms": 6.041747711879334, "mean_inference_ms": 0.7945599557752882}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 44, "num_steps_trained": 185000, "num_steps_sampled": 66000, "sample_time_ms": 74816.069, "replay_time_ms": 308.41, "grad_time_ms": 73.601, "update_time_ms": 6.305, "opt_peak_throughput": 67934.117, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3837440311908722, "max_q": -0.05993499606847763, "min_q": -2.419658660888672}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 66000, "episodes_total": 264, "training_iteration": 44, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-17-27", "timestamp": 1579889847, "time_this_iter_s": 74.39724516868591, "time_total_s": 3342.9933965206146, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3342.9933965206146, "timesteps_since_restore": 66000, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 35.58018867924528, "ram_util_percent": 44.01320754716981}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.29061389777945, "mean_processing_ms": 6.041544476877942, "mean_inference_ms": 0.7941370719380554}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 45, "num_steps_trained": 190000, "num_steps_sampled": 67500, "sample_time_ms": 74835.324, "replay_time_ms": 307.459, "grad_time_ms": 72.937, "update_time_ms": 6.313, "opt_peak_throughput": 68552.279, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3797033727169037, "max_q": -0.04776044934988022, "min_q": -2.455122232437134}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 67500, "episodes_total": 270, "training_iteration": 45, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-18-42", "timestamp": 1579889922, "time_this_iter_s": 75.29769015312195, "time_total_s": 3418.2910866737366, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3418.2910866737366, "timesteps_since_restore": 67500, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 36.91792452830189, "ram_util_percent": 44.15849056603775}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.19824787298563, "mean_processing_ms": 6.04110632829624, "mean_inference_ms": 0.7937757428462089}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 46, "num_steps_trained": 195000, "num_steps_sampled": 69000, "sample_time_ms": 74859.738, "replay_time_ms": 305.946, "grad_time_ms": 72.76, "update_time_ms": 6.269, "opt_peak_throughput": 68719.405, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3765000104904175, "max_q": -0.06025838106870651, "min_q": -2.61398983001709}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 69000, "episodes_total": 276, "training_iteration": 46, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-19-58", "timestamp": 1579889998, "time_this_iter_s": 75.72306394577026, "time_total_s": 3494.014150619507, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3494.014150619507, "timesteps_since_restore": 69000, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 38.36018518518518, "ram_util_percent": 44.295370370370364}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1083678797535, "mean_processing_ms": 6.040654855308805, "mean_inference_ms": 0.7934338012150479}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 47, "num_steps_trained": 200000, "num_steps_sampled": 70500, "sample_time_ms": 74759.673, "replay_time_ms": 307.608, "grad_time_ms": 73.629, "update_time_ms": 6.322, "opt_peak_throughput": 67908.247, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3734549880027771, "max_q": -0.03373003751039505, "min_q": -2.657219171524048}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 70500, "episodes_total": 282, "training_iteration": 47, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-21-12", "timestamp": 1579890072, "time_this_iter_s": 74.15660500526428, "time_total_s": 3568.170755624771, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3568.170755624771, "timesteps_since_restore": 70500, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.827619047619045, "ram_util_percent": 44.44571428571429}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.01500018809236, "mean_processing_ms": 6.040678636081826, "mean_inference_ms": 0.7930922442503789}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 48, "num_steps_trained": 205000, "num_steps_sampled": 72000, "sample_time_ms": 74732.196, "replay_time_ms": 308.683, "grad_time_ms": 72.108, "update_time_ms": 6.32, "opt_peak_throughput": 69340.382, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.36278262734413147, "max_q": -0.021179599687457085, "min_q": -2.4671530723571777}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 72000, "episodes_total": 288, "training_iteration": 48, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-22-26", "timestamp": 1579890146, "time_this_iter_s": 73.83519387245178, "time_total_s": 3642.005949497223, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3642.005949497223, "timesteps_since_restore": 72000, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 34.80285714285714, "ram_util_percent": 44.632380952380956}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9532244759171, "mean_processing_ms": 6.040782843258814, "mean_inference_ms": 0.792861912490913}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 49, "num_steps_trained": 210000, "num_steps_sampled": 73500, "sample_time_ms": 75448.809, "replay_time_ms": 309.871, "grad_time_ms": 72.904, "update_time_ms": 6.387, "opt_peak_throughput": 68582.88, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3659519851207733, "max_q": -0.06275811046361923, "min_q": -2.4919426441192627}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 73500, "episodes_total": 294, "training_iteration": 49, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-23-47", "timestamp": 1579890227, "time_this_iter_s": 80.85835886001587, "time_total_s": 3722.8643083572388, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3722.8643083572388, "timesteps_since_restore": 73500, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 41.96956521739131, "ram_util_percent": 45.01130434782609}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9530386130409, "mean_processing_ms": 6.0408145017671835, "mean_inference_ms": 0.7928362902298202}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 50, "num_steps_trained": 215000, "num_steps_sampled": 75000, "sample_time_ms": 76241.987, "replay_time_ms": 300.902, "grad_time_ms": 72.545, "update_time_ms": 6.329, "opt_peak_throughput": 68923.006, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3629158139228821, "max_q": -0.06429295241832733, "min_q": -2.5945181846618652}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 75000, "episodes_total": 300, "training_iteration": 50, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-25-13", "timestamp": 1579890313, "time_this_iter_s": 86.41703796386719, "time_total_s": 3809.281346321106, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3809.281346321106, "timesteps_since_restore": 75000, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 48.14390243902439, "ram_util_percent": 45.70731707317074}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.97408822664124, "mean_processing_ms": 6.041383201591361, "mean_inference_ms": 0.7928639518201431}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 51, "num_steps_trained": 220000, "num_steps_sampled": 76500, "sample_time_ms": 76319.403, "replay_time_ms": 303.988, "grad_time_ms": 73.085, "update_time_ms": 6.355, "opt_peak_throughput": 68413.671, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3468005359172821, "max_q": -0.0684046819806099, "min_q": -2.4025001525878906}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 76500, "episodes_total": 306, "training_iteration": 51, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-26-31", "timestamp": 1579890391, "time_this_iter_s": 77.79624319076538, "time_total_s": 3887.0775895118713, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3887.0775895118713, "timesteps_since_restore": 76500, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 38.42272727272727, "ram_util_percent": 45.82363636363635}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.00292807791675, "mean_processing_ms": 6.04192292402681, "mean_inference_ms": 0.7929193476191333}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 52, "num_steps_trained": 225000, "num_steps_sampled": 78000, "sample_time_ms": 76478.459, "replay_time_ms": 304.178, "grad_time_ms": 73.73, "update_time_ms": 6.343, "opt_peak_throughput": 67814.833, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3415224254131317, "max_q": -0.00919794850051403, "min_q": -2.4474644660949707}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 78000, "episodes_total": 312, "training_iteration": 52, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-27-48", "timestamp": 1579890468, "time_this_iter_s": 76.80125379562378, "time_total_s": 3963.878843307495, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 3963.878843307495, "timesteps_since_restore": 78000, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 39.04678899082569, "ram_util_percent": 46.10550458715597}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.04152885191394, "mean_processing_ms": 6.0427326103097245, "mean_inference_ms": 0.7929873653456256}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 53, "num_steps_trained": 230000, "num_steps_sampled": 79500, "sample_time_ms": 76891.651, "replay_time_ms": 302.086, "grad_time_ms": 72.759, "update_time_ms": 6.349, "opt_peak_throughput": 68719.653, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34918150305747986, "max_q": -0.062324244529008865, "min_q": -2.3895411491394043}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 79500, "episodes_total": 318, "training_iteration": 53, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-29-06", "timestamp": 1579890546, "time_this_iter_s": 77.60330700874329, "time_total_s": 4041.4821503162384, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4041.4821503162384, "timesteps_since_restore": 79500, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 40.27090909090909, "ram_util_percent": 46.32363636363637}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0901292863661, "mean_processing_ms": 6.043924247551242, "mean_inference_ms": 0.7930767762138646}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 54, "num_steps_trained": 235000, "num_steps_sampled": 81000, "sample_time_ms": 77146.364, "replay_time_ms": 301.633, "grad_time_ms": 72.372, "update_time_ms": 6.333, "opt_peak_throughput": 69087.372, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3620959520339966, "max_q": -0.0456814281642437, "min_q": -2.497014045715332}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 81000, "episodes_total": 324, "training_iteration": 54, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-30-22", "timestamp": 1579890622, "time_this_iter_s": 76.93575692176819, "time_total_s": 4118.417907238007, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4118.417907238007, "timesteps_since_restore": 81000, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 40.165454545454544, "ram_util_percent": 46.41909090909089}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1494796912182, "mean_processing_ms": 6.045146320673067, "mean_inference_ms": 0.7931990034392022}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 55, "num_steps_trained": 240000, "num_steps_sampled": 82500, "sample_time_ms": 77220.564, "replay_time_ms": 304.024, "grad_time_ms": 73.449, "update_time_ms": 6.324, "opt_peak_throughput": 68074.785, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.363910973072052, "max_q": -0.07413262128829956, "min_q": -2.4790587425231934}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 82500, "episodes_total": 330, "training_iteration": 55, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-31-39", "timestamp": 1579890699, "time_this_iter_s": 76.07402515411377, "time_total_s": 4194.49193239212, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4194.49193239212, "timesteps_since_restore": 82500, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 38.73796296296296, "ram_util_percent": 46.47777777777778}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.2213478029266, "mean_processing_ms": 6.0463816571092295, "mean_inference_ms": 0.7933846083770577}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 56, "num_steps_trained": 245000, "num_steps_sampled": 84000, "sample_time_ms": 77468.583, "replay_time_ms": 307.551, "grad_time_ms": 74.549, "update_time_ms": 6.358, "opt_peak_throughput": 67070.167, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.35744789242744446, "max_q": -0.07832834124565125, "min_q": -2.5876448154449463}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 84000, "episodes_total": 336, "training_iteration": 56, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-32-57", "timestamp": 1579890777, "time_this_iter_s": 78.24813294410706, "time_total_s": 4272.740065336227, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4272.740065336227, "timesteps_since_restore": 84000, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 39.25765765765766, "ram_util_percent": 46.644144144144164}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.29592847217043, "mean_processing_ms": 6.047780105498256, "mean_inference_ms": 0.7935543404918535}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 57, "num_steps_trained": 250000, "num_steps_sampled": 85500, "sample_time_ms": 78019.382, "replay_time_ms": 306.419, "grad_time_ms": 73.42, "update_time_ms": 6.31, "opt_peak_throughput": 68101.733, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3565085530281067, "max_q": -0.03409205377101898, "min_q": -2.4079749584198}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 85500, "episodes_total": 342, "training_iteration": 57, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-34-16", "timestamp": 1579890856, "time_this_iter_s": 79.64409494400024, "time_total_s": 4352.384160280228, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4352.384160280228, "timesteps_since_restore": 85500, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 41.20265486725664, "ram_util_percent": 47.01681415929204}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.3723907482298, "mean_processing_ms": 6.049527804728037, "mean_inference_ms": 0.7937334581917765}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 58, "num_steps_trained": 255000, "num_steps_sampled": 87000, "sample_time_ms": 78386.069, "replay_time_ms": 305.892, "grad_time_ms": 73.962, "update_time_ms": 6.34, "opt_peak_throughput": 67602.612, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.35730382800102234, "max_q": -0.03825199604034424, "min_q": -2.5007143020629883}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 87000, "episodes_total": 348, "training_iteration": 58, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-35-34", "timestamp": 1579890934, "time_this_iter_s": 77.50293493270874, "time_total_s": 4429.887095212936, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4429.887095212936, "timesteps_since_restore": 87000, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 39.93909090909091, "ram_util_percent": 47.166363636363656}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.4566151100029, "mean_processing_ms": 6.0512972522038355, "mean_inference_ms": 0.7939291661476128}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 59, "num_steps_trained": 260000, "num_steps_sampled": 88500, "sample_time_ms": 77929.528, "replay_time_ms": 310.261, "grad_time_ms": 74.484, "update_time_ms": 6.288, "opt_peak_throughput": 67128.218, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.37327998876571655, "max_q": -0.11784607172012329, "min_q": -2.5180697441101074}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 88500, "episodes_total": 354, "training_iteration": 59, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-36-50", "timestamp": 1579891010, "time_this_iter_s": 76.34092593193054, "time_total_s": 4506.228021144867, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4506.228021144867, "timesteps_since_restore": 88500, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 37.0574074074074, "ram_util_percent": 47.18240740740742}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.55515772188886, "mean_processing_ms": 6.053055784380612, "mean_inference_ms": 0.7941612598550748}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 60, "num_steps_trained": 265000, "num_steps_sampled": 90000, "sample_time_ms": 76964.69, "replay_time_ms": 310.048, "grad_time_ms": 74.36, "update_time_ms": 6.283, "opt_peak_throughput": 67240.677, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.36092013120651245, "max_q": -0.11421778053045273, "min_q": -2.4523682594299316}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 90000, "episodes_total": 360, "training_iteration": 60, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-38-07", "timestamp": 1579891087, "time_this_iter_s": 76.7647659778595, "time_total_s": 4582.992787122726, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4582.992787122726, "timesteps_since_restore": 90000, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 39.65137614678899, "ram_util_percent": 47.32201834862384}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.6665118427497, "mean_processing_ms": 6.0546979945109385, "mean_inference_ms": 0.7944262799608485}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 61, "num_steps_trained": 270000, "num_steps_sampled": 91500, "sample_time_ms": 76971.541, "replay_time_ms": 306.669, "grad_time_ms": 73.999, "update_time_ms": 6.206, "opt_peak_throughput": 67568.503, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34913331270217896, "max_q": -0.08428529649972916, "min_q": -2.604090690612793}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 91500, "episodes_total": 366, "training_iteration": 61, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-39-25", "timestamp": 1579891165, "time_this_iter_s": 77.82715606689453, "time_total_s": 4660.819943189621, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4660.819943189621, "timesteps_since_restore": 91500, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 41.381818181818176, "ram_util_percent": 47.40636363636361}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.7817860837466, "mean_processing_ms": 6.05649211495672, "mean_inference_ms": 0.7946937486125687}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 62, "num_steps_trained": 275000, "num_steps_sampled": 93000, "sample_time_ms": 76991.463, "replay_time_ms": 306.817, "grad_time_ms": 74.419, "update_time_ms": 6.215, "opt_peak_throughput": 67187.425, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34764429926872253, "max_q": -0.08400002866983414, "min_q": -2.4868555068969727}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 93000, "episodes_total": 372, "training_iteration": 62, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-40-42", "timestamp": 1579891242, "time_this_iter_s": 77.00690078735352, "time_total_s": 4737.8268439769745, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4737.8268439769745, "timesteps_since_restore": 93000, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 40.120909090909095, "ram_util_percent": 47.49}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.8986298716505, "mean_processing_ms": 6.058439029438155, "mean_inference_ms": 0.7949599198437645}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 63, "num_steps_trained": 280000, "num_steps_sampled": 94500, "sample_time_ms": 76820.125, "replay_time_ms": 307.507, "grad_time_ms": 75.737, "update_time_ms": 6.222, "opt_peak_throughput": 66017.578, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3553462028503418, "max_q": -0.05042214319109917, "min_q": -2.5682172775268555}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 94500, "episodes_total": 378, "training_iteration": 63, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-41-58", "timestamp": 1579891318, "time_this_iter_s": 75.91124081611633, "time_total_s": 4813.738084793091, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4813.738084793091, "timesteps_since_restore": 94500, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.13084112149532, "ram_util_percent": 47.61869158878506}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.02749480223713, "mean_processing_ms": 6.0605065823271556, "mean_inference_ms": 0.795258769846664}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 64, "num_steps_trained": 285000, "num_steps_sampled": 96000, "sample_time_ms": 76843.174, "replay_time_ms": 306.832, "grad_time_ms": 74.563, "update_time_ms": 6.205, "opt_peak_throughput": 67057.75, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3603871464729309, "max_q": -0.10351170599460602, "min_q": -2.584014892578125}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 96000, "episodes_total": 384, "training_iteration": 64, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-43-15", "timestamp": 1579891395, "time_this_iter_s": 77.14724898338318, "time_total_s": 4890.885333776474, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4890.885333776474, "timesteps_since_restore": 96000, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 39.00454545454547, "ram_util_percent": 47.70909090909091}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.1601340212081, "mean_processing_ms": 6.062448057888455, "mean_inference_ms": 0.7955593477266903}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 65, "num_steps_trained": 290000, "num_steps_sampled": 97500, "sample_time_ms": 76996.302, "replay_time_ms": 303.622, "grad_time_ms": 74.041, "update_time_ms": 6.195, "opt_peak_throughput": 67530.34, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3514661490917206, "max_q": -0.08565787971019745, "min_q": -2.4955317974090576}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 97500, "episodes_total": 390, "training_iteration": 65, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-44-33", "timestamp": 1579891473, "time_this_iter_s": 77.5676212310791, "time_total_s": 4968.452955007553, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 4968.452955007553, "timesteps_since_restore": 97500, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 40.59, "ram_util_percent": 47.87181818181818}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.2590808596605, "mean_processing_ms": 6.06430340206273, "mean_inference_ms": 0.7957456553202522}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 66, "num_steps_trained": 295000, "num_steps_sampled": 99000, "sample_time_ms": 76797.274, "replay_time_ms": 301.892, "grad_time_ms": 73.786, "update_time_ms": 6.201, "opt_peak_throughput": 67763.886, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3380671739578247, "max_q": -0.051503051072359085, "min_q": -2.3947973251342773}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 99000, "episodes_total": 396, "training_iteration": 66, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-45-49", "timestamp": 1579891549, "time_this_iter_s": 76.23967432975769, "time_total_s": 5044.692629337311, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5044.692629337311, "timesteps_since_restore": 99000, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 37.49074074074074, "ram_util_percent": 47.91203703703704}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.32225155349215, "mean_processing_ms": 6.066179926587897, "mean_inference_ms": 0.7958087085604073}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 67, "num_steps_trained": 300000, "num_steps_sampled": 100500, "sample_time_ms": 76472.785, "replay_time_ms": 303.173, "grad_time_ms": 75.131, "update_time_ms": 6.216, "opt_peak_throughput": 66550.31, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34901249408721924, "max_q": -0.030746351927518845, "min_q": -2.454127550125122}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 100500, "episodes_total": 402, "training_iteration": 67, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-47-05", "timestamp": 1579891625, "time_this_iter_s": 76.42252111434937, "time_total_s": 5121.11515045166, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5121.11515045166, "timesteps_since_restore": 100500, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 36.79266055045871, "ram_util_percent": 48.03761467889909}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.38488276028716, "mean_processing_ms": 6.068136438312456, "mean_inference_ms": 0.7958820464354983}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 68, "num_steps_trained": 305000, "num_steps_sampled": 102000, "sample_time_ms": 76515.323, "replay_time_ms": 300.955, "grad_time_ms": 74.542, "update_time_ms": 6.174, "opt_peak_throughput": 67076.41, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.36123448610305786, "max_q": -0.0925293043255806, "min_q": -2.504578113555908}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 102000, "episodes_total": 408, "training_iteration": 68, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-48-23", "timestamp": 1579891703, "time_this_iter_s": 77.90019392967224, "time_total_s": 5199.015344381332, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5199.015344381332, "timesteps_since_restore": 102000, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 40.408181818181816, "ram_util_percent": 48.09727272727276}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.44594934718907, "mean_processing_ms": 6.070187353048343, "mean_inference_ms": 0.7959524090121927}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 69, "num_steps_trained": 310000, "num_steps_sampled": 103500, "sample_time_ms": 76602.805, "replay_time_ms": 298.299, "grad_time_ms": 74.835, "update_time_ms": 6.201, "opt_peak_throughput": 66813.601, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3643866777420044, "max_q": -0.036042094230651855, "min_q": -2.5616464614868164}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 103500, "episodes_total": 414, "training_iteration": 69, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-49-41", "timestamp": 1579891781, "time_this_iter_s": 77.1922459602356, "time_total_s": 5276.207590341568, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5276.207590341568, "timesteps_since_restore": 103500, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 38.415454545454544, "ram_util_percent": 48.21909090909092}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.50013015779933, "mean_processing_ms": 6.071813141381398, "mean_inference_ms": 0.7960141144899702}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 70, "num_steps_trained": 315000, "num_steps_sampled": 105000, "sample_time_ms": 76522.084, "replay_time_ms": 297.704, "grad_time_ms": 74.778, "update_time_ms": 6.205, "opt_peak_throughput": 66864.557, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.36216244101524353, "max_q": -0.04834596812725067, "min_q": -2.644162178039551}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 105000, "episodes_total": 420, "training_iteration": 70, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-50-57", "timestamp": 1579891857, "time_this_iter_s": 75.9510772228241, "time_total_s": 5352.158667564392, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5352.158667564392, "timesteps_since_restore": 105000, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 38.775000000000006, "ram_util_percent": 48.31388888888888}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.555423705906, "mean_processing_ms": 6.073255934071949, "mean_inference_ms": 0.796082926490206}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 71, "num_steps_trained": 320000, "num_steps_sampled": 106500, "sample_time_ms": 76477.417, "replay_time_ms": 299.777, "grad_time_ms": 75.152, "update_time_ms": 6.219, "opt_peak_throughput": 66531.393, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3516490161418915, "max_q": -0.08830634504556656, "min_q": -2.8215439319610596}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 106500, "episodes_total": 426, "training_iteration": 71, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-52-14", "timestamp": 1579891934, "time_this_iter_s": 77.43962502479553, "time_total_s": 5429.598292589188, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5429.598292589188, "timesteps_since_restore": 106500, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 39.003669724770646, "ram_util_percent": 48.41284403669724}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.61052732281127, "mean_processing_ms": 6.075013431730076, "mean_inference_ms": 0.7961596922856188}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 72, "num_steps_trained": 325000, "num_steps_sampled": 108000, "sample_time_ms": 76476.551, "replay_time_ms": 300.892, "grad_time_ms": 74.499, "update_time_ms": 6.172, "opt_peak_throughput": 67115.092, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.35245203971862793, "max_q": -0.03929954394698143, "min_q": -2.6842896938323975}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 108000, "episodes_total": 432, "training_iteration": 72, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-53-31", "timestamp": 1579892011, "time_this_iter_s": 77.00268912315369, "time_total_s": 5506.600981712341, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5506.600981712341, "timesteps_since_restore": 108000, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 39.697272727272725, "ram_util_percent": 48.52363636363638}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.6531232058423, "mean_processing_ms": 6.076863023440824, "mean_inference_ms": 0.7961637569983162}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 73, "num_steps_trained": 330000, "num_steps_sampled": 109500, "sample_time_ms": 76488.508, "replay_time_ms": 304.091, "grad_time_ms": 74.203, "update_time_ms": 6.206, "opt_peak_throughput": 67382.751, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3595384359359741, "max_q": -0.06558605283498764, "min_q": -2.723006248474121}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 109500, "episodes_total": 438, "training_iteration": 73, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-54-47", "timestamp": 1579892087, "time_this_iter_s": 76.058265209198, "time_total_s": 5582.659246921539, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5582.659246921539, "timesteps_since_restore": 109500, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 38.760185185185186, "ram_util_percent": 48.63055555555557}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.68752370479166, "mean_processing_ms": 6.0785523179761825, "mean_inference_ms": 0.7961558237299875}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 74, "num_steps_trained": 335000, "num_steps_sampled": 111000, "sample_time_ms": 76499.981, "replay_time_ms": 302.095, "grad_time_ms": 74.017, "update_time_ms": 6.233, "opt_peak_throughput": 67552.44, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.35586485266685486, "max_q": -0.08209581673145294, "min_q": -2.4877395629882812}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 111000, "episodes_total": 444, "training_iteration": 74, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-56-04", "timestamp": 1579892164, "time_this_iter_s": 77.2400119304657, "time_total_s": 5659.899258852005, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5659.899258852005, "timesteps_since_restore": 111000, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 40.043119266055044, "ram_util_percent": 48.66697247706423}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.72118232297305, "mean_processing_ms": 6.079818340090836, "mean_inference_ms": 0.7961496070282437}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 75, "num_steps_trained": 340000, "num_steps_sampled": 112500, "sample_time_ms": 76423.935, "replay_time_ms": 300.392, "grad_time_ms": 73.485, "update_time_ms": 6.228, "opt_peak_throughput": 68041.037, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34963810443878174, "max_q": -0.09153212606906891, "min_q": -2.7521119117736816}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 112500, "episodes_total": 450, "training_iteration": 75, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-57-21", "timestamp": 1579892241, "time_this_iter_s": 76.78528785705566, "time_total_s": 5736.684546709061, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5736.684546709061, "timesteps_since_restore": 112500, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 39.42752293577983, "ram_util_percent": 48.125688073394514}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.7569991601182, "mean_processing_ms": 6.080863317036404, "mean_inference_ms": 0.7961470121530083}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 76, "num_steps_trained": 345000, "num_steps_sampled": 114000, "sample_time_ms": 76518.741, "replay_time_ms": 299.671, "grad_time_ms": 73.919, "update_time_ms": 6.221, "opt_peak_throughput": 67641.686, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3372361361980438, "max_q": -0.09429458528757095, "min_q": -2.549422264099121}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 114000, "episodes_total": 456, "training_iteration": 76, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-58-38", "timestamp": 1579892318, "time_this_iter_s": 77.18394804000854, "time_total_s": 5813.868494749069, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5813.868494749069, "timesteps_since_restore": 114000, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 39.271818181818176, "ram_util_percent": 48.25727272727272}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.7900559454478, "mean_processing_ms": 6.08183403196153, "mean_inference_ms": 0.7961361062989747}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 77, "num_steps_trained": 350000, "num_steps_sampled": 115500, "sample_time_ms": 76522.902, "replay_time_ms": 296.353, "grad_time_ms": 73.121, "update_time_ms": 6.232, "opt_peak_throughput": 68379.787, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3486441969871521, "max_q": -0.12076487392187119, "min_q": -2.577324390411377}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 115500, "episodes_total": 462, "training_iteration": 77, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_19-59-55", "timestamp": 1579892395, "time_this_iter_s": 76.42260694503784, "time_total_s": 5890.291101694107, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5890.291101694107, "timesteps_since_restore": 115500, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 39.290740740740745, "ram_util_percent": 48.38148148148149}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.8201288524505, "mean_processing_ms": 6.0828918538925185, "mean_inference_ms": 0.79612394945363}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 78, "num_steps_trained": 355000, "num_steps_sampled": 117000, "sample_time_ms": 76445.956, "replay_time_ms": 299.082, "grad_time_ms": 74.42, "update_time_ms": 6.299, "opt_peak_throughput": 67185.854, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34558096528053284, "max_q": -0.11588790267705917, "min_q": -2.5599889755249023}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 117000, "episodes_total": 468, "training_iteration": 78, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-01-12", "timestamp": 1579892472, "time_this_iter_s": 77.17156982421875, "time_total_s": 5967.462671518326, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 5967.462671518326, "timesteps_since_restore": 117000, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 39.58090909090909, "ram_util_percent": 48.3881818181818}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.8520143620558, "mean_processing_ms": 6.084022040106956, "mean_inference_ms": 0.7961186689356008}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 79, "num_steps_trained": 360000, "num_steps_sampled": 118500, "sample_time_ms": 76471.533, "replay_time_ms": 298.647, "grad_time_ms": 73.622, "update_time_ms": 6.163, "opt_peak_throughput": 67914.647, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3334369659423828, "max_q": -0.10286667197942734, "min_q": -2.8045079708099365}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 118500, "episodes_total": 474, "training_iteration": 79, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-02-29", "timestamp": 1579892549, "time_this_iter_s": 77.43352508544922, "time_total_s": 6044.896196603775, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6044.896196603775, "timesteps_since_restore": 118500, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 39.42545454545455, "ram_util_percent": 48.460000000000015}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.8850106604566, "mean_processing_ms": 6.085172686467769, "mean_inference_ms": 0.7961146269096021}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 80, "num_steps_trained": 365000, "num_steps_sampled": 120000, "sample_time_ms": 76545.477, "replay_time_ms": 297.58, "grad_time_ms": 73.415, "update_time_ms": 6.186, "opt_peak_throughput": 68106.421, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33800208568573, "max_q": -0.09266187250614166, "min_q": -2.6195554733276367}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 120000, "episodes_total": 480, "training_iteration": 80, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-03-46", "timestamp": 1579892626, "time_this_iter_s": 76.67796897888184, "time_total_s": 6121.574165582657, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6121.574165582657, "timesteps_since_restore": 120000, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 39.161111111111104, "ram_util_percent": 48.69351851851853}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9134637820538, "mean_processing_ms": 6.086163829585812, "mean_inference_ms": 0.796099392400601}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 81, "num_steps_trained": 370000, "num_steps_sampled": 121500, "sample_time_ms": 76400.978, "replay_time_ms": 294.796, "grad_time_ms": 72.783, "update_time_ms": 6.237, "opt_peak_throughput": 68697.705, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3548597991466522, "max_q": -0.12196099013090134, "min_q": -2.67588210105896}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 121500, "episodes_total": 486, "training_iteration": 81, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-05-02", "timestamp": 1579892702, "time_this_iter_s": 75.92747783660889, "time_total_s": 6197.501643419266, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6197.501643419266, "timesteps_since_restore": 121500, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 38.4824074074074, "ram_util_percent": 48.73796296296295}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9381151087348, "mean_processing_ms": 6.087005904894578, "mean_inference_ms": 0.7960811256832401}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 82, "num_steps_trained": 375000, "num_steps_sampled": 123000, "sample_time_ms": 76298.222, "replay_time_ms": 290.202, "grad_time_ms": 72.791, "update_time_ms": 6.324, "opt_peak_throughput": 68690.234, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3515429198741913, "max_q": -0.11638486385345459, "min_q": -2.6228487491607666}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 123000, "episodes_total": 492, "training_iteration": 82, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-06-18", "timestamp": 1579892778, "time_this_iter_s": 75.93090319633484, "time_total_s": 6273.432546615601, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6273.432546615601, "timesteps_since_restore": 123000, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 37.54351851851852, "ram_util_percent": 48.90648148148147}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.96781293353746, "mean_processing_ms": 6.087743531945844, "mean_inference_ms": 0.7960705736683275}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 83, "num_steps_trained": 380000, "num_steps_sampled": 124500, "sample_time_ms": 76512.813, "replay_time_ms": 285.806, "grad_time_ms": 72.218, "update_time_ms": 6.364, "opt_peak_throughput": 69234.759, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3337380886077881, "max_q": -0.0961240828037262, "min_q": -2.8018012046813965}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 124500, "episodes_total": 498, "training_iteration": 83, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-07-36", "timestamp": 1579892856, "time_this_iter_s": 78.15546011924744, "time_total_s": 6351.588006734848, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6351.588006734848, "timesteps_since_restore": 124500, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.702702702702695, "ram_util_percent": 49.07117117117119}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.98757038381825, "mean_processing_ms": 6.088472537409309, "mean_inference_ms": 0.7960373329989213}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 84, "num_steps_trained": 385000, "num_steps_sampled": 126000, "sample_time_ms": 76149.777, "replay_time_ms": 287.479, "grad_time_ms": 73.775, "update_time_ms": 6.419, "opt_peak_throughput": 67773.325, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30687665939331055, "max_q": -0.08363530784845352, "min_q": -2.642753839492798}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 126000, "episodes_total": 504, "training_iteration": 84, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-08-50", "timestamp": 1579892930, "time_this_iter_s": 73.64295887947083, "time_total_s": 6425.230965614319, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6425.230965614319, "timesteps_since_restore": 126000, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 35.11730769230769, "ram_util_percent": 49.26826923076923}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.997892134985, "mean_processing_ms": 6.08893077204012, "mean_inference_ms": 0.7959801039942417}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 85, "num_steps_trained": 390000, "num_steps_sampled": 127500, "sample_time_ms": 75915.08, "replay_time_ms": 287.533, "grad_time_ms": 74.064, "update_time_ms": 6.454, "opt_peak_throughput": 67509.058, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30165809392929077, "max_q": -0.08462713658809662, "min_q": -2.4717915058135986}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 127500, "episodes_total": 510, "training_iteration": 85, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-10-04", "timestamp": 1579893004, "time_this_iter_s": 74.44189882278442, "time_total_s": 6499.672864437103, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6499.672864437103, "timesteps_since_restore": 127500, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 36.160377358490564, "ram_util_percent": 49.366981132075466}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.00535447533474, "mean_processing_ms": 6.0892558427099335, "mean_inference_ms": 0.7959235529218148}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 86, "num_steps_trained": 395000, "num_steps_sampled": 129000, "sample_time_ms": 75770.252, "replay_time_ms": 284.458, "grad_time_ms": 73.318, "update_time_ms": 6.418, "opt_peak_throughput": 68196.25, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.302045077085495, "max_q": -0.08995693176984787, "min_q": -0.9903333187103271}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 129000, "episodes_total": 516, "training_iteration": 86, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-11-20", "timestamp": 1579893080, "time_this_iter_s": 75.6970763206482, "time_total_s": 6575.3699407577515, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6575.3699407577515, "timesteps_since_restore": 129000, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 38.117757009345794, "ram_util_percent": 49.38504672897196}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0099073994866, "mean_processing_ms": 6.089397307066093, "mean_inference_ms": 0.7958603923824402}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 87, "num_steps_trained": 400000, "num_steps_sampled": 130500, "sample_time_ms": 75629.767, "replay_time_ms": 283.759, "grad_time_ms": 72.557, "update_time_ms": 6.406, "opt_peak_throughput": 68911.048, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2896972596645355, "max_q": -0.046959999948740005, "min_q": -0.9936560988426208}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 130500, "episodes_total": 522, "training_iteration": 87, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-12-35", "timestamp": 1579893155, "time_this_iter_s": 75.00337672233582, "time_total_s": 6650.373317480087, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6650.373317480087, "timesteps_since_restore": 130500, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 37.14953271028037, "ram_util_percent": 49.45046728971962}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0079819566128, "mean_processing_ms": 6.089351745346021, "mean_inference_ms": 0.7957776822686307}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 88, "num_steps_trained": 405000, "num_steps_sampled": 132000, "sample_time_ms": 75404.541, "replay_time_ms": 282.383, "grad_time_ms": 71.627, "update_time_ms": 6.442, "opt_peak_throughput": 69806.36, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29034423828125, "max_q": -0.06933269649744034, "min_q": -0.975556492805481}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 132000, "episodes_total": 528, "training_iteration": 88, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-13-50", "timestamp": 1579893230, "time_this_iter_s": 74.89776396751404, "time_total_s": 6725.271081447601, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6725.271081447601, "timesteps_since_restore": 132000, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 36.31603773584906, "ram_util_percent": 49.49905660377358}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.00199084881496, "mean_processing_ms": 6.08914397445058, "mean_inference_ms": 0.7956869142251134}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 89, "num_steps_trained": 410000, "num_steps_sampled": 133500, "sample_time_ms": 75169.252, "replay_time_ms": 282.675, "grad_time_ms": 71.695, "update_time_ms": 6.592, "opt_peak_throughput": 69739.946, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3017658293247223, "max_q": -0.08588647097349167, "min_q": -0.8828587532043457}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 133500, "episodes_total": 534, "training_iteration": 89, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-15-05", "timestamp": 1579893305, "time_this_iter_s": 75.08678698539734, "time_total_s": 6800.357868432999, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6800.357868432999, "timesteps_since_restore": 133500, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 37.40560747663552, "ram_util_percent": 49.58691588785049}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0002595654964, "mean_processing_ms": 6.088964445479961, "mean_inference_ms": 0.7956061591931416}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 90, "num_steps_trained": 415000, "num_steps_sampled": 135000, "sample_time_ms": 75283.562, "replay_time_ms": 280.545, "grad_time_ms": 71.681, "update_time_ms": 6.591, "opt_peak_throughput": 69753.655, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29720786213874817, "max_q": -0.08323998004198074, "min_q": -0.9123665690422058}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 135000, "episodes_total": 540, "training_iteration": 90, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-16-23", "timestamp": 1579893383, "time_this_iter_s": 77.7997179031372, "time_total_s": 6878.157586336136, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6878.157586336136, "timesteps_since_restore": 135000, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 40.30454545454545, "ram_util_percent": 49.69272727272726}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.99852039755865, "mean_processing_ms": 6.088702843461459, "mean_inference_ms": 0.7955289705582949}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 91, "num_steps_trained": 420000, "num_steps_sampled": 136500, "sample_time_ms": 75430.742, "replay_time_ms": 283.156, "grad_time_ms": 72.351, "update_time_ms": 6.508, "opt_peak_throughput": 69107.52, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.291648268699646, "max_q": -0.07290556281805038, "min_q": -0.9275258183479309}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 136500, "episodes_total": 546, "training_iteration": 91, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-17-40", "timestamp": 1579893460, "time_this_iter_s": 77.43043804168701, "time_total_s": 6955.588024377823, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 6955.588024377823, "timesteps_since_restore": 136500, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 39.81272727272727, "ram_util_percent": 49.77272727272727}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9964870208171, "mean_processing_ms": 6.08857937274557, "mean_inference_ms": 0.7954545999663756}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 92, "num_steps_trained": 425000, "num_steps_sampled": 138000, "sample_time_ms": 75537.488, "replay_time_ms": 285.514, "grad_time_ms": 72.163, "update_time_ms": 6.45, "opt_peak_throughput": 69287.942, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29495543241500854, "max_q": -0.09651775658130646, "min_q": -0.8681612014770508}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 138000, "episodes_total": 552, "training_iteration": 92, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-18-57", "timestamp": 1579893537, "time_this_iter_s": 77.01804804801941, "time_total_s": 7032.606072425842, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7032.606072425842, "timesteps_since_restore": 138000, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 38.94587155963302, "ram_util_percent": 49.83761467889907}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.99220908982073, "mean_processing_ms": 6.088487333734547, "mean_inference_ms": 0.7953794503409911}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 93, "num_steps_trained": 430000, "num_steps_sampled": 139500, "sample_time_ms": 75349.609, "replay_time_ms": 284.134, "grad_time_ms": 72.135, "update_time_ms": 6.388, "opt_peak_throughput": 69314.347, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3054535686969757, "max_q": -0.07658245414495468, "min_q": -0.8791218996047974}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 139500, "episodes_total": 558, "training_iteration": 93, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-20-14", "timestamp": 1579893614, "time_this_iter_s": 76.26202273368835, "time_total_s": 7108.868095159531, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7108.868095159531, "timesteps_since_restore": 139500, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 38.08990825688073, "ram_util_percent": 49.91559633027521}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9886839870994, "mean_processing_ms": 6.088370341168038, "mean_inference_ms": 0.7953126932240121}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 94, "num_steps_trained": 435000, "num_steps_sampled": 141000, "sample_time_ms": 75702.584, "replay_time_ms": 281.149, "grad_time_ms": 70.963, "update_time_ms": 6.362, "opt_peak_throughput": 70458.802, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30273258686065674, "max_q": -0.09166645258665085, "min_q": -0.7764153480529785}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 141000, "episodes_total": 564, "training_iteration": 94, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-21-31", "timestamp": 1579893691, "time_this_iter_s": 77.13133120536804, "time_total_s": 7185.999426364899, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7185.999426364899, "timesteps_since_restore": 141000, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 40.636697247706415, "ram_util_percent": 49.921100917431176}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.98544069780297, "mean_processing_ms": 6.088454565635653, "mean_inference_ms": 0.795245028332063}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 95, "num_steps_trained": 440000, "num_steps_sampled": 142500, "sample_time_ms": 76009.127, "replay_time_ms": 282.812, "grad_time_ms": 71.646, "update_time_ms": 6.353, "opt_peak_throughput": 69787.684, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2945563793182373, "max_q": -0.07336189597845078, "min_q": -0.8974775075912476}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 142500, "episodes_total": 570, "training_iteration": 95, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-22-48", "timestamp": 1579893768, "time_this_iter_s": 77.53000497817993, "time_total_s": 7263.529431343079, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7263.529431343079, "timesteps_since_restore": 142500, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 39.91909090909091, "ram_util_percent": 50.10454545454547}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.97964348309046, "mean_processing_ms": 6.088363391809065, "mean_inference_ms": 0.7951743762751335}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 96, "num_steps_trained": 445000, "num_steps_sampled": 144000, "sample_time_ms": 76070.623, "replay_time_ms": 285.988, "grad_time_ms": 71.937, "update_time_ms": 6.353, "opt_peak_throughput": 69505.388, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29785069823265076, "max_q": -0.08128324151039124, "min_q": -0.70561283826828}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 144000, "episodes_total": 576, "training_iteration": 96, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-24-05", "timestamp": 1579893845, "time_this_iter_s": 76.34717392921448, "time_total_s": 7339.876605272293, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7339.876605272293, "timesteps_since_restore": 144000, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 37.24722222222223, "ram_util_percent": 50.1925925925926}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.97454677013667, "mean_processing_ms": 6.088153027645442, "mean_inference_ms": 0.7951115971943585}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 97, "num_steps_trained": 450000, "num_steps_sampled": 145500, "sample_time_ms": 76224.047, "replay_time_ms": 288.317, "grad_time_ms": 73.551, "update_time_ms": 6.376, "opt_peak_throughput": 67979.877, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30320975184440613, "max_q": -0.08330501616001129, "min_q": -0.8514209985733032}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 145500, "episodes_total": 582, "training_iteration": 97, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-25-21", "timestamp": 1579893921, "time_this_iter_s": 76.57674503326416, "time_total_s": 7416.453350305557, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7416.453350305557, "timesteps_since_restore": 145500, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 38.27522935779817, "ram_util_percent": 50.26605504587156}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9741798474581, "mean_processing_ms": 6.087919302542466, "mean_inference_ms": 0.7950633154948074}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 98, "num_steps_trained": 455000, "num_steps_sampled": 147000, "sample_time_ms": 76525.581, "replay_time_ms": 286.51, "grad_time_ms": 73.569, "update_time_ms": 6.31, "opt_peak_throughput": 67963.816, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29586437344551086, "max_q": -0.07276125997304916, "min_q": -0.7351503968238831}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 147000, "episodes_total": 588, "training_iteration": 98, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-26-39", "timestamp": 1579893999, "time_this_iter_s": 77.89277911186218, "time_total_s": 7494.346129417419, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7494.346129417419, "timesteps_since_restore": 147000, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 39.41621621621621, "ram_util_percent": 50.31531531531532}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.97666849338077, "mean_processing_ms": 6.087748901813891, "mean_inference_ms": 0.7950272770494727}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 99, "num_steps_trained": 460000, "num_steps_sampled": 148500, "sample_time_ms": 76816.498, "replay_time_ms": 284.923, "grad_time_ms": 74.067, "update_time_ms": 6.309, "opt_peak_throughput": 67506.211, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2949868142604828, "max_q": -0.07803712040185928, "min_q": -0.9954097867012024}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 148500, "episodes_total": 594, "training_iteration": 99, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-27-57", "timestamp": 1579894077, "time_this_iter_s": 77.98474383354187, "time_total_s": 7572.330873250961, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7572.330873250961, "timesteps_since_restore": 148500, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 40.11272727272727, "ram_util_percent": 50.45181818181818}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9784082707274, "mean_processing_ms": 6.08760109329327, "mean_inference_ms": 0.7949932070878802}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 100, "num_steps_trained": 465000, "num_steps_sampled": 150000, "sample_time_ms": 76683.825, "replay_time_ms": 285.694, "grad_time_ms": 74.261, "update_time_ms": 6.301, "opt_peak_throughput": 67329.943, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2999265491962433, "max_q": -0.10986261069774628, "min_q": -0.8190290331840515}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 150000, "episodes_total": 600, "training_iteration": 100, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-29-14", "timestamp": 1579894154, "time_this_iter_s": 76.48227787017822, "time_total_s": 7648.8131511211395, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7648.8131511211395, "timesteps_since_restore": 150000, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.716513761467894, "ram_util_percent": 50.59449541284403}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.9872797759414, "mean_processing_ms": 6.087413364691272, "mean_inference_ms": 0.7949804615404809}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 101, "num_steps_trained": 470000, "num_steps_sampled": 151500, "sample_time_ms": 76584.645, "replay_time_ms": 283.696, "grad_time_ms": 74.618, "update_time_ms": 6.389, "opt_peak_throughput": 67007.549, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29638272523880005, "max_q": -0.11170840263366699, "min_q": -1.0046974420547485}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 151500, "episodes_total": 606, "training_iteration": 101, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-30-30", "timestamp": 1579894230, "time_this_iter_s": 76.42326664924622, "time_total_s": 7725.236417770386, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7725.236417770386, "timesteps_since_restore": 151500, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 38.0712962962963, "ram_util_percent": 50.73888888888888}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0029396513179, "mean_processing_ms": 6.087264962074568, "mean_inference_ms": 0.7949866532278338}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 102, "num_steps_trained": 475000, "num_steps_sampled": 153000, "sample_time_ms": 76633.713, "replay_time_ms": 281.03, "grad_time_ms": 74.823, "update_time_ms": 6.373, "opt_peak_throughput": 66824.417, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29589933156967163, "max_q": -0.10119897127151489, "min_q": -0.7836571931838989}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 153000, "episodes_total": 612, "training_iteration": 102, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-31-48", "timestamp": 1579894308, "time_this_iter_s": 77.48423218727112, "time_total_s": 7802.720649957657, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7802.720649957657, "timesteps_since_restore": 153000, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 38.83272727272727, "ram_util_percent": 50.71636363636363}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.02267811643696, "mean_processing_ms": 6.087212047309921, "mean_inference_ms": 0.795001220926231}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 103, "num_steps_trained": 480000, "num_steps_sampled": 154500, "sample_time_ms": 76727.382, "replay_time_ms": 281.775, "grad_time_ms": 75.887, "update_time_ms": 6.337, "opt_peak_throughput": 65887.137, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30063870549201965, "max_q": -0.10200987011194229, "min_q": -0.7097482085227966}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 154500, "episodes_total": 618, "training_iteration": 103, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-33-05", "timestamp": 1579894385, "time_this_iter_s": 77.21501898765564, "time_total_s": 7879.9356689453125, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7879.9356689453125, "timesteps_since_restore": 154500, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 39.36818181818181, "ram_util_percent": 50.80818181818182}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0461266504863, "mean_processing_ms": 6.087319990273823, "mean_inference_ms": 0.7950286418123191}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 104, "num_steps_trained": 485000, "num_steps_sampled": 156000, "sample_time_ms": 76671.997, "replay_time_ms": 284.035, "grad_time_ms": 76.9, "update_time_ms": 6.315, "opt_peak_throughput": 65019.219, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.301089882850647, "max_q": -0.09637047350406647, "min_q": -0.768608570098877}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 156000, "episodes_total": 624, "training_iteration": 104, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-34-22", "timestamp": 1579894462, "time_this_iter_s": 76.60951590538025, "time_total_s": 7956.545184850693, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 7956.545184850693, "timesteps_since_restore": 156000, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 38.59444444444445, "ram_util_percent": 50.8824074074074}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.0746024487127, "mean_processing_ms": 6.087393877960612, "mean_inference_ms": 0.7950718131326657}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 105, "num_steps_trained": 490000, "num_steps_sampled": 157500, "sample_time_ms": 76596.418, "replay_time_ms": 281.958, "grad_time_ms": 76.176, "update_time_ms": 6.342, "opt_peak_throughput": 65637.636, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29879018664360046, "max_q": -0.09659937024116516, "min_q": -0.8260567784309387}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 157500, "episodes_total": 630, "training_iteration": 105, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-35-38", "timestamp": 1579894538, "time_this_iter_s": 76.74765014648438, "time_total_s": 8033.292834997177, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8033.292834997177, "timesteps_since_restore": 157500, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 38.88807339449542, "ram_util_percent": 50.87798165137614}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.1060639523652, "mean_processing_ms": 6.0873445645531845, "mean_inference_ms": 0.7951236983671366}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 106, "num_steps_trained": 495000, "num_steps_sampled": 159000, "sample_time_ms": 76691.383, "replay_time_ms": 280.043, "grad_time_ms": 75.088, "update_time_ms": 6.338, "opt_peak_throughput": 66588.346, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2991885542869568, "max_q": -0.10525424778461456, "min_q": -0.9779861569404602}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 159000, "episodes_total": 636, "training_iteration": 106, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-36-56", "timestamp": 1579894616, "time_this_iter_s": 77.26636791229248, "time_total_s": 8110.55920290947, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8110.55920290947, "timesteps_since_restore": 159000, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 39.87363636363636, "ram_util_percent": 50.93545454545454}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.13298876389877, "mean_processing_ms": 6.087332454510931, "mean_inference_ms": 0.7951640631365423}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 107, "num_steps_trained": 500000, "num_steps_sampled": 160500, "sample_time_ms": 76654.971, "replay_time_ms": 282.508, "grad_time_ms": 74.629, "update_time_ms": 6.346, "opt_peak_throughput": 66998.108, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30154862999916077, "max_q": -0.09304346889257431, "min_q": -0.7579483389854431}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 160500, "episodes_total": 642, "training_iteration": 107, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-38-12", "timestamp": 1579894692, "time_this_iter_s": 76.23359990119934, "time_total_s": 8186.792802810669, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8186.792802810669, "timesteps_since_restore": 160500, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 38.974074074074075, "ram_util_percent": 51.0712962962963}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.1582700624786, "mean_processing_ms": 6.087279622178539, "mean_inference_ms": 0.7952014192942479}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 108, "num_steps_trained": 505000, "num_steps_sampled": 162000, "sample_time_ms": 76541.57, "replay_time_ms": 281.246, "grad_time_ms": 74.339, "update_time_ms": 6.351, "opt_peak_throughput": 67259.202, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2993028163909912, "max_q": -0.09435263276100159, "min_q": -0.7778610587120056}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 162000, "episodes_total": 648, "training_iteration": 108, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-39-29", "timestamp": 1579894769, "time_this_iter_s": 76.74355792999268, "time_total_s": 8263.536360740662, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8263.536360740662, "timesteps_since_restore": 162000, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 38.10366972477065, "ram_util_percent": 51.1633027522936}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.1843226615416, "mean_processing_ms": 6.087227478573267, "mean_inference_ms": 0.7952421594848738}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 109, "num_steps_trained": 510000, "num_steps_sampled": 163500, "sample_time_ms": 76463.39, "replay_time_ms": 278.434, "grad_time_ms": 73.265, "update_time_ms": 6.31, "opt_peak_throughput": 68245.273, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2990700602531433, "max_q": -0.108618825674057, "min_q": -0.7381429672241211}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 163500, "episodes_total": 654, "training_iteration": 109, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-40-46", "timestamp": 1579894846, "time_this_iter_s": 77.1651041507721, "time_total_s": 8340.701464891434, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8340.701464891434, "timesteps_since_restore": 163500, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 39.25636363636364, "ram_util_percent": 51.11272727272729}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2106599213853, "mean_processing_ms": 6.087268807886885, "mean_inference_ms": 0.7952793076966078}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 110, "num_steps_trained": 515000, "num_steps_sampled": 165000, "sample_time_ms": 76509.248, "replay_time_ms": 278.917, "grad_time_ms": 73.57, "update_time_ms": 6.276, "opt_peak_throughput": 67962.252, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29760468006134033, "max_q": -0.09250281751155853, "min_q": -0.9225776791572571}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 165000, "episodes_total": 660, "training_iteration": 110, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-42-03", "timestamp": 1579894923, "time_this_iter_s": 76.95040726661682, "time_total_s": 8417.65187215805, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8417.65187215805, "timesteps_since_restore": 165000, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 39.16697247706423, "ram_util_percent": 51.20275229357798}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2330875285389, "mean_processing_ms": 6.0872042628570195, "mean_inference_ms": 0.7953080120189786}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 111, "num_steps_trained": 520000, "num_steps_sampled": 166500, "sample_time_ms": 76434.931, "replay_time_ms": 280.126, "grad_time_ms": 73.838, "update_time_ms": 6.258, "opt_peak_throughput": 67715.858, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30142712593078613, "max_q": -0.0969199687242508, "min_q": -0.7666509747505188}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 166500, "episodes_total": 666, "training_iteration": 111, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-43-19", "timestamp": 1579894999, "time_this_iter_s": 75.6938271522522, "time_total_s": 8493.345699310303, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8493.345699310303, "timesteps_since_restore": 166500, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 37.76915887850467, "ram_util_percent": 51.253271028037375}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2565866064417, "mean_processing_ms": 6.086998159360512, "mean_inference_ms": 0.7953429974448853}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 112, "num_steps_trained": 525000, "num_steps_sampled": 168000, "sample_time_ms": 76446.228, "replay_time_ms": 280.192, "grad_time_ms": 73.517, "update_time_ms": 6.242, "opt_peak_throughput": 68011.05, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30185791850090027, "max_q": -0.09205520153045654, "min_q": -0.7410631775856018}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 168000, "episodes_total": 672, "training_iteration": 112, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-44-36", "timestamp": 1579895076, "time_this_iter_s": 77.59430599212646, "time_total_s": 8570.94000530243, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8570.94000530243, "timesteps_since_restore": 168000, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 39.74454545454547, "ram_util_percent": 51.30909090909091}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2823186038093, "mean_processing_ms": 6.086879796829338, "mean_inference_ms": 0.7953875555627795}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 113, "num_steps_trained": 530000, "num_steps_sampled": 169500, "sample_time_ms": 76488.111, "replay_time_ms": 280.007, "grad_time_ms": 72.698, "update_time_ms": 6.305, "opt_peak_throughput": 68777.347, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.296854704618454, "max_q": -0.08904126286506653, "min_q": -0.6537817716598511}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 169500, "episodes_total": 678, "training_iteration": 113, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-45-54", "timestamp": 1579895154, "time_this_iter_s": 77.62538290023804, "time_total_s": 8648.565388202667, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8648.565388202667, "timesteps_since_restore": 169500, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 39.71636363636365, "ram_util_percent": 51.41727272727271}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.3076015798498, "mean_processing_ms": 6.086777805354413, "mean_inference_ms": 0.7954260378419628}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 114, "num_steps_trained": 535000, "num_steps_sampled": 171000, "sample_time_ms": 76553.392, "replay_time_ms": 280.006, "grad_time_ms": 72.18, "update_time_ms": 6.378, "opt_peak_throughput": 69271.029, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30034857988357544, "max_q": -0.0992591381072998, "min_q": -0.7370322942733765}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 171000, "episodes_total": 684, "training_iteration": 114, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-47-11", "timestamp": 1579895231, "time_this_iter_s": 77.25825810432434, "time_total_s": 8725.823646306992, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8725.823646306992, "timesteps_since_restore": 171000, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 39.04454545454546, "ram_util_percent": 51.5818181818182}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.33024723531, "mean_processing_ms": 6.086632877289786, "mean_inference_ms": 0.79545513114297}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 115, "num_steps_trained": 540000, "num_steps_sampled": 172500, "sample_time_ms": 76569.465, "replay_time_ms": 286.133, "grad_time_ms": 75.701, "update_time_ms": 6.317, "opt_peak_throughput": 66049.181, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3019927144050598, "max_q": -0.09219608455896378, "min_q": -0.7033082246780396}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 172500, "episodes_total": 690, "training_iteration": 115, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-48-28", "timestamp": 1579895308, "time_this_iter_s": 77.00746011734009, "time_total_s": 8802.831106424332, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8802.831106424332, "timesteps_since_restore": 172500, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 38.37981651376146, "ram_util_percent": 51.68256880733946}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.3519254257353, "mean_processing_ms": 6.08648461069272, "mean_inference_ms": 0.7954785149774181}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 116, "num_steps_trained": 545000, "num_steps_sampled": 174000, "sample_time_ms": 76564.444, "replay_time_ms": 285.151, "grad_time_ms": 76.154, "update_time_ms": 6.396, "opt_peak_throughput": 65656.11, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29944396018981934, "max_q": -0.10242632776498795, "min_q": -0.7130807638168335}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 174000, "episodes_total": 696, "training_iteration": 116, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-49-45", "timestamp": 1579895385, "time_this_iter_s": 77.21132206916809, "time_total_s": 8880.0424284935, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8880.0424284935, "timesteps_since_restore": 174000, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 39.75909090909091, "ram_util_percent": 51.724545454545456}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.37415301687366, "mean_processing_ms": 6.086329024149558, "mean_inference_ms": 0.7955051746799109}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 117, "num_steps_trained": 550000, "num_steps_sampled": 175500, "sample_time_ms": 76627.566, "replay_time_ms": 283.38, "grad_time_ms": 76.035, "update_time_ms": 6.351, "opt_peak_throughput": 65759.356, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2997501492500305, "max_q": -0.10351581126451492, "min_q": -0.7333032488822937}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 175500, "episodes_total": 702, "training_iteration": 117, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-51-02", "timestamp": 1579895462, "time_this_iter_s": 76.84503698348999, "time_total_s": 8956.88746547699, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 8956.88746547699, "timesteps_since_restore": 175500, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 38.3743119266055, "ram_util_percent": 51.78899082568808}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.39364132406774, "mean_processing_ms": 6.08625602902581, "mean_inference_ms": 0.7955198561434723}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 118, "num_steps_trained": 555000, "num_steps_sampled": 177000, "sample_time_ms": 76539.277, "replay_time_ms": 287.388, "grad_time_ms": 76.314, "update_time_ms": 6.361, "opt_peak_throughput": 65518.494, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29877644777297974, "max_q": -0.1073141023516655, "min_q": -0.7726622819900513}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 177000, "episodes_total": 708, "training_iteration": 118, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-52-18", "timestamp": 1579895538, "time_this_iter_s": 75.90368890762329, "time_total_s": 9032.791154384613, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9032.791154384613, "timesteps_since_restore": 177000, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 38.24722222222222, "ram_util_percent": 51.79444444444444}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.404860179112, "mean_processing_ms": 6.086188651852288, "mean_inference_ms": 0.7955135532525407}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 119, "num_steps_trained": 560000, "num_steps_sampled": 178500, "sample_time_ms": 76184.508, "replay_time_ms": 287.822, "grad_time_ms": 76.363, "update_time_ms": 6.368, "opt_peak_throughput": 65476.519, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2979637086391449, "max_q": -0.09903641790151596, "min_q": -0.6722121834754944}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 178500, "episodes_total": 714, "training_iteration": 119, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-53-32", "timestamp": 1579895612, "time_this_iter_s": 73.62193012237549, "time_total_s": 9106.413084506989, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9106.413084506989, "timesteps_since_restore": 178500, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 34.50865384615384, "ram_util_percent": 51.90192307692307}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.4077735669341, "mean_processing_ms": 6.086027081922099, "mean_inference_ms": 0.7954871613985517}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 120, "num_steps_trained": 565000, "num_steps_sampled": 180000, "sample_time_ms": 75770.206, "replay_time_ms": 285.364, "grad_time_ms": 75.005, "update_time_ms": 6.455, "opt_peak_throughput": 66661.92, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30284902453422546, "max_q": -0.11000901460647583, "min_q": -0.7341030836105347}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 180000, "episodes_total": 720, "training_iteration": 120, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-54-45", "timestamp": 1579895685, "time_this_iter_s": 72.77000784873962, "time_total_s": 9179.183092355728, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9179.183092355728, "timesteps_since_restore": 180000, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 33.533980582524265, "ram_util_percent": 50.54466019417476}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.4035664647426, "mean_processing_ms": 6.085808533610724, "mean_inference_ms": 0.7954435076720359}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 121, "num_steps_trained": 570000, "num_steps_sampled": 181500, "sample_time_ms": 75503.009, "replay_time_ms": 282.488, "grad_time_ms": 75.04, "update_time_ms": 6.481, "opt_peak_throughput": 66630.997, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30026453733444214, "max_q": -0.12040513753890991, "min_q": -0.7400479912757874}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 181500, "episodes_total": 726, "training_iteration": 121, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-55-58", "timestamp": 1579895758, "time_this_iter_s": 72.99602818489075, "time_total_s": 9252.179120540619, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9252.179120540619, "timesteps_since_restore": 181500, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 34.05192307692308, "ram_util_percent": 50.50865384615384}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.3926602977719, "mean_processing_ms": 6.085575437959681, "mean_inference_ms": 0.7953836207441847}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 122, "num_steps_trained": 575000, "num_steps_sampled": 183000, "sample_time_ms": 75109.167, "replay_time_ms": 281.894, "grad_time_ms": 75.311, "update_time_ms": 6.489, "opt_peak_throughput": 66391.349, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3006168603897095, "max_q": -0.11748183518648148, "min_q": -0.6780120134353638}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 183000, "episodes_total": 732, "training_iteration": 122, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-57-11", "timestamp": 1579895831, "time_this_iter_s": 73.65348410606384, "time_total_s": 9325.832604646683, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9325.832604646683, "timesteps_since_restore": 183000, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 35.517307692307696, "ram_util_percent": 50.60384615384616}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.376918874073, "mean_processing_ms": 6.085203716159148, "mean_inference_ms": 0.7953100387646829}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 123, "num_steps_trained": 580000, "num_steps_sampled": 184500, "sample_time_ms": 74754.199, "replay_time_ms": 279.127, "grad_time_ms": 74.997, "update_time_ms": 6.522, "opt_peak_throughput": 66669.401, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3007895052433014, "max_q": -0.10120709985494614, "min_q": -0.7323710322380066}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 184500, "episodes_total": 738, "training_iteration": 123, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-58-26", "timestamp": 1579895906, "time_this_iter_s": 74.04520606994629, "time_total_s": 9399.877810716629, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9399.877810716629, "timesteps_since_restore": 184500, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 35.45904761904762, "ram_util_percent": 49.969523809523814}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.3569385268209, "mean_processing_ms": 6.084889695884892, "mean_inference_ms": 0.7952296138296944}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 124, "num_steps_trained": 585000, "num_steps_sampled": 186000, "sample_time_ms": 74443.505, "replay_time_ms": 280.084, "grad_time_ms": 75.072, "update_time_ms": 6.446, "opt_peak_throughput": 66602.43, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29954028129577637, "max_q": -0.09717217087745667, "min_q": -0.7992610335350037}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 186000, "episodes_total": 744, "training_iteration": 124, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_20-59-40", "timestamp": 1579895980, "time_this_iter_s": 74.15982484817505, "time_total_s": 9474.037635564804, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9474.037635564804, "timesteps_since_restore": 186000, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 36.07830188679246, "ram_util_percent": 47.278301886792455}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.33091910736243, "mean_processing_ms": 6.08465758388141, "mean_inference_ms": 0.795139960742479}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 125, "num_steps_trained": 590000, "num_steps_sampled": 187500, "sample_time_ms": 74141.351, "replay_time_ms": 275.742, "grad_time_ms": 72.094, "update_time_ms": 6.44, "opt_peak_throughput": 69354.347, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30057039856910706, "max_q": -0.08249439299106598, "min_q": -0.727933406829834}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 187500, "episodes_total": 750, "training_iteration": 125, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-00-54", "timestamp": 1579896054, "time_this_iter_s": 73.9089629650116, "time_total_s": 9547.946598529816, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9547.946598529816, "timesteps_since_restore": 187500, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 35.45428571428571, "ram_util_percent": 47.36571428571426}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2984635550788, "mean_processing_ms": 6.084357458634023, "mean_inference_ms": 0.795037253538302}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 126, "num_steps_trained": 595000, "num_steps_sampled": 189000, "sample_time_ms": 73805.185, "replay_time_ms": 277.883, "grad_time_ms": 73.059, "update_time_ms": 6.334, "opt_peak_throughput": 68438.096, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30113062262535095, "max_q": -0.09158637374639511, "min_q": -0.6550437211990356}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 189000, "episodes_total": 756, "training_iteration": 126, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-02-08", "timestamp": 1579896128, "time_this_iter_s": 73.87860894203186, "time_total_s": 9621.825207471848, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9621.825207471848, "timesteps_since_restore": 189000, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 35.48076923076923, "ram_util_percent": 47.464423076923076}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2623934151897, "mean_processing_ms": 6.08414149634491, "mean_inference_ms": 0.7949255407461958}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 127, "num_steps_trained": 600000, "num_steps_sampled": 190500, "sample_time_ms": 73548.31, "replay_time_ms": 277.525, "grad_time_ms": 73.622, "update_time_ms": 6.361, "opt_peak_throughput": 67914.471, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29584214091300964, "max_q": -0.08400602638721466, "min_q": -0.7129407525062561}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 190500, "episodes_total": 762, "training_iteration": 127, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-03-22", "timestamp": 1579896202, "time_this_iter_s": 74.27879095077515, "time_total_s": 9696.103998422623, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9696.103998422623, "timesteps_since_restore": 190500, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 35.367924528301884, "ram_util_percent": 47.577358490566056}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.2222279244026, "mean_processing_ms": 6.083899052742733, "mean_inference_ms": 0.794801640466976}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 128, "num_steps_trained": 605000, "num_steps_sampled": 192000, "sample_time_ms": 73358.666, "replay_time_ms": 274.634, "grad_time_ms": 74.389, "update_time_ms": 6.33, "opt_peak_throughput": 67213.954, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3029825687408447, "max_q": -0.0909997895359993, "min_q": -0.7270366549491882}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 192000, "episodes_total": 768, "training_iteration": 128, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-04-36", "timestamp": 1579896276, "time_this_iter_s": 73.98481464385986, "time_total_s": 9770.088813066483, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9770.088813066483, "timesteps_since_restore": 192000, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.695238095238096, "ram_util_percent": 47.72380952380952}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.1759313694066, "mean_processing_ms": 6.083736035084135, "mean_inference_ms": 0.7946585680163648}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 129, "num_steps_trained": 610000, "num_steps_sampled": 193500, "sample_time_ms": 73421.891, "replay_time_ms": 274.977, "grad_time_ms": 74.922, "update_time_ms": 6.287, "opt_peak_throughput": 66736.23, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2999555766582489, "max_q": -0.09465646743774414, "min_q": -0.7366420030593872}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 193500, "episodes_total": 774, "training_iteration": 129, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-05-50", "timestamp": 1579896350, "time_this_iter_s": 74.26143383979797, "time_total_s": 9844.35024690628, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9844.35024690628, "timesteps_since_restore": 193500, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 35.59904761904762, "ram_util_percent": 47.78285714285714}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.12519794093373, "mean_processing_ms": 6.0834526063576675, "mean_inference_ms": 0.7945011325397694}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 130, "num_steps_trained": 615000, "num_steps_sampled": 195000, "sample_time_ms": 73646.998, "replay_time_ms": 275.249, "grad_time_ms": 75.24, "update_time_ms": 6.266, "opt_peak_throughput": 66453.915, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2978140115737915, "max_q": -0.0925421193242073, "min_q": -0.7056086659431458}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 195000, "episodes_total": 780, "training_iteration": 130, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-07-05", "timestamp": 1579896425, "time_this_iter_s": 75.02626204490662, "time_total_s": 9919.376508951187, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9919.376508951187, "timesteps_since_restore": 195000, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 35.83831775700934, "ram_util_percent": 47.91121495327101}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.070908488037, "mean_processing_ms": 6.083172504905897, "mean_inference_ms": 0.7943372370733208}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 131, "num_steps_trained": 620000, "num_steps_sampled": 196500, "sample_time_ms": 73836.549, "replay_time_ms": 274.785, "grad_time_ms": 74.301, "update_time_ms": 6.256, "opt_peak_throughput": 67294.122, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3045927882194519, "max_q": -0.08787903934717178, "min_q": -0.7224090099334717}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 196500, "episodes_total": 786, "training_iteration": 131, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-08-20", "timestamp": 1579896500, "time_this_iter_s": 74.87726998329163, "time_total_s": 9994.253778934479, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 9994.253778934479, "timesteps_since_restore": 196500, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 37.133018867924534, "ram_util_percent": 48.0924528301887}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 291.01316658747476, "mean_processing_ms": 6.082898710164921, "mean_inference_ms": 0.7941661767174684}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 132, "num_steps_trained": 625000, "num_steps_sampled": 198000, "sample_time_ms": 73960.731, "replay_time_ms": 275.207, "grad_time_ms": 74.014, "update_time_ms": 6.319, "opt_peak_throughput": 67554.508, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.303864061832428, "max_q": -0.08656835556030273, "min_q": -0.7340553998947144}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 198000, "episodes_total": 792, "training_iteration": 132, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-09-35", "timestamp": 1579896575, "time_this_iter_s": 74.89737224578857, "time_total_s": 10069.151151180267, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10069.151151180267, "timesteps_since_restore": 198000, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 37.14245283018868, "ram_util_percent": 48.21132075471698}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.95245092982424, "mean_processing_ms": 6.082827742461494, "mean_inference_ms": 0.7939881389472955}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 133, "num_steps_trained": 630000, "num_steps_sampled": 199500, "sample_time_ms": 74108.775, "replay_time_ms": 280.291, "grad_time_ms": 76.569, "update_time_ms": 6.262, "opt_peak_throughput": 65300.246, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29950225353240967, "max_q": -0.08472473919391632, "min_q": -0.7442023158073425}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 199500, "episodes_total": 798, "training_iteration": 133, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-10-51", "timestamp": 1579896651, "time_this_iter_s": 75.60377097129822, "time_total_s": 10144.754922151566, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10144.754922151566, "timesteps_since_restore": 199500, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 38.819444444444436, "ram_util_percent": 48.348148148148134}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.8943854758635, "mean_processing_ms": 6.082652082729657, "mean_inference_ms": 0.7938198843213883}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 134, "num_steps_trained": 635000, "num_steps_sampled": 201000, "sample_time_ms": 74458.96, "replay_time_ms": 276.738, "grad_time_ms": 76.772, "update_time_ms": 6.536, "opt_peak_throughput": 65127.832, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30474501848220825, "max_q": -0.09100371599197388, "min_q": -0.7393997311592102}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 201000, "episodes_total": 804, "training_iteration": 134, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-12-08", "timestamp": 1579896728, "time_this_iter_s": 77.63413500785828, "time_total_s": 10222.389057159424, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10222.389057159424, "timesteps_since_restore": 201000, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 39.49181818181818, "ram_util_percent": 48.549090909090886}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.83712010693534, "mean_processing_ms": 6.08249395853363, "mean_inference_ms": 0.7936557659428968}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 135, "num_steps_trained": 640000, "num_steps_sampled": 202500, "sample_time_ms": 74585.742, "replay_time_ms": 278.703, "grad_time_ms": 76.817, "update_time_ms": 6.599, "opt_peak_throughput": 65090.011, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3027498424053192, "max_q": -0.0978255569934845, "min_q": -0.6577004790306091}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 202500, "episodes_total": 810, "training_iteration": 135, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-13-24", "timestamp": 1579896804, "time_this_iter_s": 75.19850015640259, "time_total_s": 10297.587557315826, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10297.587557315826, "timesteps_since_restore": 202500, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 36.41401869158879, "ram_util_percent": 48.5766355140187}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.78255500719547, "mean_processing_ms": 6.082341975769538, "mean_inference_ms": 0.7935012061292842}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 136, "num_steps_trained": 645000, "num_steps_sampled": 204000, "sample_time_ms": 74630.873, "replay_time_ms": 278.27, "grad_time_ms": 77.115, "update_time_ms": 6.631, "opt_peak_throughput": 64838.38, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30027759075164795, "max_q": -0.09989464282989502, "min_q": -0.67525315284729}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 204000, "episodes_total": 816, "training_iteration": 136, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-14-38", "timestamp": 1579896878, "time_this_iter_s": 74.33266997337341, "time_total_s": 10371.9202272892, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10371.9202272892, "timesteps_since_restore": 204000, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 34.296190476190475, "ram_util_percent": 48.823809523809516}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.73130860929587, "mean_processing_ms": 6.082161544430505, "mean_inference_ms": 0.7933557100383456}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 137, "num_steps_trained": 650000, "num_steps_sampled": 205500, "sample_time_ms": 74617.944, "replay_time_ms": 275.866, "grad_time_ms": 76.74, "update_time_ms": 6.712, "opt_peak_throughput": 65155.047, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2996510863304138, "max_q": -0.07978738844394684, "min_q": -0.7102447748184204}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 205500, "episodes_total": 822, "training_iteration": 137, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-15-52", "timestamp": 1579896952, "time_this_iter_s": 74.12517285346985, "time_total_s": 10446.04540014267, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10446.04540014267, "timesteps_since_restore": 205500, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 36.180952380952384, "ram_util_percent": 48.8647619047619}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.68483411925644, "mean_processing_ms": 6.081897539434095, "mean_inference_ms": 0.7932205309230175}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 138, "num_steps_trained": 655000, "num_steps_sampled": 207000, "sample_time_ms": 74755.087, "replay_time_ms": 275.052, "grad_time_ms": 75.487, "update_time_ms": 6.761, "opt_peak_throughput": 66236.492, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30594390630722046, "max_q": -0.08686687797307968, "min_q": -0.7811874151229858}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 207000, "episodes_total": 828, "training_iteration": 138, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-17-07", "timestamp": 1579897027, "time_this_iter_s": 75.33733296394348, "time_total_s": 10521.382733106613, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10521.382733106613, "timesteps_since_restore": 207000, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 37.14299065420561, "ram_util_percent": 48.93364485981307}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.64187642348793, "mean_processing_ms": 6.081649670640203, "mean_inference_ms": 0.7930938137867019}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 139, "num_steps_trained": 660000, "num_steps_sampled": 208500, "sample_time_ms": 74868.211, "replay_time_ms": 273.867, "grad_time_ms": 75.555, "update_time_ms": 6.823, "opt_peak_throughput": 66176.715, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.305025577545166, "max_q": -0.08678792417049408, "min_q": -0.7237750291824341}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 208500, "episodes_total": 834, "training_iteration": 139, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-18-23", "timestamp": 1579897103, "time_this_iter_s": 75.38282489776611, "time_total_s": 10596.76555800438, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10596.76555800438, "timesteps_since_restore": 208500, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 37.004672897196265, "ram_util_percent": 49.08317757009348}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.60282324830484, "mean_processing_ms": 6.081374403891995, "mean_inference_ms": 0.7929778391829019}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 140, "num_steps_trained": 665000, "num_steps_sampled": 210000, "sample_time_ms": 74959.074, "replay_time_ms": 274.999, "grad_time_ms": 75.861, "update_time_ms": 6.805, "opt_peak_throughput": 65910.184, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.29611483216285706, "max_q": -0.08230750262737274, "min_q": -0.701917290687561}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 210000, "episodes_total": 840, "training_iteration": 140, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-19-39", "timestamp": 1579897179, "time_this_iter_s": 75.94851899147034, "time_total_s": 10672.71407699585, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10672.71407699585, "timesteps_since_restore": 210000, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 36.806481481481484, "ram_util_percent": 49.17592592592592}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.5678329594152, "mean_processing_ms": 6.081043933259846, "mean_inference_ms": 0.7928709736852411}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 141, "num_steps_trained": 670000, "num_steps_sampled": 211500, "sample_time_ms": 75060.607, "replay_time_ms": 275.79, "grad_time_ms": 76.184, "update_time_ms": 6.757, "opt_peak_throughput": 65630.898, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30693578720092773, "max_q": -0.10040643811225891, "min_q": -0.7491899132728577}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 211500, "episodes_total": 846, "training_iteration": 141, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-20-55", "timestamp": 1579897255, "time_this_iter_s": 75.90226411819458, "time_total_s": 10748.616341114044, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10748.616341114044, "timesteps_since_restore": 211500, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 38.487037037037034, "ram_util_percent": 49.336111111111116}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.53373576040246, "mean_processing_ms": 6.080649828548749, "mean_inference_ms": 0.7927650957212444}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 142, "num_steps_trained": 675000, "num_steps_sampled": 213000, "sample_time_ms": 74964.838, "replay_time_ms": 277.744, "grad_time_ms": 76.911, "update_time_ms": 6.706, "opt_peak_throughput": 65010.351, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3094008266925812, "max_q": -0.09378397464752197, "min_q": -0.7562254667282104}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 213000, "episodes_total": 852, "training_iteration": 142, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-22-09", "timestamp": 1579897329, "time_this_iter_s": 73.96575593948364, "time_total_s": 10822.582097053528, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10822.582097053528, "timesteps_since_restore": 213000, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 35.44857142857143, "ram_util_percent": 49.414285714285704}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.5006752804842, "mean_processing_ms": 6.080158238449054, "mean_inference_ms": 0.7926620556750816}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 143, "num_steps_trained": 680000, "num_steps_sampled": 214500, "sample_time_ms": 74816.885, "replay_time_ms": 274.01, "grad_time_ms": 74.531, "update_time_ms": 6.669, "opt_peak_throughput": 67085.98, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.300217866897583, "max_q": -0.0951465591788292, "min_q": -0.8456188440322876}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 214500, "episodes_total": 858, "training_iteration": 143, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-23-23", "timestamp": 1579897403, "time_this_iter_s": 74.06050491333008, "time_total_s": 10896.642601966858, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10896.642601966858, "timesteps_since_restore": 214500, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 34.502857142857145, "ram_util_percent": 49.52}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.4700492463621, "mean_processing_ms": 6.07960133092823, "mean_inference_ms": 0.7925664937084964}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 144, "num_steps_trained": 685000, "num_steps_sampled": 216000, "sample_time_ms": 74572.513, "replay_time_ms": 275.42, "grad_time_ms": 75.1, "update_time_ms": 6.369, "opt_peak_throughput": 66577.881, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30022314190864563, "max_q": -0.0768912062048912, "min_q": -0.790237545967102}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 216000, "episodes_total": 864, "training_iteration": 144, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-24-38", "timestamp": 1579897478, "time_this_iter_s": 75.20537090301514, "time_total_s": 10971.847972869873, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 10971.847972869873, "timesteps_since_restore": 216000, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 37.70566037735849, "ram_util_percent": 49.649056603773595}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.44200363137605, "mean_processing_ms": 6.0790326864777136, "mean_inference_ms": 0.7924778216376656}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 145, "num_steps_trained": 690000, "num_steps_sampled": 217500, "sample_time_ms": 74572.787, "replay_time_ms": 271.984, "grad_time_ms": 74.647, "update_time_ms": 6.4, "opt_peak_throughput": 66981.931, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3036283552646637, "max_q": -0.09076535701751709, "min_q": -0.8774762153625488}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 217500, "episodes_total": 870, "training_iteration": 145, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-25-53", "timestamp": 1579897553, "time_this_iter_s": 75.16386580467224, "time_total_s": 11047.011838674545, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11047.011838674545, "timesteps_since_restore": 217500, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 37.273831775700934, "ram_util_percent": 49.748598130841124}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.41714870365945, "mean_processing_ms": 6.078470043219829, "mean_inference_ms": 0.7924006008232084}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 146, "num_steps_trained": 695000, "num_steps_sampled": 219000, "sample_time_ms": 74745.565, "replay_time_ms": 273.239, "grad_time_ms": 75.185, "update_time_ms": 6.436, "opt_peak_throughput": 66502.89, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3046450614929199, "max_q": -0.10342799872159958, "min_q": -0.9125064015388489}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 219000, "episodes_total": 876, "training_iteration": 146, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-27-09", "timestamp": 1579897629, "time_this_iter_s": 76.07713413238525, "time_total_s": 11123.08897280693, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11123.08897280693, "timesteps_since_restore": 219000, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 38.35833333333332, "ram_util_percent": 49.806481481481484}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.3931200105408, "mean_processing_ms": 6.077963654931199, "mean_inference_ms": 0.7923281891809293}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 147, "num_steps_trained": 700000, "num_steps_sampled": 220500, "sample_time_ms": 74862.806, "replay_time_ms": 275.415, "grad_time_ms": 75.128, "update_time_ms": 6.342, "opt_peak_throughput": 66552.908, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2963995635509491, "max_q": -0.10027516633272171, "min_q": -0.6846416592597961}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 220500, "episodes_total": 882, "training_iteration": 147, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-28-25", "timestamp": 1579897705, "time_this_iter_s": 75.31482481956482, "time_total_s": 11198.403797626495, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11198.403797626495, "timesteps_since_restore": 220500, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 37.591588785046724, "ram_util_percent": 50.07757009345796}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.36688745275114, "mean_processing_ms": 6.077481649897413, "mean_inference_ms": 0.7922508331531333}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 148, "num_steps_trained": 705000, "num_steps_sampled": 222000, "sample_time_ms": 74678.696, "replay_time_ms": 277.714, "grad_time_ms": 75.817, "update_time_ms": 6.302, "opt_peak_throughput": 65948.425, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3048943281173706, "max_q": -0.11382468789815903, "min_q": -0.704606831073761}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 222000, "episodes_total": 888, "training_iteration": 148, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-29-38", "timestamp": 1579897778, "time_this_iter_s": 73.5259518623352, "time_total_s": 11271.92974948883, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11271.92974948883, "timesteps_since_restore": 222000, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 34.29711538461539, "ram_util_percent": 50.13269230769231}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.3386762663666, "mean_processing_ms": 6.076975184635513, "mean_inference_ms": 0.7921721688115646}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 149, "num_steps_trained": 710000, "num_steps_sampled": 223500, "sample_time_ms": 74510.122, "replay_time_ms": 280.158, "grad_time_ms": 76.436, "update_time_ms": 6.296, "opt_peak_throughput": 65414.533, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3099963366985321, "max_q": -0.10133711993694305, "min_q": -0.770565390586853}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 223500, "episodes_total": 894, "training_iteration": 149, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-30-52", "timestamp": 1579897852, "time_this_iter_s": 73.7273998260498, "time_total_s": 11345.65714931488, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11345.65714931488, "timesteps_since_restore": 223500, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 34.82476190476191, "ram_util_percent": 50.181904761904754}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.30819966743957, "mean_processing_ms": 6.076323017198079, "mean_inference_ms": 0.7920871127228161}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 150, "num_steps_trained": 715000, "num_steps_sampled": 225000, "sample_time_ms": 74367.974, "replay_time_ms": 279.95, "grad_time_ms": 76.148, "update_time_ms": 6.273, "opt_peak_throughput": 65661.783, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2998497486114502, "max_q": -0.07866965979337692, "min_q": -0.7005093693733215}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 225000, "episodes_total": 900, "training_iteration": 150, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-32-07", "timestamp": 1579897927, "time_this_iter_s": 74.52181196212769, "time_total_s": 11420.178961277008, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11420.178961277008, "timesteps_since_restore": 225000, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 35.57452830188679, "ram_util_percent": 50.25754716981131}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.27642681501715, "mean_processing_ms": 6.075756920398316, "mean_inference_ms": 0.7919961832109252}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 151, "num_steps_trained": 720000, "num_steps_sampled": 226500, "sample_time_ms": 74355.056, "replay_time_ms": 279.774, "grad_time_ms": 75.993, "update_time_ms": 6.385, "opt_peak_throughput": 65795.956, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30506038665771484, "max_q": -0.08646352589130402, "min_q": -0.6789490580558777}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 226500, "episodes_total": 906, "training_iteration": 151, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-33-22", "timestamp": 1579898002, "time_this_iter_s": 75.77124691009521, "time_total_s": 11495.950208187103, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11495.950208187103, "timesteps_since_restore": 226500, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 37.3, "ram_util_percent": 50.34579439252336}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.2457206731291, "mean_processing_ms": 6.075149100142949, "mean_inference_ms": 0.79190878227786}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 152, "num_steps_trained": 725000, "num_steps_sampled": 228000, "sample_time_ms": 74464.575, "replay_time_ms": 277.727, "grad_time_ms": 75.209, "update_time_ms": 6.418, "opt_peak_throughput": 66481.112, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31261277198791504, "max_q": -0.12480740994215012, "min_q": -0.9042243361473083}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 228000, "episodes_total": 912, "training_iteration": 152, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-34-37", "timestamp": 1579898077, "time_this_iter_s": 75.03355622291565, "time_total_s": 11570.983764410019, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11570.983764410019, "timesteps_since_restore": 228000, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 35.67570093457944, "ram_util_percent": 50.449532710280366}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.21746641022344, "mean_processing_ms": 6.074604254246589, "mean_inference_ms": 0.7918266664042579}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 153, "num_steps_trained": 730000, "num_steps_sampled": 229500, "sample_time_ms": 74587.516, "replay_time_ms": 277.667, "grad_time_ms": 75.163, "update_time_ms": 6.479, "opt_peak_throughput": 66522.128, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.2968255281448364, "max_q": -0.07896387577056885, "min_q": -0.6721494793891907}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 229500, "episodes_total": 918, "training_iteration": 153, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-35-53", "timestamp": 1579898153, "time_this_iter_s": 75.28960990905762, "time_total_s": 11646.273374319077, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11646.273374319077, "timesteps_since_restore": 229500, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 35.83207547169811, "ram_util_percent": 50.56698113207549}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.18862808228573, "mean_processing_ms": 6.074139187050295, "mean_inference_ms": 0.7917405232860866}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 154, "num_steps_trained": 735000, "num_steps_sampled": 231000, "sample_time_ms": 74460.996, "replay_time_ms": 279.11, "grad_time_ms": 75.19, "update_time_ms": 6.537, "opt_peak_throughput": 66497.976, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3027872145175934, "max_q": -0.08517429232597351, "min_q": -0.922626793384552}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 231000, "episodes_total": 924, "training_iteration": 154, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-37-07", "timestamp": 1579898227, "time_this_iter_s": 73.95414304733276, "time_total_s": 11720.22751736641, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11720.22751736641, "timesteps_since_restore": 231000, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 35.84095238095238, "ram_util_percent": 50.615238095238105}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.15691224272035, "mean_processing_ms": 6.073777132568195, "mean_inference_ms": 0.7916523532686098}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 155, "num_steps_trained": 740000, "num_steps_sampled": 232500, "sample_time_ms": 74287.198, "replay_time_ms": 281.819, "grad_time_ms": 75.228, "update_time_ms": 6.492, "opt_peak_throughput": 66464.909, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3130885362625122, "max_q": -0.09742703288793564, "min_q": -0.6946809887886047}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 232500, "episodes_total": 930, "training_iteration": 155, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-38-20", "timestamp": 1579898300, "time_this_iter_s": 73.45116710662842, "time_total_s": 11793.678684473038, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11793.678684473038, "timesteps_since_restore": 232500, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 34.74761904761905, "ram_util_percent": 50.74190476190477}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.12467640575755, "mean_processing_ms": 6.07348056531537, "mean_inference_ms": 0.7915651573810395}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 156, "num_steps_trained": 745000, "num_steps_sampled": 234000, "sample_time_ms": 74191.151, "replay_time_ms": 279.461, "grad_time_ms": 73.481, "update_time_ms": 6.45, "opt_peak_throughput": 68044.415, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3001335561275482, "max_q": -0.08245908468961716, "min_q": -0.9171096682548523}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 234000, "episodes_total": 936, "training_iteration": 156, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-39-35", "timestamp": 1579898375, "time_this_iter_s": 75.07473993301392, "time_total_s": 11868.753424406052, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11868.753424406052, "timesteps_since_restore": 234000, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 37.23207547169811, "ram_util_percent": 50.97924528301886}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.0914106374402, "mean_processing_ms": 6.0731906352349725, "mean_inference_ms": 0.7914761128068545}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 157, "num_steps_trained": 750000, "num_steps_sampled": 235500, "sample_time_ms": 74164.896, "replay_time_ms": 277.842, "grad_time_ms": 73.213, "update_time_ms": 6.505, "opt_peak_throughput": 68294.167, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30220359563827515, "max_q": -0.08265170454978943, "min_q": -0.6935275197029114}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 235500, "episodes_total": 942, "training_iteration": 157, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-40-50", "timestamp": 1579898450, "time_this_iter_s": 75.03462982177734, "time_total_s": 11943.788054227829, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 11943.788054227829, "timesteps_since_restore": 235500, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 36.50093457943925, "ram_util_percent": 51.1607476635514}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.0580306386068, "mean_processing_ms": 6.072844823443231, "mean_inference_ms": 0.7913871571196641}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 158, "num_steps_trained": 755000, "num_steps_sampled": 237000, "sample_time_ms": 74308.348, "replay_time_ms": 276.081, "grad_time_ms": 72.541, "update_time_ms": 6.525, "opt_peak_throughput": 68926.63, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3129148483276367, "max_q": -0.11787210404872894, "min_q": -0.6845848560333252}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 237000, "episodes_total": 948, "training_iteration": 158, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-42-05", "timestamp": 1579898525, "time_this_iter_s": 74.93661999702454, "time_total_s": 12018.724674224854, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12018.724674224854, "timesteps_since_restore": 237000, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 37.512264150943395, "ram_util_percent": 51.04245283018869}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 290.0261850425543, "mean_processing_ms": 6.072609970164786, "mean_inference_ms": 0.7913009437472053}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 159, "num_steps_trained": 760000, "num_steps_sampled": 238500, "sample_time_ms": 74384.361, "replay_time_ms": 273.274, "grad_time_ms": 71.373, "update_time_ms": 6.516, "opt_peak_throughput": 70054.235, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3088025748729706, "max_q": -0.09583592414855957, "min_q": -0.7407976984977722}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 238500, "episodes_total": 954, "training_iteration": 159, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-43-20", "timestamp": 1579898600, "time_this_iter_s": 74.44817399978638, "time_total_s": 12093.17284822464, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12093.17284822464, "timesteps_since_restore": 238500, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 36.31037735849056, "ram_util_percent": 51.1622641509434}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.99514136676174, "mean_processing_ms": 6.072431285072643, "mean_inference_ms": 0.791216289558999}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 160, "num_steps_trained": 765000, "num_steps_sampled": 240000, "sample_time_ms": 74409.538, "replay_time_ms": 274.741, "grad_time_ms": 73.116, "update_time_ms": 6.494, "opt_peak_throughput": 68384.314, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30296507477760315, "max_q": -0.07760684192180634, "min_q": -0.7390192747116089}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 240000, "episodes_total": 960, "training_iteration": 160, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-44-35", "timestamp": 1579898675, "time_this_iter_s": 74.80632877349854, "time_total_s": 12167.979176998138, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12167.979176998138, "timesteps_since_restore": 240000, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 37.48867924528301, "ram_util_percent": 51.45754716981132}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.96163374314574, "mean_processing_ms": 6.072259418667263, "mean_inference_ms": 0.7911283354160656}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 161, "num_steps_trained": 770000, "num_steps_sampled": 241500, "sample_time_ms": 74181.317, "replay_time_ms": 277.468, "grad_time_ms": 73.711, "update_time_ms": 6.379, "opt_peak_throughput": 67832.6, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3132350742816925, "max_q": -0.08861956745386124, "min_q": -0.8013324737548828}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 241500, "episodes_total": 966, "training_iteration": 161, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-45-48", "timestamp": 1579898748, "time_this_iter_s": 73.52201390266418, "time_total_s": 12241.501190900803, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12241.501190900803, "timesteps_since_restore": 241500, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 35.05384615384615, "ram_util_percent": 51.54038461538461}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.9273479099418, "mean_processing_ms": 6.072050932994552, "mean_inference_ms": 0.7910392141532858}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 162, "num_steps_trained": 775000, "num_steps_sampled": 243000, "sample_time_ms": 74142.498, "replay_time_ms": 277.642, "grad_time_ms": 73.716, "update_time_ms": 6.408, "opt_peak_throughput": 67827.839, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3091440796852112, "max_q": -0.08547145873308182, "min_q": -0.682934045791626}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 243000, "episodes_total": 972, "training_iteration": 162, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-47-03", "timestamp": 1579898823, "time_this_iter_s": 74.64720892906189, "time_total_s": 12316.148399829865, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12316.148399829865, "timesteps_since_restore": 243000, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 37.62547169811321, "ram_util_percent": 51.44433962264149}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.89317388322763, "mean_processing_ms": 6.071826033296508, "mean_inference_ms": 0.7909508567817014}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 163, "num_steps_trained": 780000, "num_steps_sampled": 244500, "sample_time_ms": 74182.562, "replay_time_ms": 277.599, "grad_time_ms": 73.839, "update_time_ms": 6.421, "opt_peak_throughput": 67714.874, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30013373494148254, "max_q": -0.07516264170408249, "min_q": -0.779576301574707}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 244500, "episodes_total": 978, "training_iteration": 163, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-48-18", "timestamp": 1579898898, "time_this_iter_s": 75.69133496284485, "time_total_s": 12391.83973479271, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12391.83973479271, "timesteps_since_restore": 244500, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 38.04205607476636, "ram_util_percent": 51.52242990654207}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.8598555389663, "mean_processing_ms": 6.071706118973739, "mean_inference_ms": 0.7908658905298444}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 164, "num_steps_trained": 785000, "num_steps_sampled": 246000, "sample_time_ms": 74282.808, "replay_time_ms": 274.535, "grad_time_ms": 72.609, "update_time_ms": 6.424, "opt_peak_throughput": 68862.308, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3103698194026947, "max_q": -0.09220948815345764, "min_q": -0.9172614812850952}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 246000, "episodes_total": 984, "training_iteration": 164, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-49-33", "timestamp": 1579898973, "time_this_iter_s": 74.91508316993713, "time_total_s": 12466.754817962646, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12466.754817962646, "timesteps_since_restore": 246000, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 36.78691588785047, "ram_util_percent": 51.62897196261685}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.82875666224606, "mean_processing_ms": 6.071576411970924, "mean_inference_ms": 0.79078734472766}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 165, "num_steps_trained": 790000, "num_steps_sampled": 247500, "sample_time_ms": 74398.038, "replay_time_ms": 272.93, "grad_time_ms": 72.358, "update_time_ms": 6.363, "opt_peak_throughput": 69100.506, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30850347876548767, "max_q": -0.09857945144176483, "min_q": -0.6671248078346252}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 247500, "episodes_total": 990, "training_iteration": 165, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-50-48", "timestamp": 1579899048, "time_this_iter_s": 74.58440589904785, "time_total_s": 12541.339223861694, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12541.339223861694, "timesteps_since_restore": 247500, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 35.404716981132076, "ram_util_percent": 51.70754716981133}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.7975940072921, "mean_processing_ms": 6.07149751078325, "mean_inference_ms": 0.7907096676047525}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 166, "num_steps_trained": 795000, "num_steps_sampled": 249000, "sample_time_ms": 74260.904, "replay_time_ms": 276.148, "grad_time_ms": 73.034, "update_time_ms": 6.35, "opt_peak_throughput": 68460.884, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3042859733104706, "max_q": -0.08655653893947601, "min_q": -0.6737518310546875}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 249000, "episodes_total": 996, "training_iteration": 166, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-52-02", "timestamp": 1579899122, "time_this_iter_s": 73.74226880073547, "time_total_s": 12615.08149266243, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12615.08149266243, "timesteps_since_restore": 249000, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 34.95288461538461, "ram_util_percent": 51.79038461538461}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.76510337168315, "mean_processing_ms": 6.071423796551601, "mean_inference_ms": 0.7906272463870897}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 167, "num_steps_trained": 800000, "num_steps_sampled": 250500, "sample_time_ms": 74134.68, "replay_time_ms": 275.882, "grad_time_ms": 72.389, "update_time_ms": 6.315, "opt_peak_throughput": 69071.17, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3124768137931824, "max_q": -0.10251717269420624, "min_q": -0.7599365711212158}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 250500, "episodes_total": 1002, "training_iteration": 167, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-53-16", "timestamp": 1579899196, "time_this_iter_s": 73.7625048160553, "time_total_s": 12688.843997478485, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12688.843997478485, "timesteps_since_restore": 250500, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 34.7095238095238, "ram_util_percent": 51.9095238095238}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.73169080335975, "mean_processing_ms": 6.071244499366258, "mean_inference_ms": 0.7905426525817087}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 168, "num_steps_trained": 805000, "num_steps_sampled": 252000, "sample_time_ms": 74116.23, "replay_time_ms": 274.407, "grad_time_ms": 72.855, "update_time_ms": 6.362, "opt_peak_throughput": 68629.384, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3127186596393585, "max_q": -0.10276108980178833, "min_q": -0.9029750823974609}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 252000, "episodes_total": 1008, "training_iteration": 168, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-54-30", "timestamp": 1579899270, "time_this_iter_s": 74.74222493171692, "time_total_s": 12763.586222410202, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12763.586222410202, "timesteps_since_restore": 252000, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 35.78867924528302, "ram_util_percent": 52.016037735849075}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.6989395570765, "mean_processing_ms": 6.071161743164496, "mean_inference_ms": 0.7904578793760878}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 169, "num_steps_trained": 810000, "num_steps_sampled": 253500, "sample_time_ms": 74204.549, "replay_time_ms": 274.851, "grad_time_ms": 72.962, "update_time_ms": 6.366, "opt_peak_throughput": 68529.071, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30655911564826965, "max_q": -0.1101573184132576, "min_q": -0.670975923538208}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 253500, "episodes_total": 1014, "training_iteration": 169, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-55-46", "timestamp": 1579899346, "time_this_iter_s": 75.33640003204346, "time_total_s": 12838.922622442245, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12838.922622442245, "timesteps_since_restore": 253500, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 38.17289719626168, "ram_util_percent": 52.14112149532712}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.66682851203956, "mean_processing_ms": 6.070992446200097, "mean_inference_ms": 0.7903772874881726}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 170, "num_steps_trained": 815000, "num_steps_sampled": 255000, "sample_time_ms": 74233.307, "replay_time_ms": 271.898, "grad_time_ms": 70.976, "update_time_ms": 6.384, "opt_peak_throughput": 70446.613, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3136373460292816, "max_q": -0.09456043690443039, "min_q": -0.6989238262176514}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 255000, "episodes_total": 1020, "training_iteration": 170, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-57-01", "timestamp": 1579899421, "time_this_iter_s": 75.0430519580841, "time_total_s": 12913.96567440033, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12913.96567440033, "timesteps_since_restore": 255000, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 37.700943396226414, "ram_util_percent": 52.14811320754717}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.63624467464524, "mean_processing_ms": 6.070865813157302, "mean_inference_ms": 0.7902997164293535}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 171, "num_steps_trained": 820000, "num_steps_sampled": 256500, "sample_time_ms": 74332.041, "replay_time_ms": 273.293, "grad_time_ms": 71.079, "update_time_ms": 6.419, "opt_peak_throughput": 70343.825, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31178492307662964, "max_q": -0.08592315018177032, "min_q": -0.7035529613494873}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 256500, "episodes_total": 1026, "training_iteration": 171, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-58-15", "timestamp": 1579899495, "time_this_iter_s": 74.52409172058105, "time_total_s": 12988.48976612091, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 12988.48976612091, "timesteps_since_restore": 256500, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 36.67924528301887, "ram_util_percent": 52.17735849056604}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.6058169634719, "mean_processing_ms": 6.070700959171728, "mean_inference_ms": 0.7902222758205144}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 172, "num_steps_trained": 825000, "num_steps_sampled": 258000, "sample_time_ms": 74247.705, "replay_time_ms": 274.122, "grad_time_ms": 72.562, "update_time_ms": 6.339, "opt_peak_throughput": 68906.248, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3041995167732239, "max_q": -0.09341815114021301, "min_q": -0.6685962677001953}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 258000, "episodes_total": 1032, "training_iteration": 172, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_21-59-29", "timestamp": 1579899569, "time_this_iter_s": 73.8253231048584, "time_total_s": 13062.315089225769, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13062.315089225769, "timesteps_since_restore": 258000, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 35.212380952380954, "ram_util_percent": 52.32380952380952}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.5753570389245, "mean_processing_ms": 6.070624013698276, "mean_inference_ms": 0.7901429230001895}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 173, "num_steps_trained": 830000, "num_steps_sampled": 259500, "sample_time_ms": 74150.449, "replay_time_ms": 273.886, "grad_time_ms": 72.552, "update_time_ms": 6.287, "opt_peak_throughput": 68916.324, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31225281953811646, "max_q": -0.08883938938379288, "min_q": -0.8073639273643494}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 259500, "episodes_total": 1038, "training_iteration": 173, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-00-44", "timestamp": 1579899644, "time_this_iter_s": 74.71634101867676, "time_total_s": 13137.031430244446, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13137.031430244446, "timesteps_since_restore": 259500, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 36.18301886792453, "ram_util_percent": 52.400943396226396}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.54530827050746, "mean_processing_ms": 6.070577868736223, "mean_inference_ms": 0.7900658307261866}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 174, "num_steps_trained": 835000, "num_steps_sampled": 261000, "sample_time_ms": 74177.442, "replay_time_ms": 273.773, "grad_time_ms": 72.644, "update_time_ms": 6.317, "opt_peak_throughput": 68828.994, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31567835807800293, "max_q": -0.09390684962272644, "min_q": -0.7056261301040649}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 261000, "episodes_total": 1044, "training_iteration": 174, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-01-59", "timestamp": 1579899719, "time_this_iter_s": 75.18486213684082, "time_total_s": 13212.216292381287, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13212.216292381287, "timesteps_since_restore": 261000, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 38.09906542056075, "ram_util_percent": 52.42149532710279}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.5166863232186, "mean_processing_ms": 6.070532640015316, "mean_inference_ms": 0.7899939965469376}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 175, "num_steps_trained": 840000, "num_steps_sampled": 262500, "sample_time_ms": 74285.889, "replay_time_ms": 273.102, "grad_time_ms": 73.087, "update_time_ms": 6.364, "opt_peak_throughput": 68411.73, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30798056721687317, "max_q": -0.09730252623558044, "min_q": -0.6868235468864441}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 262500, "episodes_total": 1050, "training_iteration": 175, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-03-15", "timestamp": 1579899795, "time_this_iter_s": 75.66779804229736, "time_total_s": 13287.884090423584, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13287.884090423584, "timesteps_since_restore": 262500, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 36.31682242990654, "ram_util_percent": 52.53177570093458}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.48807940259917, "mean_processing_ms": 6.0704471973646745, "mean_inference_ms": 0.7899247131930462}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 176, "num_steps_trained": 845000, "num_steps_sampled": 264000, "sample_time_ms": 74359.253, "replay_time_ms": 271.881, "grad_time_ms": 73.557, "update_time_ms": 6.457, "opt_peak_throughput": 67974.06, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3151918947696686, "max_q": -0.10025745630264282, "min_q": -0.7639413475990295}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 264000, "episodes_total": 1056, "training_iteration": 176, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-04-29", "timestamp": 1579899869, "time_this_iter_s": 74.46874690055847, "time_total_s": 13362.352837324142, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13362.352837324142, "timesteps_since_restore": 264000, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 36.050943396226415, "ram_util_percent": 52.658490566037734}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.4591412632657, "mean_processing_ms": 6.0703962509255485, "mean_inference_ms": 0.7898549443608007}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 177, "num_steps_trained": 850000, "num_steps_sampled": 265500, "sample_time_ms": 74356.622, "replay_time_ms": 273.978, "grad_time_ms": 74.494, "update_time_ms": 6.425, "opt_peak_throughput": 67119.861, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31672176718711853, "max_q": -0.09461433440446854, "min_q": -0.7001264691352844}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 265500, "episodes_total": 1062, "training_iteration": 177, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-05-43", "timestamp": 1579899943, "time_this_iter_s": 73.76568913459778, "time_total_s": 13436.11852645874, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13436.11852645874, "timesteps_since_restore": 265500, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 35.72980769230769, "ram_util_percent": 52.698076923076925}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.4322445417591, "mean_processing_ms": 6.070298731265544, "mean_inference_ms": 0.7897892988095367}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 178, "num_steps_trained": 855000, "num_steps_sampled": 267000, "sample_time_ms": 74381.992, "replay_time_ms": 274.178, "grad_time_ms": 73.956, "update_time_ms": 6.35, "opt_peak_throughput": 67607.864, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30893465876579285, "max_q": -0.10174281895160675, "min_q": -0.7147177457809448}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 267000, "episodes_total": 1068, "training_iteration": 178, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-06-58", "timestamp": 1579900018, "time_this_iter_s": 74.99192118644714, "time_total_s": 13511.110447645187, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13511.110447645187, "timesteps_since_restore": 267000, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 36.55140186915888, "ram_util_percent": 52.80934579439253}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.40605564332543, "mean_processing_ms": 6.0702716341569865, "mean_inference_ms": 0.7897250066614353}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 179, "num_steps_trained": 860000, "num_steps_sampled": 268500, "sample_time_ms": 74382.424, "replay_time_ms": 273.95, "grad_time_ms": 74.63, "update_time_ms": 6.35, "opt_peak_throughput": 66997.552, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.30900752544403076, "max_q": -0.09709828346967697, "min_q": -0.6564638018608093}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 268500, "episodes_total": 1074, "training_iteration": 179, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-08-13", "timestamp": 1579900093, "time_this_iter_s": 75.34510898590088, "time_total_s": 13586.455556631088, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13586.455556631088, "timesteps_since_restore": 268500, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 37.03301886792453, "ram_util_percent": 52.93962264150943}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.3797152065328, "mean_processing_ms": 6.070225906330434, "mean_inference_ms": 0.7896600323496525}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 180, "num_steps_trained": 865000, "num_steps_sampled": 270000, "sample_time_ms": 74383.54, "replay_time_ms": 274.408, "grad_time_ms": 75.515, "update_time_ms": 6.309, "opt_peak_throughput": 66211.858, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32024335861206055, "max_q": -0.11454885452985764, "min_q": -0.8322871327400208}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 270000, "episodes_total": 1080, "training_iteration": 180, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-09-28", "timestamp": 1579900168, "time_this_iter_s": 75.0674500465393, "time_total_s": 13661.523006677628, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13661.523006677628, "timesteps_since_restore": 270000, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 36.603738317757, "ram_util_percent": 53.03644859813084}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.3529320170403, "mean_processing_ms": 6.070092867774411, "mean_inference_ms": 0.7895954938975543}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 181, "num_steps_trained": 870000, "num_steps_sampled": 271500, "sample_time_ms": 74365.555, "replay_time_ms": 271.979, "grad_time_ms": 75.917, "update_time_ms": 6.336, "opt_peak_throughput": 65861.19, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3090798854827881, "max_q": -0.09787412732839584, "min_q": -0.7417016625404358}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 271500, "episodes_total": 1086, "training_iteration": 181, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-10-43", "timestamp": 1579900243, "time_this_iter_s": 74.323814868927, "time_total_s": 13735.846821546555, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13735.846821546555, "timesteps_since_restore": 271500, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 36.11333333333333, "ram_util_percent": 53.02285714285715}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.3249849073314, "mean_processing_ms": 6.069962629805004, "mean_inference_ms": 0.7895286328779858}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 182, "num_steps_trained": 875000, "num_steps_sampled": 273000, "sample_time_ms": 74306.543, "replay_time_ms": 274.423, "grad_time_ms": 75.285, "update_time_ms": 6.352, "opt_peak_throughput": 66413.93, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3099677860736847, "max_q": -0.10145160555839539, "min_q": -0.7585160732269287}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 273000, "episodes_total": 1092, "training_iteration": 182, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-11-56", "timestamp": 1579900316, "time_this_iter_s": 73.25387215614319, "time_total_s": 13809.100693702698, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13809.100693702698, "timesteps_since_restore": 273000, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 35.65, "ram_util_percent": 53.109615384615395}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.2990181189479, "mean_processing_ms": 6.069855680837448, "mean_inference_ms": 0.7894672229755855}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 183, "num_steps_trained": 880000, "num_steps_sampled": 274500, "sample_time_ms": 74294.526, "replay_time_ms": 274.597, "grad_time_ms": 75.294, "update_time_ms": 6.38, "opt_peak_throughput": 66406.759, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31845590472221375, "max_q": -0.10572009533643723, "min_q": -0.8043141961097717}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 274500, "episodes_total": 1098, "training_iteration": 183, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-13-11", "timestamp": 1579900391, "time_this_iter_s": 74.59724712371826, "time_total_s": 13883.697940826416, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13883.697940826416, "timesteps_since_restore": 274500, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 37.58207547169811, "ram_util_percent": 53.20377358490566}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.2753583866633, "mean_processing_ms": 6.069804135384476, "mean_inference_ms": 0.7894095069915729}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 184, "num_steps_trained": 885000, "num_steps_sampled": 276000, "sample_time_ms": 74329.203, "replay_time_ms": 274.948, "grad_time_ms": 75.294, "update_time_ms": 6.348, "opt_peak_throughput": 66406.212, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3145436942577362, "max_q": -0.1011044979095459, "min_q": -0.6807331442832947}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 276000, "episodes_total": 1104, "training_iteration": 184, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-14-26", "timestamp": 1579900466, "time_this_iter_s": 75.53395104408264, "time_total_s": 13959.231891870499, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 13959.231891870499, "timesteps_since_restore": 276000, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 38.50280373831776, "ram_util_percent": 53.29252336448597}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.2523371591785, "mean_processing_ms": 6.069781474119874, "mean_inference_ms": 0.7893545074663783}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 185, "num_steps_trained": 890000, "num_steps_sampled": 277500, "sample_time_ms": 74283.163, "replay_time_ms": 274.482, "grad_time_ms": 75.343, "update_time_ms": 6.394, "opt_peak_throughput": 66363.113, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3115784525871277, "max_q": -0.09880861639976501, "min_q": -0.8168386816978455}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 277500, "episodes_total": 1110, "training_iteration": 185, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-15-42", "timestamp": 1579900542, "time_this_iter_s": 75.20325517654419, "time_total_s": 14034.435147047043, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14034.435147047043, "timesteps_since_restore": 277500, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 35.44766355140187, "ram_util_percent": 53.33364485981308}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.2280842588046, "mean_processing_ms": 6.069702252993801, "mean_inference_ms": 0.7892987619640793}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 186, "num_steps_trained": 895000, "num_steps_sampled": 279000, "sample_time_ms": 74274.67, "replay_time_ms": 274.87, "grad_time_ms": 74.545, "update_time_ms": 6.325, "opt_peak_throughput": 67073.535, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3200420141220093, "max_q": -0.10705722123384476, "min_q": -0.7438606023788452}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 279000, "episodes_total": 1116, "training_iteration": 186, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-16-56", "timestamp": 1579900616, "time_this_iter_s": 74.37912178039551, "time_total_s": 14108.814268827438, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14108.814268827438, "timesteps_since_restore": 279000, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 34.45471698113208, "ram_util_percent": 53.407547169811295}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.20283512829576, "mean_processing_ms": 6.069656649316548, "mean_inference_ms": 0.7892401263039882}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 187, "num_steps_trained": 900000, "num_steps_sampled": 280500, "sample_time_ms": 74304.672, "replay_time_ms": 275.964, "grad_time_ms": 74.875, "update_time_ms": 6.331, "opt_peak_throughput": 66777.838, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3163227438926697, "max_q": -0.09757279604673386, "min_q": -0.7557677626609802}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 280500, "episodes_total": 1122, "training_iteration": 187, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-18-10", "timestamp": 1579900690, "time_this_iter_s": 74.08010911941528, "time_total_s": 14182.894377946854, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14182.894377946854, "timesteps_since_restore": 280500, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 34.97333333333333, "ram_util_percent": 53.5152380952381}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1796188314913, "mean_processing_ms": 6.069573858389247, "mean_inference_ms": 0.7891856825942359}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 188, "num_steps_trained": 905000, "num_steps_sampled": 282000, "sample_time_ms": 74340.055, "replay_time_ms": 275.495, "grad_time_ms": 75.875, "update_time_ms": 6.339, "opt_peak_throughput": 65898.255, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31302735209465027, "max_q": -0.09281449764966965, "min_q": -0.7076765894889832}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 282000, "episodes_total": 1128, "training_iteration": 188, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-19-25", "timestamp": 1579900765, "time_this_iter_s": 75.35194683074951, "time_total_s": 14258.246324777603, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14258.246324777603, "timesteps_since_restore": 282000, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 37.61682242990655, "ram_util_percent": 53.63177570093459}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.15841903072015, "mean_processing_ms": 6.069493397935186, "mean_inference_ms": 0.7891351626189004}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 189, "num_steps_trained": 910000, "num_steps_sampled": 283500, "sample_time_ms": 74341.818, "replay_time_ms": 275.419, "grad_time_ms": 75.343, "update_time_ms": 6.334, "opt_peak_throughput": 66363.071, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3218282163143158, "max_q": -0.09798538684844971, "min_q": -0.691464900970459}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 283500, "episodes_total": 1134, "training_iteration": 189, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-20-41", "timestamp": 1579900841, "time_this_iter_s": 75.35692310333252, "time_total_s": 14333.603247880936, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14333.603247880936, "timesteps_since_restore": 283500, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 37.844859813084106, "ram_util_percent": 53.711214953271025}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.13721669525177, "mean_processing_ms": 6.069391481971857, "mean_inference_ms": 0.7890844730581464}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 190, "num_steps_trained": 915000, "num_steps_sampled": 285000, "sample_time_ms": 74315.255, "replay_time_ms": 276.55, "grad_time_ms": 74.815, "update_time_ms": 6.422, "opt_peak_throughput": 66831.614, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31673702597618103, "max_q": -0.10574690997600555, "min_q": -0.749670147895813}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 285000, "episodes_total": 1140, "training_iteration": 190, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-21-56", "timestamp": 1579900916, "time_this_iter_s": 74.81000709533691, "time_total_s": 14408.413254976273, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14408.413254976273, "timesteps_since_restore": 285000, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 36.637735849056604, "ram_util_percent": 53.79811320754717}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1137939356462, "mean_processing_ms": 6.0693297850289305, "mean_inference_ms": 0.789026743699187}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 191, "num_steps_trained": 920000, "num_steps_sampled": 286500, "sample_time_ms": 74244.625, "replay_time_ms": 278.507, "grad_time_ms": 73.616, "update_time_ms": 6.474, "opt_peak_throughput": 67920.41, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31075558066368103, "max_q": -0.09594797343015671, "min_q": -0.7325367331504822}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 286500, "episodes_total": 1146, "training_iteration": 191, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-23-09", "timestamp": 1579900989, "time_this_iter_s": 73.62598609924316, "time_total_s": 14482.039241075516, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14482.039241075516, "timesteps_since_restore": 286500, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 35.05, "ram_util_percent": 53.90480769230768}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.089810690465, "mean_processing_ms": 6.069235550139194, "mean_inference_ms": 0.7889660171884911}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 192, "num_steps_trained": 925000, "num_steps_sampled": 288000, "sample_time_ms": 74379.293, "replay_time_ms": 274.721, "grad_time_ms": 73.466, "update_time_ms": 6.481, "opt_peak_throughput": 68058.967, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3201979398727417, "max_q": -0.11760811507701874, "min_q": -0.822275698184967}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 288000, "episodes_total": 1152, "training_iteration": 192, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-24-24", "timestamp": 1579901064, "time_this_iter_s": 74.56210517883301, "time_total_s": 14556.601346254349, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14556.601346254349, "timesteps_since_restore": 288000, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 36.258490566037736, "ram_util_percent": 54.022641509433974}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.06786776919876, "mean_processing_ms": 6.069120361266905, "mean_inference_ms": 0.7889110204070511}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 193, "num_steps_trained": 930000, "num_steps_sampled": 289500, "sample_time_ms": 74461.589, "replay_time_ms": 274.65, "grad_time_ms": 73.924, "update_time_ms": 6.548, "opt_peak_throughput": 67637.388, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32114365696907043, "max_q": -0.12350782006978989, "min_q": -0.8548627495765686}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 289500, "episodes_total": 1158, "training_iteration": 193, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-25-39", "timestamp": 1579901139, "time_this_iter_s": 75.42552709579468, "time_total_s": 14632.026873350143, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14632.026873350143, "timesteps_since_restore": 289500, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 37.79345794392523, "ram_util_percent": 54.00747663551402}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0480922237911, "mean_processing_ms": 6.068965126744135, "mean_inference_ms": 0.7888624809790525}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 194, "num_steps_trained": 935000, "num_steps_sampled": 291000, "sample_time_ms": 74465.012, "replay_time_ms": 274.219, "grad_time_ms": 74.219, "update_time_ms": 6.493, "opt_peak_throughput": 67368.01, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3146112859249115, "max_q": -0.09953861683607101, "min_q": -0.681864857673645}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 291000, "episodes_total": 1164, "training_iteration": 194, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-26-55", "timestamp": 1579901215, "time_this_iter_s": 75.5665111541748, "time_total_s": 14707.593384504318, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14707.593384504318, "timesteps_since_restore": 291000, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 39.14485981308411, "ram_util_percent": 54.16728971962618}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.02805984231736, "mean_processing_ms": 6.0688351675410255, "mean_inference_ms": 0.7888135452936929}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 195, "num_steps_trained": 940000, "num_steps_sampled": 292500, "sample_time_ms": 74427.101, "replay_time_ms": 276.165, "grad_time_ms": 74.578, "update_time_ms": 6.384, "opt_peak_throughput": 67043.708, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.322858065366745, "max_q": -0.11043398082256317, "min_q": -0.7512493133544922}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 292500, "episodes_total": 1170, "training_iteration": 195, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-28-10", "timestamp": 1579901290, "time_this_iter_s": 74.84468483924866, "time_total_s": 14782.438069343567, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14782.438069343567, "timesteps_since_restore": 292500, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 37.11682242990654, "ram_util_percent": 54.39906542056074}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0074314848925, "mean_processing_ms": 6.068708189630102, "mean_inference_ms": 0.7887633360593574}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 196, "num_steps_trained": 945000, "num_steps_sampled": 294000, "sample_time_ms": 74484.624, "replay_time_ms": 276.836, "grad_time_ms": 74.17, "update_time_ms": 6.406, "opt_peak_throughput": 67412.967, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3237663805484772, "max_q": -0.10587470978498459, "min_q": -0.7579684853553772}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 294000, "episodes_total": 1176, "training_iteration": 196, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-29-25", "timestamp": 1579901365, "time_this_iter_s": 74.95727896690369, "time_total_s": 14857.39534831047, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14857.39534831047, "timesteps_since_restore": 294000, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 37.282075471698114, "ram_util_percent": 54.46886792452829}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9894257963522, "mean_processing_ms": 6.068586121225823, "mean_inference_ms": 0.788719163434868}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 197, "num_steps_trained": 950000, "num_steps_sampled": 295500, "sample_time_ms": 74767.122, "replay_time_ms": 273.965, "grad_time_ms": 73.017, "update_time_ms": 6.406, "opt_peak_throughput": 68477.292, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3139975368976593, "max_q": -0.09359074383974075, "min_q": -0.6543397307395935}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 295500, "episodes_total": 1182, "training_iteration": 197, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-30-42", "timestamp": 1579901442, "time_this_iter_s": 76.86591267585754, "time_total_s": 14934.261260986328, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 14934.261260986328, "timesteps_since_restore": 295500, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 38.93761467889908, "ram_util_percent": 54.49449541284405}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9758077337692, "mean_processing_ms": 6.0684533700802445, "mean_inference_ms": 0.7886843865650323}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 198, "num_steps_trained": 955000, "num_steps_sampled": 297000, "sample_time_ms": 74970.727, "replay_time_ms": 276.911, "grad_time_ms": 72.689, "update_time_ms": 6.463, "opt_peak_throughput": 68786.281, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32042720913887024, "max_q": -0.09880797564983368, "min_q": -0.7434161305427551}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 297000, "episodes_total": 1188, "training_iteration": 198, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-31-59", "timestamp": 1579901519, "time_this_iter_s": 77.41462111473083, "time_total_s": 15011.675882101059, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15011.675882101059, "timesteps_since_restore": 297000, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 40.03545454545455, "ram_util_percent": 54.523636363636385}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.96646497000273, "mean_processing_ms": 6.068323281158731, "mean_inference_ms": 0.7886571539712304}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 199, "num_steps_trained": 960000, "num_steps_sampled": 298500, "sample_time_ms": 75143.496, "replay_time_ms": 279.828, "grad_time_ms": 72.789, "update_time_ms": 6.426, "opt_peak_throughput": 68691.472, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3220313489437103, "max_q": -0.09653018414974213, "min_q": -0.7506803274154663}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 298500, "episodes_total": 1194, "training_iteration": 199, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-33-16", "timestamp": 1579901596, "time_this_iter_s": 77.11382794380188, "time_total_s": 15088.78971004486, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15088.78971004486, "timesteps_since_restore": 298500, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 39.533944954128444, "ram_util_percent": 54.66605504587157}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.95847731748216, "mean_processing_ms": 6.068204166314567, "mean_inference_ms": 0.7886330406128317}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 200, "num_steps_trained": 965000, "num_steps_sampled": 300000, "sample_time_ms": 75278.982, "replay_time_ms": 282.022, "grad_time_ms": 73.273, "update_time_ms": 6.319, "opt_peak_throughput": 68238.256, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.31734034419059753, "max_q": -0.11168903112411499, "min_q": -0.659432053565979}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 300000, "episodes_total": 1200, "training_iteration": 200, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-34-32", "timestamp": 1579901672, "time_this_iter_s": 76.18960785865784, "time_total_s": 15164.979317903519, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15164.979317903519, "timesteps_since_restore": 300000, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 38.404629629629625, "ram_util_percent": 54.75092592592591}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.95192335359866, "mean_processing_ms": 6.068100113676314, "mean_inference_ms": 0.7886132629704027}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 201, "num_steps_trained": 970000, "num_steps_sampled": 301500, "sample_time_ms": 75594.399, "replay_time_ms": 283.825, "grad_time_ms": 73.724, "update_time_ms": 6.256, "opt_peak_throughput": 67820.798, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3191933035850525, "max_q": -0.0993347316980362, "min_q": -0.6721327900886536}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 301500, "episodes_total": 1206, "training_iteration": 201, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-35-49", "timestamp": 1579901749, "time_this_iter_s": 76.80105090141296, "time_total_s": 15241.780368804932, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15241.780368804932, "timesteps_since_restore": 301500, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 39.08073394495413, "ram_util_percent": 54.7394495412844}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9479684067497, "mean_processing_ms": 6.068033252949997, "mean_inference_ms": 0.7885993838044957}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 202, "num_steps_trained": 975000, "num_steps_sampled": 303000, "sample_time_ms": 75853.079, "replay_time_ms": 285.575, "grad_time_ms": 73.723, "update_time_ms": 6.238, "opt_peak_throughput": 67820.995, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3249070644378662, "max_q": -0.09656031429767609, "min_q": -0.6940792798995972}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 303000, "episodes_total": 1212, "training_iteration": 202, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-37-06", "timestamp": 1579901826, "time_this_iter_s": 77.1656379699707, "time_total_s": 15318.946006774902, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15318.946006774902, "timesteps_since_restore": 303000, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 39.6890909090909, "ram_util_percent": 54.86545454545453}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9462752906194, "mean_processing_ms": 6.068052973353458, "mean_inference_ms": 0.7885898443092115}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 203, "num_steps_trained": 980000, "num_steps_sampled": 304500, "sample_time_ms": 75907.812, "replay_time_ms": 289.759, "grad_time_ms": 73.648, "update_time_ms": 6.142, "opt_peak_throughput": 67890.528, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3210892081260681, "max_q": -0.10678280889987946, "min_q": -0.661719799041748}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 304500, "episodes_total": 1218, "training_iteration": 203, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-38-23", "timestamp": 1579901903, "time_this_iter_s": 76.01340579986572, "time_total_s": 15394.959412574768, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15394.959412574768, "timesteps_since_restore": 304500, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 39.023148148148145, "ram_util_percent": 54.97870370370371}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9477114638187, "mean_processing_ms": 6.068098554816523, "mean_inference_ms": 0.788590178545586}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 204, "num_steps_trained": 985000, "num_steps_sampled": 306000, "sample_time_ms": 76051.575, "replay_time_ms": 290.17, "grad_time_ms": 73.815, "update_time_ms": 6.126, "opt_peak_throughput": 67737.118, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32588085532188416, "max_q": -0.10086327791213989, "min_q": -0.6688277721405029}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 306000, "episodes_total": 1224, "training_iteration": 204, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-39-40", "timestamp": 1579901980, "time_this_iter_s": 77.0094211101532, "time_total_s": 15471.968833684921, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15471.968833684921, "timesteps_since_restore": 306000, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 40.710091743119264, "ram_util_percent": 55.045871559633035}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9512071122473, "mean_processing_ms": 6.068116783472745, "mean_inference_ms": 0.7885964103891133}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 205, "num_steps_trained": 990000, "num_steps_sampled": 307500, "sample_time_ms": 76274.624, "replay_time_ms": 287.821, "grad_time_ms": 73.266, "update_time_ms": 6.197, "opt_peak_throughput": 68244.674, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32279172539711, "max_q": -0.11141752451658249, "min_q": -0.7221052646636963}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 307500, "episodes_total": 1230, "training_iteration": 205, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-40-57", "timestamp": 1579902057, "time_this_iter_s": 77.0485429763794, "time_total_s": 15549.0173766613, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15549.0173766613, "timesteps_since_restore": 307500, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 39.413636363636364, "ram_util_percent": 55.1118181818182}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.95583607787654, "mean_processing_ms": 6.068192701382328, "mean_inference_ms": 0.7886063366954132}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 206, "num_steps_trained": 995000, "num_steps_sampled": 309000, "sample_time_ms": 76406.813, "replay_time_ms": 288.485, "grad_time_ms": 74.328, "update_time_ms": 6.161, "opt_peak_throughput": 67269.212, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3206951320171356, "max_q": -0.10319026559591293, "min_q": -0.7491288185119629}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 309000, "episodes_total": 1236, "training_iteration": 206, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-42-13", "timestamp": 1579902133, "time_this_iter_s": 76.29702615737915, "time_total_s": 15625.31440281868, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15625.31440281868, "timesteps_since_restore": 309000, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 38.19444444444444, "ram_util_percent": 55.18333333333334}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9625809358516, "mean_processing_ms": 6.068290634149713, "mean_inference_ms": 0.7886203953282833}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 207, "num_steps_trained": 1000000, "num_steps_sampled": 310500, "sample_time_ms": 76333.549, "replay_time_ms": 290.76, "grad_time_ms": 75.112, "update_time_ms": 6.174, "opt_peak_throughput": 66567.167, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3242943286895752, "max_q": -0.10256846994161606, "min_q": -0.7226267457008362}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 310500, "episodes_total": 1242, "training_iteration": 207, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-43-29", "timestamp": 1579902209, "time_this_iter_s": 76.1641137599945, "time_total_s": 15701.478516578674, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15701.478516578674, "timesteps_since_restore": 310500, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 37.06574074074074, "ram_util_percent": 55.2574074074074}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9733424920811, "mean_processing_ms": 6.06836379592119, "mean_inference_ms": 0.7886457717091747}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 208, "num_steps_trained": 1005000, "num_steps_sampled": 312000, "sample_time_ms": 76312.395, "replay_time_ms": 287.785, "grad_time_ms": 74.818, "update_time_ms": 6.113, "opt_peak_throughput": 66828.675, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3213142454624176, "max_q": -0.09726407378911972, "min_q": -0.6901776790618896}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 312000, "episodes_total": 1248, "training_iteration": 208, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-44-46", "timestamp": 1579902286, "time_this_iter_s": 77.16880416870117, "time_total_s": 15778.647320747375, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15778.647320747375, "timesteps_since_restore": 312000, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 40.07706422018347, "ram_util_percent": 55.341284403669704}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.98651344230075, "mean_processing_ms": 6.068441717175429, "mean_inference_ms": 0.7886760851009477}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 209, "num_steps_trained": 1010000, "num_steps_sampled": 313500, "sample_time_ms": 76302.097, "replay_time_ms": 285.757, "grad_time_ms": 75.66, "update_time_ms": 6.201, "opt_peak_throughput": 66084.876, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3268069326877594, "max_q": -0.10507773607969284, "min_q": -0.8263880014419556}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 313500, "episodes_total": 1254, "training_iteration": 209, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-46-03", "timestamp": 1579902363, "time_this_iter_s": 77.00131702423096, "time_total_s": 15855.648637771606, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15855.648637771606, "timesteps_since_restore": 313500, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 40.14181818181819, "ram_util_percent": 55.43727272727271}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0008356737835, "mean_processing_ms": 6.068571061355776, "mean_inference_ms": 0.78870768308968}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 210, "num_steps_trained": 1015000, "num_steps_sampled": 315000, "sample_time_ms": 76363.591, "replay_time_ms": 286.685, "grad_time_ms": 75.479, "update_time_ms": 6.205, "opt_peak_throughput": 66243.794, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3261759877204895, "max_q": -0.09399009495973587, "min_q": -0.6983398795127869}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 315000, "episodes_total": 1260, "training_iteration": 210, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-47-20", "timestamp": 1579902440, "time_this_iter_s": 76.8128662109375, "time_total_s": 15932.461503982544, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 15932.461503982544, "timesteps_since_restore": 315000, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 38.3788990825688, "ram_util_percent": 55.47247706422017}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.01614384836057, "mean_processing_ms": 6.068768152784847, "mean_inference_ms": 0.788741351740672}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 211, "num_steps_trained": 1020000, "num_steps_sampled": 316500, "sample_time_ms": 76314.92, "replay_time_ms": 281.445, "grad_time_ms": 75.133, "update_time_ms": 6.18, "opt_peak_throughput": 66548.304, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3284617066383362, "max_q": -0.10289697349071503, "min_q": -0.7093942165374756}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 316500, "episodes_total": 1266, "training_iteration": 211, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-48-36", "timestamp": 1579902516, "time_this_iter_s": 76.25974297523499, "time_total_s": 16008.721246957779, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16008.721246957779, "timesteps_since_restore": 316500, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 39.31481481481482, "ram_util_percent": 55.57407407407409}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0340463710908, "mean_processing_ms": 6.068959539216404, "mean_inference_ms": 0.7887815540734097}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 212, "num_steps_trained": 1025000, "num_steps_sampled": 318000, "sample_time_ms": 76306.723, "replay_time_ms": 281.79, "grad_time_ms": 75.121, "update_time_ms": 6.27, "opt_peak_throughput": 66558.928, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3261416554450989, "max_q": -0.10089731216430664, "min_q": -0.6850141286849976}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 318000, "episodes_total": 1272, "training_iteration": 212, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-49-54", "timestamp": 1579902594, "time_this_iter_s": 77.08780527114868, "time_total_s": 16085.809052228928, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16085.809052228928, "timesteps_since_restore": 318000, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 39.799082568807336, "ram_util_percent": 55.60275229357797}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.05343353358944, "mean_processing_ms": 6.069172038751021, "mean_inference_ms": 0.7888251615754676}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 213, "num_steps_trained": 1030000, "num_steps_sampled": 319500, "sample_time_ms": 76397.879, "replay_time_ms": 281.698, "grad_time_ms": 75.174, "update_time_ms": 6.263, "opt_peak_throughput": 66512.634, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3249225616455078, "max_q": -0.10653404891490936, "min_q": -0.6710469126701355}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 319500, "episodes_total": 1278, "training_iteration": 213, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-51-11", "timestamp": 1579902671, "time_this_iter_s": 76.92290210723877, "time_total_s": 16162.731954336166, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16162.731954336166, "timesteps_since_restore": 319500, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 38.85818181818181, "ram_util_percent": 55.652727272727304}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0712668246745, "mean_processing_ms": 6.069390897792897, "mean_inference_ms": 0.7888643955873005}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 214, "num_steps_trained": 1035000, "num_steps_sampled": 321000, "sample_time_ms": 76278.509, "replay_time_ms": 284.509, "grad_time_ms": 75.293, "update_time_ms": 6.323, "opt_peak_throughput": 66406.969, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32664966583251953, "max_q": -0.09809926152229309, "min_q": -0.7692354917526245}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 321000, "episodes_total": 1284, "training_iteration": 214, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-52-26", "timestamp": 1579902746, "time_this_iter_s": 75.8458821773529, "time_total_s": 16238.57783651352, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16238.57783651352, "timesteps_since_restore": 321000, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 38.71869158878504, "ram_util_percent": 55.68317757009346}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.08811588574133, "mean_processing_ms": 6.0696796083079025, "mean_inference_ms": 0.788903042886863}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 215, "num_steps_trained": 1040000, "num_steps_sampled": 322500, "sample_time_ms": 76215.698, "replay_time_ms": 285.07, "grad_time_ms": 75.552, "update_time_ms": 6.323, "opt_peak_throughput": 66179.534, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32449784874916077, "max_q": -0.10432980954647064, "min_q": -0.7228665351867676}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 322500, "episodes_total": 1290, "training_iteration": 215, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-53-43", "timestamp": 1579902823, "time_this_iter_s": 76.42763924598694, "time_total_s": 16315.005475759506, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16315.005475759506, "timesteps_since_restore": 322500, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 39.27064220183487, "ram_util_percent": 55.76330275229357}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.10527547391814, "mean_processing_ms": 6.069893383125376, "mean_inference_ms": 0.7889439173380084}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 216, "num_steps_trained": 1045000, "num_steps_sampled": 324000, "sample_time_ms": 76290.844, "replay_time_ms": 280.669, "grad_time_ms": 74.474, "update_time_ms": 6.407, "opt_peak_throughput": 67137.545, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3240260183811188, "max_q": -0.10580973327159882, "min_q": -0.8138915300369263}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 324000, "episodes_total": 1296, "training_iteration": 216, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-55-00", "timestamp": 1579902900, "time_this_iter_s": 76.99479508399963, "time_total_s": 16392.000270843506, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16392.000270843506, "timesteps_since_restore": 324000, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 40.20550458715598, "ram_util_percent": 55.844954128440364}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1211037475624, "mean_processing_ms": 6.070123910371135, "mean_inference_ms": 0.788981184494054}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 217, "num_steps_trained": 1050000, "num_steps_sampled": 325500, "sample_time_ms": 76184.321, "replay_time_ms": 283.473, "grad_time_ms": 75.476, "update_time_ms": 6.38, "opt_peak_throughput": 66245.887, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3317508399486542, "max_q": -0.11260131001472473, "min_q": -0.7233577370643616}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 325500, "episodes_total": 1302, "training_iteration": 217, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-56-15", "timestamp": 1579902975, "time_this_iter_s": 75.13668513298035, "time_total_s": 16467.136955976486, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16467.136955976486, "timesteps_since_restore": 325500, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 37.985849056603776, "ram_util_percent": 55.91132075471697}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1325649095923, "mean_processing_ms": 6.070298219018315, "mean_inference_ms": 0.7890090007886131}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 218, "num_steps_trained": 1055000, "num_steps_sampled": 327000, "sample_time_ms": 75758.606, "replay_time_ms": 283.859, "grad_time_ms": 75.554, "update_time_ms": 6.437, "opt_peak_throughput": 66178.03, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.323724627494812, "max_q": -0.10885705798864365, "min_q": -0.707472562789917}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 327000, "episodes_total": 1308, "training_iteration": 218, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-57-28", "timestamp": 1579903048, "time_this_iter_s": 72.91763401031494, "time_total_s": 16540.0545899868, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16540.0545899868, "timesteps_since_restore": 327000, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 34.94903846153846, "ram_util_percent": 55.914423076923065}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1408719400661, "mean_processing_ms": 6.070422958445951, "mean_inference_ms": 0.7890288346674411}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 219, "num_steps_trained": 1060000, "num_steps_sampled": 328500, "sample_time_ms": 75451.145, "replay_time_ms": 284.409, "grad_time_ms": 74.792, "update_time_ms": 6.441, "opt_peak_throughput": 66851.917, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3287976384162903, "max_q": -0.09573664516210556, "min_q": -0.7614907026290894}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 328500, "episodes_total": 1314, "training_iteration": 219, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-58-42", "timestamp": 1579903122, "time_this_iter_s": 73.92418503761292, "time_total_s": 16613.978775024414, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16613.978775024414, "timesteps_since_restore": 328500, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 35.53523809523809, "ram_util_percent": 55.86666666666667}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.14656416833657, "mean_processing_ms": 6.070480599784197, "mean_inference_ms": 0.7890434312545238}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 220, "num_steps_trained": 1065000, "num_steps_sampled": 330000, "sample_time_ms": 75157.386, "replay_time_ms": 280.012, "grad_time_ms": 74.152, "update_time_ms": 6.527, "opt_peak_throughput": 67428.659, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3351800739765167, "max_q": -0.1142183169722557, "min_q": -0.7073015570640564}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 330000, "episodes_total": 1320, "training_iteration": 220, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_22-59-56", "timestamp": 1579903196, "time_this_iter_s": 73.82603812217712, "time_total_s": 16687.80481314659, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16687.80481314659, "timesteps_since_restore": 330000, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 35.679047619047616, "ram_util_percent": 55.583809523809535}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1464643831836, "mean_processing_ms": 6.07039837302306, "mean_inference_ms": 0.7890418752859091}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 221, "num_steps_trained": 1070000, "num_steps_sampled": 331500, "sample_time_ms": 74700.99, "replay_time_ms": 279.312, "grad_time_ms": 73.269, "update_time_ms": 6.559, "opt_peak_throughput": 68242.053, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3241773545742035, "max_q": -0.10477429628372192, "min_q": -0.702896773815155}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 331500, "episodes_total": 1326, "training_iteration": 221, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-01-07", "timestamp": 1579903267, "time_this_iter_s": 71.67895722389221, "time_total_s": 16759.483770370483, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16759.483770370483, "timesteps_since_restore": 331500, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 32.48514851485149, "ram_util_percent": 54.40990099009903}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.14303044695725, "mean_processing_ms": 6.070373180827645, "mean_inference_ms": 0.7890321605979191}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 222, "num_steps_trained": 1075000, "num_steps_sampled": 333000, "sample_time_ms": 74381.362, "replay_time_ms": 278.205, "grad_time_ms": 72.412, "update_time_ms": 6.526, "opt_peak_throughput": 69049.497, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3341798484325409, "max_q": -0.11730476468801498, "min_q": -0.7284196019172668}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 333000, "episodes_total": 1332, "training_iteration": 222, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-02-21", "timestamp": 1579903341, "time_this_iter_s": 73.87221026420593, "time_total_s": 16833.35598063469, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16833.35598063469, "timesteps_since_restore": 333000, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 35.902857142857144, "ram_util_percent": 51.9542857142857}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.13736188204916, "mean_processing_ms": 6.070341208640283, "mean_inference_ms": 0.7890172758988289}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 223, "num_steps_trained": 1080000, "num_steps_sampled": 334500, "sample_time_ms": 74097.679, "replay_time_ms": 276.04, "grad_time_ms": 72.6, "update_time_ms": 6.604, "opt_peak_throughput": 68870.2, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33143743872642517, "max_q": -0.11470450460910797, "min_q": -0.7180953621864319}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 334500, "episodes_total": 1338, "training_iteration": 223, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-03-35", "timestamp": 1579903415, "time_this_iter_s": 74.0679337978363, "time_total_s": 16907.423914432526, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16907.423914432526, "timesteps_since_restore": 334500, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 35.48571428571428, "ram_util_percent": 52.13523809523811}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1284161789266, "mean_processing_ms": 6.0702985929773225, "mean_inference_ms": 0.7889949852375376}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 224, "num_steps_trained": 1085000, "num_steps_sampled": 336000, "sample_time_ms": 73878.307, "replay_time_ms": 276.914, "grad_time_ms": 72.301, "update_time_ms": 6.565, "opt_peak_throughput": 69155.034, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32399189472198486, "max_q": -0.10276568681001663, "min_q": -0.6892021298408508}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 336000, "episodes_total": 1344, "training_iteration": 224, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-04-49", "timestamp": 1579903489, "time_this_iter_s": 73.65739417076111, "time_total_s": 16981.081308603287, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 16981.081308603287, "timesteps_since_restore": 336000, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 34.11904761904762, "ram_util_percent": 52.26190476190475}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.11592141671923, "mean_processing_ms": 6.07025742642272, "mean_inference_ms": 0.7889636169085154}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 225, "num_steps_trained": 1090000, "num_steps_sampled": 337500, "sample_time_ms": 73643.893, "replay_time_ms": 278.847, "grad_time_ms": 73.291, "update_time_ms": 6.543, "opt_peak_throughput": 68221.341, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33792075514793396, "max_q": -0.11670626699924469, "min_q": -0.8367883563041687}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 337500, "episodes_total": 1350, "training_iteration": 225, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-06-03", "timestamp": 1579903563, "time_this_iter_s": 74.11284804344177, "time_total_s": 17055.19415664673, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17055.19415664673, "timesteps_since_restore": 337500, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 36.6552380952381, "ram_util_percent": 52.410476190476174}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.1000060007633, "mean_processing_ms": 6.070196796992466, "mean_inference_ms": 0.7889246553382891}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 226, "num_steps_trained": 1095000, "num_steps_sampled": 339000, "sample_time_ms": 73314.146, "replay_time_ms": 280.78, "grad_time_ms": 74.297, "update_time_ms": 6.458, "opt_peak_throughput": 67297.642, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3303273916244507, "max_q": -0.0928034633398056, "min_q": -0.6959742307662964}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 339000, "episodes_total": 1356, "training_iteration": 226, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-07-17", "timestamp": 1579903637, "time_this_iter_s": 73.72430372238159, "time_total_s": 17128.91846036911, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17128.91846036911, "timesteps_since_restore": 339000, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 34.994285714285716, "ram_util_percent": 52.53714285714286}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.08109515277, "mean_processing_ms": 6.070142650533065, "mean_inference_ms": 0.7888778545026409}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 227, "num_steps_trained": 1100000, "num_steps_sampled": 340500, "sample_time_ms": 73179.543, "replay_time_ms": 277.332, "grad_time_ms": 73.333, "update_time_ms": 6.483, "opt_peak_throughput": 68182.127, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3301282823085785, "max_q": -0.10255052149295807, "min_q": -0.6778354644775391}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 340500, "episodes_total": 1362, "training_iteration": 227, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-08-31", "timestamp": 1579903711, "time_this_iter_s": 73.74566292762756, "time_total_s": 17202.664123296738, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17202.664123296738, "timesteps_since_restore": 340500, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 35.47596153846154, "ram_util_percent": 52.69903846153847}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.05940514483075, "mean_processing_ms": 6.070049393262874, "mean_inference_ms": 0.7888245690570288}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 228, "num_steps_trained": 1105000, "num_steps_sampled": 342000, "sample_time_ms": 73263.604, "replay_time_ms": 277.42, "grad_time_ms": 73.345, "update_time_ms": 6.441, "opt_peak_throughput": 68170.957, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3424069881439209, "max_q": -0.11405673623085022, "min_q": -0.7222031354904175}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 342000, "episodes_total": 1368, "training_iteration": 228, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-09-45", "timestamp": 1579903785, "time_this_iter_s": 73.75807595252991, "time_total_s": 17276.422199249268, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17276.422199249268, "timesteps_since_restore": 342000, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 35.10285714285714, "ram_util_percent": 52.75904761904763}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.03521983387583, "mean_processing_ms": 6.0700053643321095, "mean_inference_ms": 0.7887650963793756}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 229, "num_steps_trained": 1110000, "num_steps_sampled": 343500, "sample_time_ms": 73334.429, "replay_time_ms": 276.885, "grad_time_ms": 73.318, "update_time_ms": 6.436, "opt_peak_throughput": 68196.162, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.32473623752593994, "max_q": -0.09503204375505447, "min_q": -0.8111058473587036}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 343500, "episodes_total": 1374, "training_iteration": 229, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-10-59", "timestamp": 1579903859, "time_this_iter_s": 74.6268789768219, "time_total_s": 17351.04907822609, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17351.04907822609, "timesteps_since_restore": 343500, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 36.237735849056605, "ram_util_percent": 52.81509433962264}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 289.0094932992369, "mean_processing_ms": 6.069909133663575, "mean_inference_ms": 0.7887027576439982}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 230, "num_steps_trained": 1115000, "num_steps_sampled": 345000, "sample_time_ms": 73439.778, "replay_time_ms": 276.78, "grad_time_ms": 73.569, "update_time_ms": 6.409, "opt_peak_throughput": 67963.75, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3363499641418457, "max_q": -0.11033608764410019, "min_q": -0.7275250554084778}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 345000, "episodes_total": 1380, "training_iteration": 230, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-12-14", "timestamp": 1579903934, "time_this_iter_s": 74.881587266922, "time_total_s": 17425.93066549301, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17425.93066549301, "timesteps_since_restore": 345000, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 37.11037735849057, "ram_util_percent": 52.93301886792452}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9822313833776, "mean_processing_ms": 6.069818531173871, "mean_inference_ms": 0.788635738010745}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 231, "num_steps_trained": 1120000, "num_steps_sampled": 346500, "sample_time_ms": 73706.849, "replay_time_ms": 277.585, "grad_time_ms": 74.245, "update_time_ms": 6.416, "opt_peak_throughput": 67345.013, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3387696444988251, "max_q": -0.11310848593711853, "min_q": -0.7119569182395935}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 346500, "episodes_total": 1386, "training_iteration": 231, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-13-29", "timestamp": 1579904009, "time_this_iter_s": 74.36574220657349, "time_total_s": 17500.296407699585, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17500.296407699585, "timesteps_since_restore": 346500, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 36.02075471698113, "ram_util_percent": 53.02735849056605}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9531235488762, "mean_processing_ms": 6.0696330781228855, "mean_inference_ms": 0.7885622511489347}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 232, "num_steps_trained": 1125000, "num_steps_sampled": 348000, "sample_time_ms": 73806.007, "replay_time_ms": 277.029, "grad_time_ms": 74.371, "update_time_ms": 6.355, "opt_peak_throughput": 67230.826, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.327532559633255, "max_q": -0.09999978542327881, "min_q": -0.6842090487480164}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 348000, "episodes_total": 1392, "training_iteration": 232, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-14-43", "timestamp": 1579904083, "time_this_iter_s": 74.85860013961792, "time_total_s": 17575.155007839203, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17575.155007839203, "timesteps_since_restore": 348000, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 36.84905660377358, "ram_util_percent": 53.16886792452831}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.9226471870734, "mean_processing_ms": 6.0694413059703285, "mean_inference_ms": 0.788483747251832}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 233, "num_steps_trained": 1130000, "num_steps_sampled": 349500, "sample_time_ms": 73889.71, "replay_time_ms": 275.458, "grad_time_ms": 73.417, "update_time_ms": 6.35, "opt_peak_throughput": 68103.701, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3401566445827484, "max_q": -0.1186191663146019, "min_q": -0.7502784132957458}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 349500, "episodes_total": 1398, "training_iteration": 233, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-15-58", "timestamp": 1579904158, "time_this_iter_s": 74.88028001785278, "time_total_s": 17650.035287857056, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17650.035287857056, "timesteps_since_restore": 349500, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 36.80094339622641, "ram_util_percent": 53.255660377358474}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.8921138855925, "mean_processing_ms": 6.069290370359922, "mean_inference_ms": 0.7884056093980679}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 234, "num_steps_trained": 1135000, "num_steps_sampled": 351000, "sample_time_ms": 73958.906, "replay_time_ms": 275.279, "grad_time_ms": 73.647, "update_time_ms": 6.402, "opt_peak_throughput": 67891.539, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3348308503627777, "max_q": -0.1060463935136795, "min_q": -0.7252488732337952}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 351000, "episodes_total": 1404, "training_iteration": 234, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-17-13", "timestamp": 1579904233, "time_this_iter_s": 74.35078072547913, "time_total_s": 17724.386068582535, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17724.386068582535, "timesteps_since_restore": 351000, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 34.95849056603773, "ram_util_percent": 53.39905660377358}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.8627241377198, "mean_processing_ms": 6.069144529671515, "mean_inference_ms": 0.7883294725993255}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 235, "num_steps_trained": 1140000, "num_steps_sampled": 352500, "sample_time_ms": 73970.645, "replay_time_ms": 274.751, "grad_time_ms": 73.298, "update_time_ms": 6.424, "opt_peak_throughput": 68215.083, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33600568771362305, "max_q": -0.1002158522605896, "min_q": -0.7718878388404846}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 352500, "episodes_total": 1410, "training_iteration": 235, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-18-27", "timestamp": 1579904307, "time_this_iter_s": 74.22087121009827, "time_total_s": 17798.606939792633, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17798.606939792633, "timesteps_since_restore": 352500, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 35.12380952380953, "ram_util_percent": 53.52761904761906}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.8341529352755, "mean_processing_ms": 6.068992775554156, "mean_inference_ms": 0.7882536386435404}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 236, "num_steps_trained": 1145000, "num_steps_sampled": 354000, "sample_time_ms": 74038.513, "replay_time_ms": 273.113, "grad_time_ms": 72.268, "update_time_ms": 6.458, "opt_peak_throughput": 69187.021, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34200671315193176, "max_q": -0.11412215977907181, "min_q": -0.6776871085166931}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 354000, "episodes_total": 1416, "training_iteration": 236, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-19-41", "timestamp": 1579904381, "time_this_iter_s": 74.37723898887634, "time_total_s": 17872.98417878151, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17872.98417878151, "timesteps_since_restore": 354000, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 36.26698113207547, "ram_util_percent": 53.66037735849058}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.8079157830974, "mean_processing_ms": 6.068854982250374, "mean_inference_ms": 0.7881842686665439}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 237, "num_steps_trained": 1150000, "num_steps_sampled": 355500, "sample_time_ms": 74183.078, "replay_time_ms": 270.801, "grad_time_ms": 71.385, "update_time_ms": 6.494, "opt_peak_throughput": 70042.935, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3319844901561737, "max_q": -0.10305345058441162, "min_q": -0.713957667350769}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 355500, "episodes_total": 1422, "training_iteration": 237, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-20-57", "timestamp": 1579904457, "time_this_iter_s": 75.16082000732422, "time_total_s": 17948.144998788834, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 17948.144998788834, "timesteps_since_restore": 355500, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 36.58018867924528, "ram_util_percent": 53.72264150943396}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.78461721389556, "mean_processing_ms": 6.068836830311705, "mean_inference_ms": 0.7881201107307011}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 238, "num_steps_trained": 1155000, "num_steps_sampled": 357000, "sample_time_ms": 74311.772, "replay_time_ms": 270.936, "grad_time_ms": 71.445, "update_time_ms": 6.502, "opt_peak_throughput": 69984.172, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3425631821155548, "max_q": -0.11272290349006653, "min_q": -0.7101078033447266}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 357000, "episodes_total": 1428, "training_iteration": 238, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-22-12", "timestamp": 1579904532, "time_this_iter_s": 75.04795026779175, "time_total_s": 18023.192949056625, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18023.192949056625, "timesteps_since_restore": 357000, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 36.231775700934584, "ram_util_percent": 53.84205607476634}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.7629413095246, "mean_processing_ms": 6.068795483364129, "mean_inference_ms": 0.7880593304058998}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 239, "num_steps_trained": 1160000, "num_steps_sampled": 358500, "sample_time_ms": 74363.234, "replay_time_ms": 270.428, "grad_time_ms": 71.282, "update_time_ms": 6.496, "opt_peak_throughput": 70144.188, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33364740014076233, "max_q": -0.09823612123727798, "min_q": -0.7355951070785522}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 358500, "episodes_total": 1434, "training_iteration": 239, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-23-27", "timestamp": 1579904607, "time_this_iter_s": 75.13535690307617, "time_total_s": 18098.3283059597, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18098.3283059597, "timesteps_since_restore": 358500, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 38.116981132075466, "ram_util_percent": 54.00754716981133}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.7425531005506, "mean_processing_ms": 6.068736903253015, "mean_inference_ms": 0.7880019698414064}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 240, "num_steps_trained": 1165000, "num_steps_sampled": 360000, "sample_time_ms": 74370.455, "replay_time_ms": 273.054, "grad_time_ms": 71.979, "update_time_ms": 6.55, "opt_peak_throughput": 69464.569, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3428013026714325, "max_q": -0.11154528707265854, "min_q": -0.7112747430801392}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 360000, "episodes_total": 1440, "training_iteration": 240, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-24-42", "timestamp": 1579904682, "time_this_iter_s": 74.98615980148315, "time_total_s": 18173.314465761185, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18173.314465761185, "timesteps_since_restore": 360000, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 36.41121495327103, "ram_util_percent": 54.142990654205626}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.7226229257226, "mean_processing_ms": 6.068686184172611, "mean_inference_ms": 0.7879474070590398}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 241, "num_steps_trained": 1170000, "num_steps_sampled": 361500, "sample_time_ms": 74329.425, "replay_time_ms": 275.116, "grad_time_ms": 72.321, "update_time_ms": 6.455, "opt_peak_throughput": 69136.157, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33652839064598083, "max_q": -0.105433389544487, "min_q": -0.6986706852912903}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 361500, "episodes_total": 1446, "training_iteration": 241, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-25-56", "timestamp": 1579904756, "time_this_iter_s": 73.97835302352905, "time_total_s": 18247.292818784714, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18247.292818784714, "timesteps_since_restore": 361500, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 36.16380952380952, "ram_util_percent": 54.23904761904763}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.7044371059627, "mean_processing_ms": 6.068723451714867, "mean_inference_ms": 0.7878972008657502}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 242, "num_steps_trained": 1175000, "num_steps_sampled": 363000, "sample_time_ms": 74396.175, "replay_time_ms": 278.964, "grad_time_ms": 72.959, "update_time_ms": 6.474, "opt_peak_throughput": 68531.221, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34097158908843994, "max_q": -0.10534148663282394, "min_q": -0.7604112029075623}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 363000, "episodes_total": 1452, "training_iteration": 242, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-27-11", "timestamp": 1579904831, "time_this_iter_s": 75.57152700424194, "time_total_s": 18322.864345788956, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18322.864345788956, "timesteps_since_restore": 363000, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 36.1392523364486, "ram_util_percent": 54.285981308411216}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.6877727259205, "mean_processing_ms": 6.068692486514557, "mean_inference_ms": 0.7878504225180855}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 243, "num_steps_trained": 1180000, "num_steps_sampled": 364500, "sample_time_ms": 74399.772, "replay_time_ms": 279.018, "grad_time_ms": 73.253, "update_time_ms": 6.417, "opt_peak_throughput": 68257.024, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34282246232032776, "max_q": -0.10558851063251495, "min_q": -0.8040237426757812}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 364500, "episodes_total": 1458, "training_iteration": 243, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-28-26", "timestamp": 1579904906, "time_this_iter_s": 74.91819977760315, "time_total_s": 18397.78254556656, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18397.78254556656, "timesteps_since_restore": 364500, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 37.097169811320754, "ram_util_percent": 54.51509433962266}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.67250527043973, "mean_processing_ms": 6.068647465570725, "mean_inference_ms": 0.787807994931191}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 244, "num_steps_trained": 1185000, "num_steps_sampled": 366000, "sample_time_ms": 74470.053, "replay_time_ms": 276.702, "grad_time_ms": 74.525, "update_time_ms": 6.375, "opt_peak_throughput": 67091.753, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.342821329832077, "max_q": -0.11293269693851471, "min_q": -0.8341427445411682}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 366000, "episodes_total": 1464, "training_iteration": 244, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-29-41", "timestamp": 1579904981, "time_this_iter_s": 75.0432779788971, "time_total_s": 18472.825823545456, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18472.825823545456, "timesteps_since_restore": 366000, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 37.47663551401869, "ram_util_percent": 54.630841121495344}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.6582136579375, "mean_processing_ms": 6.068576677291695, "mean_inference_ms": 0.7877691488554484}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 245, "num_steps_trained": 1190000, "num_steps_sampled": 367500, "sample_time_ms": 74541.59, "replay_time_ms": 274.588, "grad_time_ms": 74.401, "update_time_ms": 6.449, "opt_peak_throughput": 67203.68, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33605098724365234, "max_q": -0.10637785494327545, "min_q": -0.7236337065696716}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 367500, "episodes_total": 1470, "training_iteration": 245, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-30-56", "timestamp": 1579905056, "time_this_iter_s": 74.91599106788635, "time_total_s": 18547.741814613342, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18547.741814613342, "timesteps_since_restore": 367500, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 36.92641509433963, "ram_util_percent": 54.696226415094344}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.643509592551, "mean_processing_ms": 6.068486821139131, "mean_inference_ms": 0.7877295192026623}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 246, "num_steps_trained": 1195000, "num_steps_sampled": 369000, "sample_time_ms": 74530.798, "replay_time_ms": 276.649, "grad_time_ms": 75.062, "update_time_ms": 6.451, "opt_peak_throughput": 66611.611, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3457444906234741, "max_q": -0.11217615008354187, "min_q": -0.8001827001571655}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 369000, "episodes_total": 1476, "training_iteration": 246, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-32-11", "timestamp": 1579905131, "time_this_iter_s": 74.29691410064697, "time_total_s": 18622.03872871399, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18622.03872871399, "timesteps_since_restore": 369000, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 36.48095238095238, "ram_util_percent": 54.80761904761904}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.94480336812427, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77164481868054}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.62826770642647, "mean_processing_ms": 6.0684776261025775, "mean_inference_ms": 0.7876879527987319}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 247, "num_steps_trained": 1200000, "num_steps_sampled": 370500, "sample_time_ms": 74420.79, "replay_time_ms": 279.984, "grad_time_ms": 75.688, "update_time_ms": 6.42, "opt_peak_throughput": 66060.479, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3394756615161896, "max_q": -0.1060207188129425, "min_q": -0.8282227516174316}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 370500, "episodes_total": 1482, "training_iteration": 247, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-33-25", "timestamp": 1579905205, "time_this_iter_s": 74.09907078742981, "time_total_s": 18696.13779950142, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18696.13779950142, "timesteps_since_restore": 370500, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 34.18773584905661, "ram_util_percent": 54.88490566037734}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -348.96626741760025, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.77402971306675}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.61266482388635, "mean_processing_ms": 6.068442388714344, "mean_inference_ms": 0.7876448935127759}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 248, "num_steps_trained": 1205000, "num_steps_sampled": 372000, "sample_time_ms": 74321.549, "replay_time_ms": 279.668, "grad_time_ms": 75.04, "update_time_ms": 6.381, "opt_peak_throughput": 66631.315, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.3392847776412964, "max_q": -0.13358058035373688, "min_q": -0.8473319411277771}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 372000, "episodes_total": 1488, "training_iteration": 248, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-34-39", "timestamp": 1579905279, "time_this_iter_s": 74.04462432861328, "time_total_s": 18770.182423830032, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18770.182423830032, "timesteps_since_restore": 372000, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 36.01619047619048, "ram_util_percent": 54.99047619047619}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.10904823644995, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.78989424849449}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.5975578882619, "mean_processing_ms": 6.068458970031436, "mean_inference_ms": 0.7876034661186767}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 249, "num_steps_trained": 1210000, "num_steps_sampled": 373500, "sample_time_ms": 74345.9, "replay_time_ms": 280.237, "grad_time_ms": 75.19, "update_time_ms": 6.328, "opt_peak_throughput": 66498.272, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.34972670674324036, "max_q": -0.12196411937475204, "min_q": -0.7736334800720215}}}, "timesteps_this_iter": 1500, "done": false, "timesteps_total": 373500, "episodes_total": 1494, "training_iteration": 249, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-35-54", "timestamp": 1579905354, "time_this_iter_s": 75.38500618934631, "time_total_s": 18845.56743001938, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18845.56743001938, "timesteps_since_restore": 373500, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 37.833644859813084, "ram_util_percent": 55.03271028037384}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
{"episode_reward_max": -335.2367220757563, "episode_reward_min": -361.46932696619336, "episode_reward_mean": -349.02820256941493, "episode_len_mean": 250.0, "episodes_this_iter": 6, "policy_reward_min": {"av": -40.16325855179926}, "policy_reward_max": {"av": -37.24852467508408}, "policy_reward_mean": {"av": -38.7809113966017}, "custom_metrics": {}, "sampler_perf": {"mean_env_wait_ms": 288.583152909483, "mean_processing_ms": 6.068465745094469, "mean_inference_ms": 0.7875642497255327}, "off_policy_estimator": {}, "info": {"min_exploration": 1.0, "max_exploration": 1.0, "num_target_updates": 250, "num_steps_trained": 1215000, "num_steps_sampled": 375000, "sample_time_ms": 74366.508, "replay_time_ms": 277.746, "grad_time_ms": 74.465, "update_time_ms": 6.265, "opt_peak_throughput": 67145.348, "opt_samples": 5000.0, "learner": {"av": {"mean_q": -0.33944281935691833, "max_q": -0.10655343532562256, "min_q": -0.7268562912940979}}}, "timesteps_this_iter": 1500, "done": true, "timesteps_total": 375000, "episodes_total": 1500, "training_iteration": 250, "experiment_id": "74a7937e2478488a8c9505eae210f6fb", "date": "2020-01-24_23-37-09", "timestamp": 1579905429, "time_this_iter_s": 75.15897989273071, "time_total_s": 18920.72640991211, "pid": 12669, "hostname": "[clemens_mac]", "node_ip": "192.168.178.174", "config": {"num_workers": 6, "num_envs_per_worker": 1, "sample_batch_size": 1, "batch_mode": "complete_episodes", "num_gpus": 0, "train_batch_size": 5000, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [256, 256], "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "state_shape": null, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_action_dist": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.99, "horizon": 250, "soft_horizon": false, "no_done_at_end": false, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"discrete\": false,\n            \"num_local_edges\": 4,\n            \"num_local_lights\": 4,\n            \"num_observed\": 2,\n            \"switch_time\": 3,\n            \"target_velocity\": 40,\n            \"tl_type\": \"actuated\"\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 250,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 0\n    },\n    \"env_name\": \"flow.envs.multiagent.traffic_light_grid.MultiTrafficLightGridPOEnv\",\n    \"exp_tag\": \"multiagent-traffic-light\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": \"all\",\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 0,\n        \"perturbation\": 0.0,\n        \"shuffle\": true,\n        \"spacing\": \"custom\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"grid_array\": {\n                \"cars_bot\": 10,\n                \"cars_left\": 10,\n                \"cars_right\": 10,\n                \"cars_top\": 10,\n                \"col_num\": 3,\n                \"inner_length\": 300,\n                \"long_length\": 100,\n                \"row_num\": 3,\n                \"short_length\": 300\n            },\n            \"horizontal_lanes\": 1,\n            \"speed_limit\": 40,\n            \"vertical_lanes\": 1\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"left3_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_2\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_3\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_4\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"right0_2\",\n                    \"end\": 86400,\n                    \"name\": \"flow_5\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot0_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_6\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot1_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_7\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"bot2_0\",\n                    \"end\": 86400,\n                    \"name\": \"flow_8\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top0_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_9\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top1_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_10\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"free\",\n                    \"departSpeed\": 20,\n                    \"edge\": \"top2_3\",\n                    \"end\": 86400,\n                    \"name\": \"flow_11\",\n                    \"vehsPerHour\": 300,\n                    \"vtype\": \"human\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"flow.networks.traffic_light_grid.TrafficLightGridNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": true,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 1,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 7.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 20,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 25\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 512\n            },\n            \"num_vehicles\": 120,\n            \"routing_controller\": [\n                \"GridRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        }\n    ]\n}", "run": "DDPG"}, "env": "MultiTrafficLightGridPOEnv-v1", "clip_rewards": false, "clip_actions": true, "preprocessor_pref": "deepmind", "lr": 0.0001, "monitor": false, "log_level": "WARN", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null, "on_postprocess_traj": null}, "ignore_worker_failures": false, "log_sys_usage": true, "eager": false, "eager_tracing": false, "no_eager_on_workers": false, "evaluation_interval": null, "evaluation_num_episodes": 10, "evaluation_config": {"exploration_fraction": 0, "exploration_final_eps": 0}, "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 1, "timesteps_per_iteration": 1000, "seed": null, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "memory": 0, "object_store_memory": 0, "memory_per_worker": 0, "object_store_memory_per_worker": 0, "input": "sampler", "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"av": ["<class 'ray.rllib.agents.ddpg.ddpg_policy.DDPGTFPolicy'>", "Box(42,)", "Box(1,)", {}]}, "policy_mapping_fn": "<function policy_mapping_fn at 0x15a324c20>", "policies_to_train": null}, "twin_q": true, "policy_delay": 2, "smooth_target_policy": true, "target_noise": 0.2, "target_noise_clip": 0.5, "use_state_preprocessor": false, "actor_hiddens": [400, 300], "actor_hidden_activation": "relu", "critic_hiddens": [400, 300], "critic_hidden_activation": "relu", "n_step": 1, "exploration_should_anneal": false, "schedule_max_timesteps": 100000, "exploration_fraction": 0.1, "exploration_final_scale": 0.02, "exploration_noise_type": "gaussian", "exploration_ou_noise_scale": 0.1, "exploration_ou_theta": 0.15, "exploration_ou_sigma": 0.2, "exploration_gaussian_sigma": 0.1, "parameter_noise": false, "pure_exploration_steps": 10000, "buffer_size": 1000000, "prioritized_replay": false, "prioritized_replay_alpha": 0.6, "prioritized_replay_beta": 0.4, "beta_annealing_fraction": 0.2, "final_prioritized_replay_beta": 0.4, "prioritized_replay_eps": 1e-06, "critic_lr": 0.001, "actor_lr": 0.001, "target_network_update_freq": 0, "tau": 0.005, "use_huber": false, "huber_threshold": 1.0, "l2_reg": 0.0, "grad_norm_clipping": null, "learning_starts": 10000, "per_worker_exploration": false, "worker_side_prioritization": false}, "time_since_restore": 18920.72640991211, "timesteps_since_restore": 375000, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 36.39811320754717, "ram_util_percent": 55.1179245283019}, "num_healthy_workers": 6, "trial_id": "f9f194d2", "experiment_tag": "0"}
